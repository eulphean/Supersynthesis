(this.webpackJsonpsupersynthesis=this.webpackJsonpsupersynthesis||[]).push([[0],{100:function(t,e,i){"use strict";i.r(e);var n,s=i(0),a=i.n(s),r=i(45),h=i.n(r),o=(i(84),i(85),i(1)),l=i(2),c=i(6),u=i(4),g=i(3),p=i(15),f=i(78),d="TOP",v="BOTTOM",y=1,b=0,m=0,w=1,k=2,x=new(function(){function t(){Object(o.a)(this,t),this.lightSubscribers=[],this.infoSubscribers=[],this.configIndex=0,this.bpm=150,this.lightConfig=[],this.maxLightHeight=0,this.prepareDefaultLightConfig()}return Object(l.a)(t,[{key:"subscribeLights",value:function(t){var e=this;this.lightSubscribers.push(t);return function(){e.lightSubscribers=e.lightSubscribers.filter((function(e){return t!==e}))}}},{key:"subscribeInfo",value:function(t){var e=this;this.infoSubscribers.push(t);return function(){e.infoListeners=e.infoSubscribers.filter((function(e){return t!==e}))}}},{key:"setMaxHeight",value:function(t){this.maxLightHeight=t}},{key:"prepareDefaultLightConfig",value:function(){console.log("Preparing default config.");for(var t=0;t<24;t++){var e={light:{TOP:1,BOTTOM:1},draw:{TOP:!1,BOTTOM:!1},grow:{TOP:{state:m,active:!1},BOTTOM:{state:m,active:!1}},height:{TOP:0,BOTTOM:0}};this.lightConfig.push(e)}}},{key:"getFullConfig",value:function(t){return this.lightConfig[t]}},{key:"getLightState",value:function(t){return this.lightConfig[t].light}},{key:"setLightState",value:function(t,e,i){this.lightConfig[t].light[e]=i}},{key:"getGrowState",value:function(t){return this.lightConfig[t].grow}},{key:"setGrowState",value:function(t,e,i,n){this.lightConfig[t].grow[e].state=i,this.lightConfig[t].grow[e].active=n}},{key:"getDrawState",value:function(t){return this.lightConfig[t].draw}},{key:"setDrawState",value:function(t,e,i){this.lightConfig[t].draw[e]=i}},{key:"getHeightState",value:function(t){return this.lightConfig[t].height}},{key:"setHeightState",value:function(t,e,i){this.lightConfig[t].height[e]=i}},{key:"getRandomInt",value:function(t){return Math.floor(Math.random()*t)}},{key:"getBpm",value:function(){return this.bpm}},{key:"setBpm",value:function(t){this.bpm=t;for(var e=0;e<this.infoSubscribers.length;e++)this.infoSubscribers[e]()}},{key:"getConfigIndex",value:function(){return this.configIndex}},{key:"getPayloadForDatabase",value:function(){this.configIndex+=1;var t=this.filterConfig();this.json={},this.json.bpm=this.bpm,this.json.lights=t,this.json.time=Date();for(var e={index:this.configIndex,config:JSON.stringify(this.json)},i=0;i<this.infoSubscribers.length;i++)this.infoSubscribers[i]();return e}},{key:"setPayloadFromDatabase",value:function(t){console.log("Overwriting current config."),this.configIndex=t.index;var e=t.config;this.bpm=e.bpm;for(var i=0;i<this.infoSubscribers.length;i++)this.infoSubscribers[i]();var n=e.lights;this.updateLightConfig(n);for(var s=0;s<this.lightSubscribers.length;s++)this.lightSubscribers[s]()}},{key:"filterConfig",value:function(){var t=[];return this.lightConfig.forEach((function(e){var i=e.light;t.push(i)})),t}},{key:"updateLightConfig",value:function(t){this.lightConfig=[];for(var e=0;e<t.length;e++){var i=t[e],n={light:{TOP:i[d],BOTTOM:i[v]},draw:{TOP:i[d]===y,BOTTOM:i[v]===y},grow:{TOP:{state:m,active:!1},BOTTOM:{state:m,active:!1}},height:{TOP:i[d]===y?this.maxLightHeight:0,BOTTOM:i[v]===y?this.maxLightHeight:0}};this.lightConfig.push(n)}}}]),t}()),O=new(function(){function t(){Object(o.a)(this,t),this.siteURL="https://supersynth.herokuapp.com/app",this.socket=Object(f.a)(this.siteURL,{reconnection:!0,reconnectionDelay:500,reconnectionAttempts:1/0}),this.socket.once("connect",this.subscribe.bind(this))}return Object(l.a)(t,[{key:"subscribe",value:function(){console.log("Connected"),this.socket.on("time",this.logTime.bind(this)),this.socket.on("receiveData",(function(t){x.setPayloadFromDatabase(t)})),this.socket.emit("getData")}},{key:"saveEntry",value:function(){this.socket.emit("saveData",{index:0,data:"Hi this is fresh data"})}},{key:"disconnect",value:function(){console.log("Socket Server Disconnected.")}},{key:"logTime",value:function(t){}},{key:"commitLightConfigData",value:function(){var t=x.getPayloadForDatabase();this.socket.emit("saveData",t)}}]),t}()),S=["svgRef","title"];function L(){return(L=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function C(t,e){if(null==t)return{};var i,n,s=function(t,e){if(null==t)return{};var i,n,s={},a=Object.keys(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||(s[i]=t[i]);return s}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(s[i]=t[i])}return s}var P=function(t){var e=t.svgRef,i=t.title,s=C(t,S);return a.a.createElement("svg",L({width:"28px",height:"28px",viewBox:"0 0 28 28",ref:e},s),i?a.a.createElement("title",null,i):null,n||(n=a.a.createElement("g",{id:"Group-Copy",transform:"translate(0.5 0.5)"},a.a.createElement("g",{id:"Group",transform:"translate(0 0.0012207031)"},a.a.createElement("path",{d:"M0 0L26.8571 0L26.8571 26.5126L0 26.5126L0 0Z",id:"Rectangle",fill:"#FFFFFF",fillRule:"evenodd",stroke:"#000000",strokeWidth:1})),a.a.createElement("path",{d:"M4.68323 11.5706L8.53964 11.5706L8.53964 15.4269L4.68323 15.4269L4.68323 11.5706Z",id:"Rectangle-49-Copy",fill:"#000000",fillRule:"evenodd",stroke:"none"}),a.a.createElement("path",{d:"M13.0839 0L26.8568 0L26.8568 26.5126L13.0839 26.5126L13.0839 0Z",id:"Rectangle-2",fill:"#000000",fillRule:"evenodd",stroke:"none"}),a.a.createElement("path",{d:"M18.1803 11.5703L22.0367 11.5703L22.0367 15.4267L18.1803 15.4267L18.1803 11.5703Z",id:"Rectangle-49",fill:"#FFFFFF",fillRule:"evenodd",stroke:"none"}))))},I=a.a.forwardRef((function(t,e){return a.a.createElement(P,L({svgRef:e},t))})),j=(i.p,{bgBlack:"black",fgWhite:"white"}),T={extraSmall:"8px",kindaSmall:"10px",verySmall:"12px",small:"16px",big:"20px",veryBig:"24px",extraBig:"28px",huge:"32px",veryHuge:"36px",extraHuge:"40px",massive:"44px",veryMassive:"48px",extraMassive:"52px",enormous:"56px",veryEnormous:"60px",extraEnormous:"64px",insane:"68px",veryInsaane:"72px",extraInsane:"76px",gaia:"80px",veryGaia:"84px",extraGaia:"88px"},D="6px",E="8px",G="12px",B="airwavesregular",R="josefin_sanssemibold",H={rotate:p.a.keyframes({"0%":{transform:"rotate(0deg)"},"50%":{transform:"rotate(180deg)"},"100%":{transform:"rotate(360deg)"}})},M={container:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",height:"10vh",paddingLeft:G,paddingRight:G},title:{backgroundColor:j.bgBlack,color:j.fbWhite,padding:G,fontFamily:B,fontSize:T.veryBig,letterSpacing:"2px"},iconContainer:{marginTop:D},simpleRotation:{animation:"x 30s ease-in-out infinite",animationName:H.rotate},icon:{width:"100%",height:"100%"}},W=function(t){Object(u.a)(i,t);var e=Object(g.a)(i);function i(t){var n;return Object(o.a)(this,i),(n=e.call(this,t)).state={},n}return Object(l.a)(i,[{key:"render",value:function(){var t=[M.iconContainer,M.simpleRotation];return a.a.createElement("div",{style:M.block},a.a.createElement("div",{style:M.container},a.a.createElement("div",{style:M.title},"supersynthesis"),a.a.createElement("div",{style:t,onClick:this.handleAbout.bind(this)},a.a.createElement(I,{style:M.icon}))))}},{key:"handleAbout",value:function(){console.log("Create a popup.")}}]),i}(a.a.Component),F=Object(p.a)(W),z=i(77),N=i.n(z),U=function(){function t(e,i,n,s,a){Object(o.a)(this,t),this.p5=e,this.lightWidth=a,this.pos=this.p5.createVector(n,s);var r=this.getNewPos()+this.lightWidth/2;this.topPos=this.p5.createVector(r,s-this.p5.height/2),this.bottomPos=this.p5.createVector(r,s+this.p5.height/2),this.lightColor=this.p5.color("white"),this.lightPointColor=this.p5.color("green"),this.curIdx=i,this.updateHeight(),this.growIntervalId="",setInterval(this.randomizeGrowState.bind(this),3e3)}return Object(l.a)(t,[{key:"draw",value:function(t,e){var i=this.getNewPos();if(this.p5.fill(this.lightColor),this.p5.noStroke(),t||e){this.handleGrowState(d),this.handleGrowState(v);var n=this.getHeight(d);this.p5.rect(i,this.pos.y,this.lightWidth,-n),n=this.getHeight(v),this.p5.rect(i,this.pos.y,this.lightWidth,n)}else this.canDraw(d)&&this.p5.rect(i,this.pos.y,this.lightWidth,-this.p5.height/2),this.canDraw(v)&&this.p5.rect(i,this.pos.y,this.lightWidth,this.p5.height/2)}},{key:"randomizeGrowState",value:function(){var t=this,e=function(e){if(t.getGrowState(e).active);else{var i=t.p5.int(t.p5.random(0,2));i=1===i?w:k,x.setGrowState(t.curIdx,e,i,!1)}};e(d),e(v)}},{key:"handleGrowState",value:function(t){var e=this.getGrowState(t).active,i=this.getGrowState(t).state,n=this.getHeight(t);if(e)switch(i){case m:break;case w:n<this.p5.height/2?(n+=2.5,x.setHeightState(this.curIdx,t,n),this.mapPos(t,n)):x.setGrowState(this.curIdx,t,m,!1);break;case k:n>0?(n-=2.5,x.setHeightState(this.curIdx,t,n),this.mapPos(t,n)):x.setGrowState(this.curIdx,t,m,!1)}}},{key:"mapPos",value:function(t,e){t===d?this.topPos.y=this.p5.map(e,0,this.p5.height/2,this.p5.height/2,0):this.bottomPos.y=this.p5.map(e,0,this.p5.height/2,this.p5.height/2,this.p5.height)}},{key:"drawLightPoint",value:function(){var t=this.getNewPos();this.p5.fill(this.lightPointColor),this.p5.circle(t,this.pos.y,10)}},{key:"getNewPos",value:function(){return this.pos.x+this.lightWidth/2}},{key:"getGrowState",value:function(t){return x.getGrowState(this.curIdx)[t]}},{key:"getHeight",value:function(t){return x.getHeightState(this.curIdx)[t]}},{key:"canDraw",value:function(t){return x.getDrawState(this.curIdx)[t]}},{key:"isOn",value:function(t){return x.getLightState(this.curIdx)[t]===y}},{key:"isGrowing",value:function(t){return x.getGrowState(this.curIdx)[t].active}},{key:"updateGrowState",value:function(t){var e=x.getLightState(this.curIdx)[t],i=x.getGrowState(this.curIdx)[t];e===y&&(i.active||i.state===k&&(x.setGrowState(this.curIdx,t,k,!0),x.setLightState(this.curIdx,t,b))),e===b&&(i.active||i.state===w&&(x.setGrowState(this.curIdx,t,w,!0),x.setLightState(this.curIdx,t,y)))}},{key:"updateDrawState",value:function(t,e){x.setDrawState(this.curIdx,t,e)}},{key:"updateHeight",value:function(){var t=x.getLightState(this.curIdx),e=this.p5.height/2,i=d;t[i]===y&&x.setHeightState(this.curIdx,i,e),t[i]===b&&x.setHeightState(this.curIdx,i,0),t[i=v]===y&&x.setHeightState(this.curIdx,i,e),t[i]===b&&x.setHeightState(this.curIdx,i,0)}}]),t}(),A=function(){function t(e){Object(o.a)(this,t),this.p5=e,this.lights=[],this.curTime=Date.now(),this.gliderIdx=0,this.direction=!0,this.allLightsOff=!1,this.isCurrentlyGrowing=!1,this.timeOn=0}return Object(l.a)(t,[{key:"setup",value:function(){this.prepareLights(),x.setMaxHeight(this.p5.height/2),x.subscribeInfo(this.updateTimeOn.bind(this)),x.subscribeLights(this.updateLights.bind(this))}},{key:"updateTimeOn",value:function(){var t=x.getBpm();this.timeOn=6e4/t}},{key:"updateLights",value:function(){this.resetSystem()}},{key:"prepareLights",value:function(){for(var t=this.p5.width/24,e=t/2,i=0;i<24;i++){var n=i*t,s=new U(this.p5,i,n,this.p5.height/2,e);this.lights.push(s)}}},{key:"draw",value:function(t,e,i){t?this.handleUserInteracting(e,i):(this.isCurrentlyGrowing=!1,this.handleUserNotInteracting());for(var n=0;n<this.lights.length;n++)this.lights[n].draw(t,this.isCurrentlyGrowing)}},{key:"handleUserInteracting",value:function(t,e){this.updateLightConfig(t,e),this.allLightsOff=!1}},{key:"updateLightConfig",value:function(t,e){for(var i=0;i<this.lights.length;i++){var n=this.lights[i],s=t.dist(n.pos);t.y<this.p5.height/2?s<e/2&&n.updateGrowState(d):s<e/2&&n.updateGrowState(v)}}},{key:"handleUserNotInteracting",value:function(){for(var t=0;t<this.lights.length;t++){var e=this.lights[t],i=e.isGrowing(d),n=e.isGrowing(v);this.isCurrentlyGrowing=this.isCurrentlyGrowing||i||n}if((!this.isCurrentlyGrowing&!this.allLightsOff&&this.resetSystem(),!this.isCurrentlyGrowing)&&Date.now()-this.curTime>this.timeOn){var s=this.lights[this.gliderIdx];this.direction?(s.isOn(d)&&(s.updateDrawState(d,!0),this.curTime=Date.now()),this.gliderIdx+=1):(s.isOn(v)&&(s.updateDrawState(v,!0),this.curTime=Date.now()),this.gliderIdx-=1),24===this.gliderIdx&&(this.gliderIdx=23,this.direction=!1),this.gliderIdx<0&&this.resetSystem()}}},{key:"turnOffAllLights",value:function(){console.log("Switch off all lights");for(var t=0;t<this.lights.length;t++){var e=this.lights[t];e.updateDrawState(d,!1),e.updateDrawState(v,!1)}this.allLightsOff=!0}},{key:"resetSystem",value:function(){this.turnOffAllLights(),this.gliderIdx=0,this.direction=!0}}]),t}(),V=function(){function t(e){Object(o.a)(this,t),this.p5=e,this.ellipsePos=this.p5.createVector(0,0),this.boundaryWidth=this.p5.height/2}return Object(l.a)(t,[{key:"draw",value:function(t,e){if(t){this.ellipsePos.x+=.015*(this.p5.mouseX-this.ellipsePos.x),this.ellipsePos.y+=.015*(this.p5.mouseY-this.ellipsePos.y),this.containEllipse();for(var i=0;i<e.length;i++){var n=e[i];if(this.ellipsePos.y<this.p5.height/2){var s=n.topPos,a=n.getHeight(d);a<this.p5.height/2&&a>0&&this.drawLine(s,this.ellipsePos,i)}else{var r=n.bottomPos,h=n.getHeight(v);h<this.p5.height/2&&h>0&&this.drawLine(r,this.ellipsePos,i)}}this.drawEllipse()}}},{key:"containEllipse",value:function(){this.ellipsePos.x>this.p5.width&&(this.ellipsePos.x=this.p5.width),this.ellipsePos.x<0&&(this.ellipsePos.x=0),this.ellipsePos.y>this.p5.height&&(this.ellipsePos.y=this.p5.height),this.ellipsePos.y<0&&(this.ellipsePos.y=0)}},{key:"drawEllipse",value:function(){this.p5.fill(this.p5.color(255,255,255,150)),this.p5.strokeWeight(3),this.p5.stroke(this.p5.color("black")),this.p5.ellipse(this.ellipsePos.x,this.ellipsePos.y,60)}},{key:"drawLine",value:function(t,e,i){var n=this.p5.map(i,0,24,100,200),s=this.p5.map(i,0,25,2,4);this.p5.stroke(this.p5.color(255,255,255,n)),this.p5.strokeWeight(s),this.p5.line(t.x,t.y,e.x,e.y)}}]),t}(),Z=function(){function t(e){Object(o.a)(this,t),this.p5=e,this.curBpm=x.bpm,this.bpmSubscribers=[],this.curTime=""}return Object(l.a)(t,[{key:"update",value:function(t,e,i){if(t){var n=!1;n=e.x>this.p5.width/2&&e.y<this.p5.height/2||e.x<this.p5.width/2&&e.y>this.p5.height/2;for(var s=0,a=0;a<i.length;a++){var r=i[a];r.isOn(d)&&(s+=1),r.isOn(v)&&(s+=1)}var h=Date.now()-this.curTime,o=this.p5.sin(h/s),l=this.p5.map(o,-1,1,0,.25);this.curBpm=n?this.curBpm+l:this.curBpm-l,this.curBpm<100&&(this.curBpm=100),this.curBpm>250&&(this.curBpm=250),x.setBpm(Math.floor(this.curBpm))}else this.curTime=Date.now()}}]),t}(),J=function(t){var e,i,n,s=!1;t.setup=function(){var s=t.select("#canvasContainer").height;t.createCanvas(window.innerWidth,s),e=new A(t),i=new V(t),n=new Z(t),e.setup()},t.draw=function(){t.background(t.color(0,0,0)),e.draw(s,i.ellipsePos,i.boundaryWidth),t.drawCenterLine(),i.draw(s,e.lights),n.update(s,i.ellipsePos,e.lights)},t.drawCenterLine=function(){t.stroke("black"),t.strokeWeight(6),t.line(0,t.height/2,t.width,t.height/2)},t.mousePressed=function(){t.mouseY>t.height||t.mouseY<0||(s=!0)},t.mouseReleased=function(){s=!1}},Y={container:{backgroundColor:j.bgBlack,height:"82vh",margin:0,padding:0}},X=function(t){Object(u.a)(i,t);var e=Object(g.a)(i);function i(t){var n;return Object(o.a)(this,i),(n=e.call(this,t)).containerRef=a.a.createRef(),n.sketchRef=a.a.createRef(),n}return Object(l.a)(i,[{key:"componentDidMount",value:function(){console.log("Wave canvas mounted"),this.myP5=new N.a(J,this.sketchRef.current)}},{key:"render",value:function(){return a.a.createElement("div",{id:"canvasContainer",ref:this.sketchRef,style:Y.container})}}]),i}(a.a.Component),_=Object(p.a)(X),q={container:{position:"absolute",height:"8vh",left:"0",right:"0",bottom:"0",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingLeft:G,paddingRight:G,color:j.fbWhite,fontFamily:R,fontSize:T.lessBig,letterSpacing:"2px"},info:{backgroundColor:j.bgBlack,padding:E}},K=function(t){Object(u.a)(i,t);var e=Object(g.a)(i);function i(t){var n;return Object(o.a)(this,i),(n=e.call(this,t)).state={bpm:"",index:""},x.subscribeInfo(n.onInfoUpdate.bind(Object(c.a)(n))),n}return Object(l.a)(i,[{key:"render",value:function(){var t=this.state.bpm+"bpm",e="#"+this.state.index;return a.a.createElement("div",{style:q.container},a.a.createElement("div",{style:q.info},e),a.a.createElement("div",{style:q.info},t),a.a.createElement("div",{onClick:this.onSend.bind(this),style:q.info},"Send"))}},{key:"onInfoUpdate",value:function(){var t=x.getConfigIndex(),e=x.getBpm();this.setState({index:t+1,bpm:e})}},{key:"onSend",value:function(t){t.stopPropagation(),O.commitLightConfigData()}}]),i}(a.a.Component),Q=Object(p.a)(K),$={container:{position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",flexDirection:"column",color:"white",height:"100vh"},button:{width:"100px",height:"50px",backgroundColor:"white",color:"black"}},tt=function(t){Object(u.a)(i,t);var e=Object(g.a)(i);function i(t){var n;return Object(o.a)(this,i),n=e.call(this,t),window.addEventListener("resize",n.handleResize.bind(Object(c.a)(n))),n.state={isLandscape:n.isLandscape(),isPortrait:n.isPortrait()},n}return Object(l.a)(i,[{key:"render",value:function(){return a.a.createElement("div",{style:$.container},a.a.createElement(F,null),a.a.createElement(_,null),a.a.createElement(Q,null))}},{key:"onClick",value:function(t){t.stopPropagation(),O.saveEntry()}},{key:"handleResize",value:function(){console.log("Resize triggered"),this.setState({isLandscape:this.isLandscape(),isPortrait:this.isPortrait()})}},{key:"isLandscape",value:function(){var t=window.innerHeight<window.innerWidth;return t&&console.log("App: Landscape"),t}},{key:"isPortrait",value:function(){var t=window.innerHeight>window.innerWidth;return t&&console.log("App: Portrait"),t}}]),i}(a.a.Component),et=Object(p.a)(tt),it=i(39);h.a.render(a.a.createElement(it.a,null,a.a.createElement(et,null)),document.getElementById("root"))},79:function(t,e,i){t.exports=i(100)},84:function(t,e,i){},85:function(t,e,i){}},[[79,1,2]]]);
//# sourceMappingURL=main.e1514336.chunk.js.map