{"version":3,"sources":["svg/close.svg","components/CommonStyles.js","svg/about.svg","stores/EditModeStore.js","stores/BpmStore.js","stores/ConfigIndexStore.js","stores/TimerStore.js","stores/LightConfigStore.js","stores/SequencerStore.js","stores/ModeStore.js","stores/SynthStore.js","components/Websocket.js","components/Popup.js","components/Navbar.js","stores/TouchStore.js","components/Light.js","components/SequencerBubble.js","components/LightManager.js","components/MeshManager.js","components/TouchEllipseManager.js","components/BpmManager.js","components/WaveCanvas.js","components/Bottombar.js","components/ModesBar.js","components/App.js","index.js"],"names":["_defs","_g","color","bgBlack","fgWhite","selected","disabled","fontSize","extraSmall","kindaSmall","verySmall","lessSmall","small","lessBig","big","veryBig","extraBig","huge","veryHuge","extraHuge","massive","veryMassive","extraMassive","enormous","veryEnormous","extraEnormous","insane","veryInsaane","extraInsane","gaia","veryGaia","extraGaia","padding","tiny","enourmous","veryInsane","fontFamily","_excluded","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","_ref","svgRef","title","props","createElement","viewBox","ref","id","className","width","height","x1","y1","x2","y2","ForwardRef","forwardRef","isEditMode","isUserInteracting","isPopupActive","subscribers","listener","push","val","isEditing","forEach","s","console","log","dbBpm","localBpm","newBpm","l","configIndex","subscriber","newConfigIndex","popupListener","resetListener","resetTimerId","popupTimerId","clearTimeout","setTimeout","showPopup","bind","PopupType","Send","reset","popupType","LIGHT_STATE","GROW_STATE","dbLightConfig","growConfig","heightConfig","activeLightConfig","maxLightHeight","prepareDefaultLightConfig","hasConfigEdited","configEditSubscriber","Math","round","random","state","active","lightConfig","lightState","TimerStore","cancelReset","growState","activeState","drawConfig","indices","payload","j","idx","MODE","currentMode","newMode","commitToDb","Websocket","commitModeData","localSynthStack","socketState","index","localState","newValue","socketConfigAtIndex","socketIdAtIndex","valueAtIndex","socketId","sendSynthNote","JSON","stringify","data","value","siteURL","webURL","socket","io","reconnection","reconnectionDelay","reconnectionAttempts","Infinity","once","subscribe","on","logTime","processFullPayload","SequencerStore","setSequencerData","ModeStore","setMode","SynthStore","setSynthNotes","emit","getCurrentMode","LightConfigStore","getActiveLightConfig","BpmStore","getLocalBpm","ConfigIndexStore","getConfigIndex","json","Date","setConfigIndex","config","bpm","setDbBpm","setLightConfig","clearConfig","PopupState","About","Score","customFadeIn","Radium","keyframes","from","opacity","to","customFadeOut","styles","overlay","position","top","bottom","left","right","background","zIndex","fadeIn","animationName","animationDuration","animationFillMode","animationTimingFunction","fadeOut","fadeOutUp","fadeOutDown","fadeInDown","fadeInUp","showOverlay","hideOverlay","showContent","hideContent","contentContainer","display","alignItems","justifyContent","content","borderRadius","overflow","maxWidth","maxHeight","stretchContainer","flexDirection","paddingLeft","paddingRight","borderStyle","borderWidth","borderColor","marginTop","marginBottom","textAlign","letterSpacing","lineHeight","sendTitle","subtitle","buttonContainer","flexContainer","button","body","mediaQueryOnText","iconContainer","alignSelf","marginRight","fill","icon","footerContainer","footer","copyright","link","backgroundColor","Popup","isVisible","popupState","React","createRef","overlayStyle","contentContainerStyle","getAboutContent","getSendContent","getScoreContent","onClick","handleOnTouch","onTouchStart","style","onAnimationEnd","contentAnimationEnd","setState","hidePopup","bodyStyle","iconButton","getIconButton","onYesHandle","onNoHandle","getFooter","description","rel","href","event","stopPropagation","EditModeStore","setEditMode","setUserInteracting","commitLightConfigData","current","scrollTop","setIsPopupActive","Component","transform","d","fillRule","stroke","strokeWidth","animation","rotate","container","outline","fbWhite","simpleRotation","Navbar","popupRef","subscribePopup","onShowPopup","subscribeReset","onReset","aboutStyle","heightStyle","getHeightStyle","block","handleAbout","getHeight","deviceHeight","window","innerHeight","deviceWidth","innerWidth","c","orientation","ORIENTATION","PORTRAIT","LANDSCAPE","touches","newTouches","Light","xPos","yPos","lightWidth","p5","growFactor","pos","createVector","newX","getNewPos","topPos","lightActiveColor","lightInactiveColor","lightBgColor","lightPointColor","curIdx","updateHeight","growIntervalId","setInterval","randomizeGrowState","meshEllipsePos","boundaryWidth","noStroke","analyseTouch","setLocalNote","socketStateAtIndex","getSocketStateAtIndex","rect","updateLight","isOnFromDb","canDraw","TouchStore","getTouches","x","dBottomPos","dist","dTopPos","updateGrowState","handleGrowState","curLightState","getActiveLightState","curGrowState","getGrowState","setGrowState","setActiveLightState","curGrowthActive","curHeight","setHeightState","mapPos","onHeight","map","circle","getHeightState","getLightState","getDbLightState","setDrawState","r","int","calcGrowState","SequencerBubble","sequencerActiveColor","sequencerInactiveColor","light","getIndices","ellipse","LightManager","lights","showResetAnimation","curTime","var","dir","sequencerBubble","prepareLights","setMaxHeight","lightIncrement","draw","MeshManager","ellipsePos","prevMouseX","prevMouseY","mouseX","mouseY","containEllipse","drawLine","drawEllipse","strokeWeight","startPoint","endPoint","weight","line","TouchEllipseManager","t","y","posX","posY","bpmManager","curBpm","shouldAdd","sum","isOn","elapsedTime","now","v","sin","mapped","setLocalBpm","floor","sketch","lightManager","meshManager","touchEllipseManager","shouldTrigger","setup","select","createCanvas","BpmManager","update","mousePressed","setTouches","mouseMoved","mouseVal","touchMoved","touchEnded","startTimer","windowResized","resizeCanvas","margin","hide","show","WaveCanvas","containerRef","sketchRef","doesSketchExist","onModeUpdate","myP5","canvasStyle","info","cursor","boxShadow","BottomBar","isSendEnabled","onBpmUpdated","onConfigIndexUpdated","onEditModeUpdate","subscribeForConfigChange","onLightConfigChange","getElements","leftItem","getLeftItem","sendButton","getSendButton","bpmNum","onBack","buttonStyle","onSend","hasConfigChanged","getDbBpm","cancelPopup","selectedButton","ModesBar","synthButton","dreamButton","scoreButton","sweepButton","handleClick","WebkitOverflowScrolling","App","addEventListener","handleResize","evaluateOrientation","document","e","preventDefault","zoom","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.2164ec47.chunk.js","sourcesContent":["var _defs, _g;\n\nvar _excluded = [\"svgRef\", \"title\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar SvgClose = function SvgClose(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    viewBox: \"0 0 48.51 48.51\",\n    ref: svgRef\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", null, title) : null, _defs || (_defs = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"style\", null, \".rect{fill:inherit;}.cls-2{fill:none;stroke:#b3b3b3;stroke-miterlimit:10;stroke-width:4px;}\"))), _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Layer_2\",\n    \"data-name\": \"Layer 2\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Layer_1-2\",\n    \"data-name\": \"Layer 1\"\n  }, /*#__PURE__*/React.createElement(\"rect\", {\n    className: \"rect\",\n    width: 48.51,\n    height: 48.51\n  }), /*#__PURE__*/React.createElement(\"line\", {\n    className: \"cls-2\",\n    x1: 9.63,\n    y1: 9.64,\n    x2: 38.88,\n    y2: 38.89\n  }), /*#__PURE__*/React.createElement(\"line\", {\n    className: \"cls-2\",\n    x1: 9.63,\n    y1: 38.89,\n    x2: 38.88,\n    y2: 9.64\n  })))));\n};\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  return /*#__PURE__*/React.createElement(SvgClose, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/close.787123c6.svg\";\nexport { ForwardRef as ReactComponent };","const color = {\r\n    bgBlack: 'black',\r\n    fgWhite: 'white',\r\n    selected: 'red',\r\n    disabled: 'grey'\r\n};\r\n\r\nconst fontSize = {\r\n    extraSmall: '8px',\r\n    kindaSmall: '10px',\r\n    verySmall: '12px',\r\n    lessSmall: '14px',\r\n    small: '16px',\r\n    lessBig: '18px',\r\n    big: '20px',\r\n    veryBig: '24px',\r\n    extraBig: '28px',\r\n    huge: '32px',\r\n    veryHuge: '36px',\r\n    extraHuge: '40px',\r\n    massive: '44px',\r\n    veryMassive: '48px',\r\n    extraMassive: '52px',\r\n    enormous: '56px',\r\n    veryEnormous: '60px',\r\n    extraEnormous: '64px',\r\n    insane: '68px',\r\n    veryInsaane: '72px',\r\n    extraInsane: '76px',\r\n    gaia: '80px',\r\n    veryGaia: '84px',\r\n    extraGaia: '88px'\r\n};\r\n\r\nconst padding = {\r\n    tiny: '2px',\r\n    // Increments of 4\r\n    extraSmall: '4px',\r\n    kindaSmall: '6px',\r\n    verySmall: '8px',\r\n    small: '12px',\r\n    lessBig: '16px',\r\n    // Incremenets of 8\r\n    big : '20px',\r\n    veryBig : '28px',\r\n    extraBig : '36px',\r\n    // Increments of 12\r\n    huge: '52px',\r\n    veryHuge: '64px',\r\n    extraHuge: '76px',\r\n    // Incremenets of 16\r\n    massive: '92px',\r\n    veryMassive: '108px',\r\n    extraMassive: '124px',\r\n    // Increment of 20\r\n    enourmous: '100px',\r\n    veryEnormous: '120px',\r\n    extraEnormous: '140px',\r\n    // Increment of 40\r\n    insane: '160px',\r\n    veryInsane: '200px',\r\n    extraInsane: '240px'\r\n\r\n};\r\n\r\nconst fontFamily = {\r\n    heatwave: 'heatwaveregular',\r\n    airwaves: 'airwavesregular',\r\n    josefin: 'josefin_sanssemibold'\r\n};\r\n\r\nexport { color, fontSize, fontFamily, padding };","var _g;\n\nvar _excluded = [\"svgRef\", \"title\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar SvgAbout = function SvgAbout(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"28px\",\n    height: \"28px\",\n    viewBox: \"0 0 28 28\",\n    ref: svgRef\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", null, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Group-Copy\",\n    transform: \"translate(0.5 0.5)\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Group\",\n    transform: \"translate(0 0.0012207031)\"\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M0 0L26.8571 0L26.8571 26.5126L0 26.5126L0 0Z\",\n    id: \"Rectangle\",\n    fill: \"#FFFFFF\",\n    fillRule: \"evenodd\",\n    stroke: \"#000000\",\n    strokeWidth: 1\n  })), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.68323 11.5706L8.53964 11.5706L8.53964 15.4269L4.68323 15.4269L4.68323 11.5706Z\",\n    id: \"Rectangle-49-Copy\",\n    fill: \"#000000\",\n    fillRule: \"evenodd\",\n    stroke: \"none\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M13.0839 0L26.8568 0L26.8568 26.5126L13.0839 26.5126L13.0839 0Z\",\n    id: \"Rectangle-2\",\n    fill: \"#000000\",\n    fillRule: \"evenodd\",\n    stroke: \"none\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M18.1803 11.5703L22.0367 11.5703L22.0367 15.4267L18.1803 15.4267L18.1803 11.5703Z\",\n    id: \"Rectangle-49\",\n    fill: \"#FFFFFF\",\n    fillRule: \"evenodd\",\n    stroke: \"none\"\n  }))));\n};\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  return /*#__PURE__*/React.createElement(SvgAbout, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/about.ea00a3b0.svg\";\nexport { ForwardRef as ReactComponent };","// Name: EditModeStore.js\r\n// Author: Amay Kataria. \r\n// Date: 02/24/2022\r\n// Description: This data store keeps track of when the user is interacting with the canvas and when\r\n// are we ready to remove that interactive pattern. \r\n\r\nclass EditModeStore {\r\n    constructor() {\r\n        this.isEditMode = false; \r\n        this.isUserInteracting = false; \r\n        this.isPopupActive = false; \r\n        this.subscribers = []; \r\n    }\r\n\r\n    subscribe(listener) {\r\n        this.subscribers.push(listener); \r\n    }\r\n\r\n    setEditMode(val) {\r\n        if (this.isEditing !== val) {\r\n            this.isEditMode = val;\r\n            this.subscribers.forEach(s => s()); \r\n        }\r\n    }\r\n\r\n    setUserInteracting(val) {\r\n        if (this.isUserInteracting !== val) {\r\n            console.log('User Interacting: ' + val)\r\n            this.isUserInteracting = val; \r\n            this.subscribers.forEach(s => s());\r\n        }\r\n    }\r\n\r\n    setIsPopupActive(val) {\r\n        if (this.isPopupActive !== val) {\r\n            console.log('Popup Active:' + val);\r\n            this.isPopupActive = val; \r\n            this.subscribers.forEach(s => s());\r\n        }\r\n    }\r\n}\r\n\r\nexport default new EditModeStore();","// Name: BpmStore.js\r\n// Author: Amay Kataria\r\n// Date: 03/03/2022\r\n// Description: This data store is respnsible to hold the Bpm that is retrieved from the database\r\n// as well as the Bpm that the user is synthesisizng locally. \r\n\r\nclass BpmStore {\r\n    constructor() {\r\n        // Bpm coming from the database. \r\n        this.dbBpm = 100;\r\n        // Locally modified Bpm. \r\n        this.localBpm = 100; \r\n\r\n        // Fire this when new Bpm is received from the database. \r\n        this.subscribers = [];\r\n    }\r\n\r\n    subscribe(listener) {\r\n        this.subscribers.push(listener);\r\n    }\r\n\r\n    getDbBpm() {\r\n        return this.dbBpm; \r\n    }\r\n\r\n    getLocalBpm() {\r\n        return this.localBpm; \r\n    }\r\n\r\n    setDbBpm(newBpm) {\r\n        // New payload from db. \r\n        // Reset both db and local bpm. \r\n        this.dbBpm = newBpm;\r\n        this.localBpm =  newBpm;\r\n\r\n        // Let subscribers know new Bpm values are updated. \r\n        this.subscribers.forEach(l => {\r\n            l();\r\n        });\r\n    }\r\n\r\n    setLocalBpm(localBpm) {\r\n        // Whenever local bpm gets updated, we want to let \r\n        // subscribers know that we have new values. \r\n        if (this.localBpm !== localBpm) {\r\n            this.localBpm = localBpm;\r\n            // console.log(this.localBpm);\r\n            this.subscribers.forEach(l => {\r\n                l();\r\n            });\r\n        }\r\n    }\r\n}\r\n\r\nexport default new BpmStore(); ","// Name: ConfigIndexStore.js\r\n// Author: Amay Kataria\r\n// Date: 03/03/2022\r\n// Description: This data store is responsible to store the current config index on top\r\n// of which the user is actually drawing the pattern. \r\n\r\nclass ConfigIndexStore {\r\n    constructor() {\r\n        // Default values. \r\n        this.configIndex = 0; \r\n        this.subscriber = ''; \r\n    }\r\n\r\n    getConfigIndex() {\r\n        return this.configIndex; \r\n    }\r\n\r\n    subscribe(listener) {\r\n        this.subscriber = listener; \r\n    }\r\n\r\n    setConfigIndex(newConfigIndex) {\r\n        this.configIndex = newConfigIndex;\r\n        // Let subscriber know we have updates. \r\n        this.subscriber(); \r\n    }\r\n}\r\n\r\nexport default new ConfigIndexStore(); ","// Name: TimerStore.js\n// Author: Amay Kataria. \n// Date: 03/11/2022\n// Description: A simple data store to start a timer whenever a user stops interacting on the screen.\n// This time helps us schedule some events like initiating a popup for sending a message.\n\nimport { PopupType } from \"../components/Popup\";\n\nconst POPUP_TIME = 3000;\nconst RESET_TIME = 30000; \nclass TimerStore {\n    constructor() {\n        this.isEditMode = false; \n\n        this.popupListener = ''; \n        this.resetListener = '';\n        this.resetTimerId = ''; \n        this.popupTimerId = ''\n    }\n\n    subscribePopup(listener) {\n        this.popupListener = listener; \n    }\n\n    subscribeReset(listener) {\n        this.resetListener = listener; \n    }\n\n    startTimer() {\n        if (this.popupTimerId !== '') {\n            clearTimeout(this.popupTimerId);\n        }\n        // This popup is always to SEND the score out.\n        this.popupTimerId = setTimeout(this.showPopup.bind(this, PopupType.Send), POPUP_TIME);\n\n        if (this.resetTimerId !== '') {\n            clearTimeout(this.resetTimerId); \n        }\n        this.resetTimerId = setTimeout(this.reset.bind(this), RESET_TIME); \n    }\n    \n    showPopup(popupType) {\n        console.log('Showing Popup: ' + popupType);\n        this.popupListener(popupType); \n        this.popupTimerId = ''; \n    }\n\n    reset() {\n        console.log('Trigger reset');\n        this.resetListener(); \n    }\n\n    cancelReset() {\n        if (this.resetTimerId !== '') {\n            console.log('Clearing Reset');\n            clearTimeout(this.resetTimerId);\n            this.resetTimerId = ''; \n        }\n    }\n\n    cancelPopup() {\n        console.log('Clearing Popup');\n        clearTimeout(this.popupTimerId);\n        this.popupTimerId = '';\n    }\n}\n\nexport default new TimerStore();","// Name: LightConfigStore.js\r\n// Author: Amay Kataria. \r\n// Date: 02/19/2022\r\n// Description: Core data store for the application that stores the data for all the 24 lights. This data is divided\r\n// into four states: light, height, grow, and draw. These states are responsible for how the lights are drawn and \r\n// transmitted to the database. \r\n\r\nimport TimerStore from \"./TimerStore\";\r\n\r\nexport const LIGHT_STATE = {\r\n    ON: 1,\r\n    OFF: 0\r\n};\r\n\r\nexport const GROW_STATE = {\r\n    NONE: 0,\r\n    GROW: 1,\r\n    SHRINK: 2\r\n}\r\n\r\nconst NUM_LIGHTS = 24;\r\n\r\nclass LightConfigStore {\r\n    constructor() {\r\n        // Separate config arrays for the 24 lights.\r\n        this.dbLightConfig = []; // What comes from the dB. Don't modify this. \r\n        this.growConfig = [];\r\n        this.heightConfig = []; \r\n        this.activeLightConfig = []; // Currently being edited in the app. \r\n\r\n        // Helper value to create default heights. \r\n        this.maxLightHeight = 0;\r\n\r\n        // Default light config for 24 lights. \r\n        this.prepareDefaultLightConfig();\r\n        \r\n        this.hasConfigEdited = false; \r\n        this.configEditSubscriber = ''\r\n    }\r\n\r\n    subscribeForConfigChange(listener) {\r\n        this.configEditSubscriber = listener; \r\n    }\r\n\r\n    setMaxHeight(height) {\r\n        this.maxLightHeight = height; \r\n    }\r\n\r\n    // Default config for 24 lights. \r\n    prepareDefaultLightConfig() {\r\n        console.log('Preparing default config.');\r\n        for (let i = 0; i < NUM_LIGHTS; i++) {\r\n            // All lights are off by default and are not doing any growth. \r\n            // Just a simple helper routine.\r\n            let r = Math.round(Math.random());\r\n            let s = r === 0 ? LIGHT_STATE.ON : LIGHT_STATE.OFF; \r\n            this.dbLightConfig.push(s);\r\n            this.activeLightConfig.push(s); \r\n            this.growConfig.push({state: GROW_STATE.NONE, active: false});\r\n            this.heightConfig.push(0); \r\n        }\r\n    }\r\n\r\n    getActiveLightConfig() {\r\n        // Return the one that we have been editing. \r\n        return this.activeLightConfig; \r\n    }\r\n    // Sets the light config along with other configs that \r\n    // coming from the server. Overwrite activeLightConfig as well.\r\n    setLightConfig(lightConfig) {\r\n        for (let i = 0; i < lightConfig.length; i++) {\r\n            let lightState = lightConfig[i];\r\n            this.dbLightConfig[i] = lightState; \r\n            this.activeLightConfig[i] = lightState; \r\n            this.growConfig[i] = {state: GROW_STATE.NONE, active: false}; // Reset growth on every light. \r\n            this.heightConfig[i] = (lightState === LIGHT_STATE.ON) ? this.maxLightHeight : 0; \r\n            // Don't modify Draw State. That is modified by the sequencer event. \r\n        }\r\n\r\n        if (this.hasConfigEdited === true) {\r\n            this.hasConfigEdited = false; \r\n            this.configEditSubscriber(); \r\n        }\r\n    }\r\n\r\n    // Light config from the database. \r\n    getDbLightState(i) {\r\n        return this.dbLightConfig[i];\r\n    }\r\n    // Light config that is actively being edited. \r\n    getActiveLightState(i) {\r\n        return this.activeLightConfig[i];\r\n    }\r\n    setActiveLightState(i, lightState) {\r\n        this.activeLightConfig[i] = lightState; \r\n\r\n        if (this.hasConfigEdited === false) {\r\n            this.hasConfigEdited = true;\r\n            this.configEditSubscriber();\r\n        }\r\n\r\n        TimerStore.cancelReset();\r\n    }\r\n\r\n    // GET/SET light's grow state. \r\n    getGrowState(i) {\r\n        return this.growConfig[i];\r\n    }\r\n    setGrowState(i, growState, activeState) {\r\n        this.growConfig[i]['state'] = growState;\r\n        this.growConfig[i]['active'] = activeState;\r\n    }\r\n\r\n    // GET/SET light's heights. \r\n    getHeightState(i) {\r\n        return this.heightConfig[i];\r\n    }\r\n    setHeightState(i, height) {\r\n        this.heightConfig[i] = height; \r\n    }\r\n}\r\n\r\nexport default new LightConfigStore();","// Name: SequencerStore.js\r\n// Author: Amay Kataria. \r\n// Date: 03/03/2022\r\n// Description: A data store to keep track of all data coming from the sequencer\r\n// events from the central server. \r\n\r\nimport { LIGHT_STATE } from \"./LightConfigStore\";\r\nconst NUM_LIGHTS = 24;\r\n\r\nclass SequencerStore {\r\n    constructor() {\r\n        this.drawConfig = [];\r\n        this.indices = []; \r\n    }\r\n\r\n    getIndices() {\r\n        return this.indices;\r\n    }\r\n\r\n    setSequencerData(payload) {\r\n        this.indices = []; \r\n        let lightState = payload['state'];\r\n        if (lightState === 'NONE') {\r\n            // Turn off all the lights. \r\n            for (let i = 0; i < NUM_LIGHTS; i++) {\r\n                this.drawConfig[i] = LIGHT_STATE.OFF;\r\n            }\r\n            this.indices = []; \r\n        } else {\r\n            for (let i = 0; i < lightState.length; i++) {\r\n                // All data is in an array. \r\n                let s = lightState[i];\r\n                // Reset indices before\r\n                for (let j = 0; j < s.length; j++) {\r\n                    let idx = s[j]['idx'];\r\n                    let val = s[j]['val'];\r\n                    this.drawConfig[idx] = val; \r\n                    this.indices[j] = idx; \r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    clearConfig() {\r\n        this.drawConfig.length = 0;\r\n    }\r\n\r\n    getLightState(i) {\r\n        return this.drawConfig[i];\r\n    }\r\n}\r\n\r\nexport default new SequencerStore();","// Name: ModeStore.js\r\n// Author: Amay Kataria\r\n// Date: 04/13/2023\r\n// Description: This data store is responsible to store the current mode (Synth, Dream, Score, or Sweep)\r\n// that the installation is currently in.\r\n\r\nimport Websocket from \"../components/Websocket\";\r\n\r\n// Use these enum denominations throughout.\r\nexport const MODE = {\r\n    SYNTH: 0,\r\n    DREAM: 1, \r\n    SCORE: 2, \r\n    SWEEP: 3\r\n};\r\n\r\nclass ModeStore {\r\n    constructor() {\r\n        // What is the default mode? \r\n        this.currentMode = MODE.SYNTH; \r\n\r\n        // Fire this when the mode is changing or something is happenign.\r\n        this.subscribers = [];\r\n    }\r\n\r\n    subscribe(listener) {\r\n        this.subscribers.push(listener);\r\n    }\r\n\r\n    getCurrentMode() {\r\n        return this.currentMode; \r\n    }\r\n\r\n    setMode(newMode, commitToDb) {\r\n        if (this.currentMode !== newMode) {\r\n            // Set the mode\r\n            this.currentMode = newMode;\r\n    \r\n            // Let subscribers know new Bpm values are updated. \r\n            this.subscribers.forEach(l => {\r\n                l(newMode);\r\n            });\r\n            \r\n            if (commitToDb) {\r\n                // Commit this data to the database.\r\n                Websocket.commitModeData();\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport default new ModeStore(); ","// Name: SynthStore.js\r\n// Author: Amay Kataria\r\n// Date: 04/24/2023\r\n// Description: This data store is responsible to store, transmit, and receive \r\nimport Websocket from \"../components/Websocket\";\r\n\r\nclass SynthStore {\r\n    constructor() {\r\n        this.localSynthStack = []; \r\n        // Accumulated state from multiple clients.\r\n        this.socketState = '';\r\n    }\r\n\r\n    // Is the local state of this index the same as the socket state?\r\n    canModify(index) {\r\n        return this.localState[index] === this.socketState[index]; \r\n    }\r\n\r\n    setLocalNote(index, newValue) {\r\n        // Have I connected to the app? \r\n        if (this.socketState) {\r\n            // Socket config data\r\n            const socketConfigAtIndex = this.socketState[index];\r\n            const socketIdAtIndex = socketConfigAtIndex['socketId'];\r\n            const valueAtIndex = socketConfigAtIndex['val'];\r\n\r\n            // Current socketId\r\n            const socketId = Websocket.socketId; \r\n\r\n            // 0 -> 1\r\n            if (valueAtIndex === 0 && newValue === 1) {\r\n                // console.log('0 to 1');\r\n                const payload = [index, newValue, Websocket.socketId];\r\n                Websocket.sendSynthNote(JSON.stringify(payload));\r\n            }\r\n\r\n            // 1 -> 0\r\n            if ((valueAtIndex === 1) && (newValue === 0) && (socketId === socketIdAtIndex)) {\r\n                // console.log('1 to 0');\r\n                const payload = [index, newValue, Websocket.socketId];\r\n                Websocket.sendSynthNote(JSON.stringify(payload));\r\n            }\r\n        }\r\n    }\r\n\r\n    // New data that has been received from the socket.\r\n    setSynthNotes(data) {\r\n        // console.log(data);\r\n        this.socketState = data; \r\n        // console.log('Socket State: ' + this.socketState);\r\n    }\r\n\r\n    getLocalNote(index, value) {\r\n        return this.localState[index];\r\n    }\r\n\r\n    getSocketStateAtIndex(index) {\r\n        if (this.socketState) {\r\n            return this.socketState[index];\r\n        } else {\r\n            return null; \r\n        }\r\n    }\r\n}\r\n\r\nexport default new SynthStore(); ","/*\r\n  Name: Websocket.js\r\n  Author: Amay Kataria\r\n  Date: 02/15/2022\r\n  Description: Class responsible for communication with the webserver. We use websockets\r\n  technology for this. Here we have the websocket client, which communicates with backend\r\n  server over websockets.\r\n*/\r\n\r\nimport io  from 'socket.io-client'\r\nimport BpmStore from '../stores/BpmStore';\r\nimport ConfigIndexStore from '../stores/ConfigIndexStore';\r\nimport LightConfigStore from '../stores/LightConfigStore';\r\nimport SequencerStore from '../stores/SequencerStore';\r\nimport ModeStore from '../stores/ModeStore';\r\nimport SynthStore from '../stores/SynthStore';\r\n\r\n//const webURL = \"http://localhost:5000\";\r\nconst webURL = \"https://supersynth.herokuapp.com\";\r\n\r\nconst EVENT_SCORE_PAYLOAD = 'event_score_payload';\r\nconst EVENT_TIME = 'event_time';\r\nconst EVENT_FULL_PAYLOAD = 'event_full_payload';\r\nconst EVENT_SEQUENCER_PAYLOAD = 'event_sequencer_payload';\r\nconst EVENT_SOCKET_ID = 'event_socket_id';\r\n\r\n// SYNTH events\r\nconst EVENT_SYNTH_NOTES = 'event_synth_notes';\r\n\r\n// Mode events\r\nconst EVENT_MODE_PAYLOAD = 'event_mode_payload';\r\n\r\nclass Websocket {\r\n  constructor() {\r\n      this.siteURL = webURL + '/app'; \r\n\r\n      this.socket = io(this.siteURL, {\r\n          reconnection: true,\r\n          reconnectionDelay: 500,\r\n          reconnectionAttempts: Infinity\r\n      });\r\n\r\n      // I know who I am.\r\n      this.socketId = ''; \r\n\r\n      this.socket.once('connect', this.subscribe.bind(this));\r\n  }\r\n\r\n  subscribe() {\r\n      console.log('Connected');\r\n      // Subscribe to incoming events from the webserver here. \r\n      this.socket.on(EVENT_TIME, this.logTime.bind(this));\r\n      // Show up when user starts interacting.\r\n      this.socket.on(EVENT_FULL_PAYLOAD, (payload) => {\r\n        this.processFullPayload(payload); \r\n      }); \r\n      // Shows the data when user is not interacting\r\n      this.socket.on(EVENT_SEQUENCER_PAYLOAD, data => {\r\n        SequencerStore.setSequencerData(data);\r\n      });\r\n      // Read the initial data about the Modes.\r\n      this.socket.on(EVENT_MODE_PAYLOAD, (currentMode) => {\r\n        ModeStore.setMode(currentMode, false);\r\n      });\r\n      this.socket.on(EVENT_SYNTH_NOTES, data => {\r\n        SynthStore.setSynthNotes(data);\r\n      });\r\n      this.socket.on(EVENT_SOCKET_ID, data => {\r\n        this.socketId = data;\r\n        console.log('SocketId: ' + this.socketId);\r\n      })\r\n  }\r\n\r\n  // -------------------- DON'T CHANGE THESE -------------------    \r\n  disconnect() {\r\n      console.log('Socket Server Disconnected.');\r\n  }\r\n\r\n  logTime(data) {\r\n    // console.log('Socket Connection Alive: ' + data);\r\n  }\r\n\r\n  sendSynthNote(payload) {\r\n    this.socket.emit(EVENT_SYNTH_NOTES, payload);\r\n  }\r\n\r\n  commitModeData() {\r\n    // Store mode data to the database.\r\n    let currentMode = ModeStore.getCurrentMode();\r\n    this.socket.emit(EVENT_MODE_PAYLOAD, currentMode);\r\n  }\r\n\r\n  commitLightConfigData() {\r\n    // Extract data from stores. \r\n    let lightConfig = LightConfigStore.getActiveLightConfig();\r\n    let localBpm = BpmStore.getLocalBpm();\r\n    let configIndex = ConfigIndexStore.getConfigIndex() + 1; \r\n\r\n    // Create the JSON.\r\n    this.json = {};\r\n    this.json['bpm'] = localBpm; \r\n    this.json['lights'] = lightConfig; \r\n    this.json['time'] = Date(); \r\n\r\n    // Finalize payload\r\n    let payload = {\r\n      'index': configIndex,\r\n      'config': JSON.stringify(this.json)\r\n    };\r\n\r\n    // Emit payload.\r\n    this.socket.emit(EVENT_SCORE_PAYLOAD, payload);\r\n  }\r\n\r\n  processFullPayload(payload) {\r\n    // Config index. \r\n    let configIndex = payload['index'];\r\n    ConfigIndexStore.setConfigIndex(configIndex);\r\n\r\n    let config = payload['config'];\r\n\r\n    // Bpm.\r\n    let bpm = config['bpm'];\r\n    BpmStore.setDbBpm(bpm);\r\n\r\n    // Light config.\r\n    let lightConfig = config['lights'];\r\n    LightConfigStore.setLightConfig(lightConfig);\r\n\r\n    // Clear the current configuration so we can restart \r\n    // again. \r\n    SequencerStore.clearConfig();\r\n  }\r\n}\r\n\r\nexport default new Websocket();","/*\r\n  Name: Popup.js\r\n  Author: Amay Kataria\r\n  Date: 02/21/2022\r\n  Description: Popup component that is shown to display the about information. \r\n*/\r\n\r\nimport React from 'react'\r\nimport Radium from 'radium'\r\nimport { color, padding, fontFamily, fontSize } from './CommonStyles.js'\r\nimport { ReactComponent as Exit } from '../svg/close.svg'\r\nimport { fadeOutUp, fadeOutDown, fadeInDown, fadeInUp } from 'react-animations'\r\nimport EditModeStore from '../stores/EditModeStore.js'\r\nimport Websocket from './Websocket.js'\r\nimport TimerStore from '../stores/TimerStore.js'\r\n\r\n// Maintain the current popup state (to track animations)\r\nvar PopupState = {\r\n    Open: 0,\r\n    Close: 1,\r\n    None: 2\r\n}; \r\n\r\nexport var PopupType = {\r\n    About: 0,\r\n    Send: 1,\r\n    Score: 2\r\n}\r\n\r\n// Custom Fade in animation. \r\nconst customFadeIn = Radium.keyframes({\r\n    from: {\r\n        opacity: '0'\r\n    },\r\n    to: {\r\n        opacity: '0.5'\r\n    }\r\n}, 'fadesIn'); \r\n\r\nconst customFadeOut = Radium.keyframes({\r\n    from: {\r\n        opacity: '0.5'\r\n    },\r\n    to: {\r\n        opacity: '0'\r\n    }\r\n}, 'fadesOut'); \r\n\r\nconst fadeInDuration = '0.5s'; \r\nconst slideInDuration = '1.0s'; \r\nconst fadeOutDuration = '0.5s';\r\n\r\nconst aboutTheWork = 'Supersynthesis is an interactive audio-visual art installation that invites people to create a space for collective expression and participation. Accompanied with a physical installation, it utilizes the medium of light and sound to craft a communal experience where the audience activates the piece and the space around it by interacting with it through an online interface. Every audience input is blended into the previous response, thus synthesizing a progressively evolving wave of expression. In an increasingly fragmented society, this project aspires to create an inclusive space, where anybody can leave a trace of their thought with freedom. By participating in Supersynthesis, one becomes part of a communal wave thatll anonymously accumulate until the forthcoming eternity.';\r\nconst styles={\r\n    overlay: {\r\n        position: 'fixed',\r\n        top: '0px',\r\n        bottom: '0px',\r\n        left: '0px',\r\n        right: '0px',\r\n        background: color.bgBlack,\r\n        zIndex: '999'\r\n    },\r\n\r\n    fadeIn: {\r\n        animationName: customFadeIn,\r\n        animationDuration: fadeInDuration,\r\n        animationFillMode: 'forwards',\r\n        animationTimingFunction:'ease-in'\r\n    },\r\n    \r\n    fadeOut: {\r\n        animationName: customFadeOut,\r\n        animationDuration: fadeOutDuration,\r\n        animationFillMode: 'forwards',\r\n        animationTimingFunction: 'ease-out'\r\n    },\r\n\r\n    fadeOutUp: {\r\n        animationName: Radium.keyframes(fadeOutUp, 'fadeOutUp'),\r\n        animationDuration: fadeOutDuration,\r\n        animationFillMode: 'forwards',\r\n        animationTimingFunction: 'ease-out'\r\n    },\r\n\r\n    fadeOutDown: {\r\n        animationName: Radium.keyframes(fadeOutDown, 'fadeOutDown'),\r\n        animationDuration: fadeOutDuration,\r\n        animationFillMode: 'forwards',\r\n        animationTimingFunction: 'ease-out'\r\n    },\r\n\r\n    fadeInDown: {\r\n        animationName: Radium.keyframes(fadeInDown, 'fadeInDown'),\r\n        animationDuration: slideInDuration,\r\n        animationFillMode: 'forwards',\r\n        animationTimingFunction: 'ease-in'\r\n    },\r\n\r\n    fadeInUp: {\r\n        animationName: Radium.keyframes(fadeInUp, 'fadeInUp'),\r\n        animationDuration: slideInDuration,\r\n        animationFillMode: 'forwards',\r\n        animationTimingFunction: 'ease-in'\r\n    },\r\n\r\n    showOverlay: {\r\n        zIndex: '998',\r\n        opacity: '1'\r\n    },\r\n\r\n    hideOverlay: {\r\n        zIndex: '-998',\r\n        opacity: '0'\r\n    },\r\n\r\n    showContent: {\r\n        zIndex: '999',\r\n        opacity: '1'\r\n    },\r\n\r\n    hideContent: {\r\n        zIndex: '-999',\r\n        opacity: '0'\r\n    },\r\n\r\n    contentContainer: {\r\n        position: 'fixed',\r\n        zIndex: '-999',\r\n        left: '0px',\r\n        top:'0px',\r\n        bottom: '0px',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        height: '100%',\r\n        width: '100%',\r\n    },\r\n\r\n    content: {\r\n        borderRadius: fontSize.tiny,\r\n        overflow: 'auto',\r\n        maxWidth: 'calc(100% - 50px)', // Bind this to media query\r\n        maxHeight: 'calc(100% - 100px)', // Bind this to media query\r\n        \r\n        '@media (min-width: 600px)': {      \r\n            maxWidth: 'calc(100% - 100px)', // Bind this to media query\r\n            maxHeight: 'calc(100% - 100px)', // Bind this to media query\r\n        },\r\n\r\n        '@media (min-width: 750px)': {  \r\n            maxWidth: 'calc(100% - 150px)', // Bind this to media query\r\n            maxHeight: 'calc(100% - 100px)', // Bind this to media query\r\n        },\r\n\r\n        '@media (min-width: 1200px)' : {\r\n            maxWidth: 'calc(100% - 300px)', // Bind this to media query\r\n            maxHeight: 'calc(100% - 100px)', // Bind this to media query\r\n        }\r\n    },\r\n\r\n    stretchContainer: {\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        alignItems: 'center',\r\n        background: color.bgBlack,\r\n        color: color.fgWhite,\r\n        paddingLeft: padding.small, // Bind this to media query\r\n        paddingRight: padding.small, // Bind this to media query,\r\n\r\n        '@media (min-width: 600px)': {      \r\n            paddingLeft: padding.extraHuge, \r\n            paddingRight: padding.extraHuge\r\n        },\r\n\r\n        '@media (min-width: 900px)': {  \r\n            paddingLeft: padding.veryMassive, \r\n            paddingRight: padding.veryMassive\r\n        },\r\n\r\n        '@media (min-width: 1200px)' : {\r\n            paddingLeft: padding.extraMassive, \r\n            paddingRight: padding.extraMassive\r\n        },\r\n        opacity: '1.0',\r\n        borderStyle: 'solid',\r\n        borderWidth: '2px',\r\n        borderColor: color.fgWhite\r\n    },\r\n\r\n    title: {\r\n        marginTop: padding.lessSmall,\r\n        marginBottom: padding.small,\r\n        textAlign: 'center',\r\n        fontFamily: fontFamily.heatwave,\r\n        fontSize: fontSize.extraBig,\r\n        letterSpacing: '2.5px',\r\n        lineHeight: '1.8',\r\n       \r\n        '@media (min-width: 750px)': {  \r\n            fontSize: fontSize.extraBig\r\n        },\r\n\r\n        '@media (min-width: 900px)': {  \r\n            fontSize: fontSize.huge\r\n        },\r\n\r\n        '@media (min-width: 1200px)' : {\r\n            fontSize: fontSize.veryHuge\r\n        }\r\n    },\r\n\r\n    sendTitle: {\r\n        marginTop: padding.small,\r\n        textAlign: 'center',\r\n        fontFamily: fontFamily.heatwave,\r\n        fontSize: fontSize.extraBig,\r\n        letterSpacing: '2.5px',\r\n\r\n        '@media (min-width: 750px)': {  \r\n            fontSize: fontSize.extraBig\r\n        },\r\n\r\n        '@media (min-width: 900px)': {  \r\n            fontSize: fontSize.huge\r\n        },\r\n\r\n        '@media (min-width: 1200px)' : {\r\n            fontSize: fontSize.veryHuge\r\n        }\r\n    },\r\n\r\n    subtitle: {\r\n        marginBottom: padding.lessBig,\r\n        textAlign: 'center',\r\n        fontFamily: fontFamily.heatwave,\r\n        fontSize: fontSize.verySmall,\r\n        letterSpacing: '2.5px',\r\n       \r\n        '@media (min-width: 750px)': {  \r\n            fontSize: fontSize.lessSmall\r\n        },\r\n\r\n        '@media (min-width: 900px)': {  \r\n            fontSize: fontSize.small\r\n        },\r\n\r\n        '@media (min-width: 1200px)' : {\r\n            fontSize: fontSize.small\r\n        }\r\n    },\r\n\r\n    buttonContainer: {\r\n        display: 'flex',\r\n        flexContainer: 'row',\r\n        marginTop: padding.extraSmall,\r\n        marginBottom: padding.big,\r\n        justifyContent: 'space-evenly'\r\n    },\r\n\r\n    button: {\r\n        background: color.fgWhite,\r\n        padding: padding.verySmall,\r\n        color: color.bgBlack,\r\n        fontFamily: fontFamily.heatwave,\r\n        letterSpacing: '2.5px',\r\n        fontSize: fontSize.small,\r\n               \r\n        '@media (min-width: 750px)': {  \r\n            fontSize: fontSize.lessBig\r\n        },\r\n\r\n        '@media (min-width: 900px)': {  \r\n            fontSize: fontSize.big\r\n        },\r\n\r\n        '@media (min-width: 1200px)' : {\r\n            fontSize: fontSize.veryBig\r\n        }\r\n    },\r\n\r\n    body: {\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        justifyContent: 'center',\r\n        fontFamily: fontFamily.josefin,\r\n        letterSpacing: '1.5px',\r\n        fontSize: fontSize.small,\r\n        color: color.fgWhite\r\n    },\r\n\r\n    // Applied on stuff\r\n    mediaQueryOnText: {\r\n        '@media (min-width: 750px)': {  \r\n            fontSize: fontSize.big\r\n        },\r\n\r\n        '@media (min-width: 900px)': {  \r\n            fontSize: fontSize.veryBig\r\n        }\r\n    },\r\n\r\n    iconContainer: {\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        alignSelf: 'flex-end',\r\n        marginRight: '-' + fontSize.verySmall,\r\n        height: fontSize.big,\r\n        width: fontSize.big,\r\n        fill: color.fgWhite,\r\n\r\n        '@media (min-width: 600px)': {  \r\n            marginRight: '-' + fontSize.extraInsane,\r\n            height: fontSize.veryBig, \r\n            width: fontSize.veryBig\r\n        },\r\n\r\n        '@media (min-width: 900px)': {  \r\n            height: fontSize.extraBig, \r\n            width: fontSize.extraBig,\r\n            marginRight: '-108px'\r\n        },\r\n\r\n        '@media (min-width: 1200px)': {  \r\n            marginRight: '-124px'\r\n        }\r\n    },\r\n\r\n    icon: { \r\n        width: '100%',\r\n        height: '100%'\r\n    },\r\n\r\n    footerContainer: {\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        alignItems: 'center',\r\n        marginTop: padding.veryBig,\r\n        fontFamily: fontFamily.josefin,\r\n        letterSpacing: '1.5px',\r\n    },\r\n\r\n    footer: {\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        marginTop: padding.verySmall,\r\n        fontSize: fontSize.lessSmall,\r\n        '@media (min-width: 750px)': {  \r\n            fontSize: fontSize.small,\r\n        }\r\n    },\r\n\r\n    copyright: {\r\n        marginTop: padding.veryBig,\r\n        fontSize: fontSize.verySmall,\r\n        marginBottom: padding.small\r\n    },\r\n\r\n    link: {\r\n        backgroundColor: color.fgWhite,\r\n        color: color.bgBlack,\r\n        padding: padding.tiny\r\n    }\r\n}\r\n\r\nclass Popup extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state={\r\n            isVisible: false,\r\n            popupState: PopupState.None,\r\n            popupType: PopupType.About\r\n        };\r\n\r\n        this.content = React.createRef(); \r\n    }\r\n\r\n    render() {\r\n        // Handle overlay styles. \r\n        let overlayStyle; \r\n        if (this.state.isVisible) {\r\n            overlayStyle = [styles.overlay, styles.showOverlay]; \r\n            if (this.state.popupState === PopupState.Open) {\r\n                overlayStyle = [overlayStyle, styles.fadeIn]; \r\n            } else if (this.state.popupState === PopupState.Close) {\r\n                overlayStyle = [overlayStyle, styles.fadeOut]; \r\n            } else {\r\n                // Do nothing. \r\n            }\r\n        } else {\r\n            overlayStyle = [styles.overlay, styles.hideOverlay]; \r\n        }\r\n\r\n        // Handle different types of Popups. \r\n        let content, contentContainerStyle; \r\n        if (this.state.popupType === PopupType.About) {\r\n            content = this.getAboutContent();\r\n        } else if (this.state.popupType === PopupType.Send) {\r\n            content = this.getSendContent(); \r\n        } else {\r\n            content = this.getScoreContent();\r\n        }\r\n\r\n        if (this.state.isVisible) {\r\n            contentContainerStyle = [styles.contentContainer, styles.showContent]; \r\n            if (this.state.popupState === PopupState.Open) {\r\n                contentContainerStyle = [contentContainerStyle, styles.fadeInDown]; \r\n            } else if (this.state.popupState === PopupState.Close) {\r\n                contentContainerStyle = [contentContainerStyle, styles.fadeOutUp];\r\n            } else {\r\n                // Do nothing when it's in None state. \r\n            }\r\n        } else {\r\n            contentContainerStyle = [styles.contentContainer, styles.hideContent]; \r\n        }\r\n\r\n        return (\r\n            <div onClick={this.handleOnTouch.bind(this)} onTouchStart={this.handleOnTouch.bind(this)} >\r\n                <div style={overlayStyle}></div>\r\n                <div onAnimationEnd={this.contentAnimationEnd.bind(this)} style={contentContainerStyle}>\r\n                    {content}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    contentAnimationEnd() {\r\n        if (this.state.isVisible) {\r\n            // Hide everything when content animation ends. \r\n            if (this.state.popupState === PopupState.Close) {\r\n                this.setState({\r\n                    isVisible: false,\r\n                    popupState: PopupState.None\r\n                }); \r\n            }\r\n        }\r\n    }\r\n\r\n    getIconButton() {\r\n        return(\r\n            <div onClick={this.hidePopup.bind(this)} style={styles.iconContainer}>\r\n                <Exit style={styles.icon} />\r\n            </div>\r\n        ); \r\n    }\r\n\r\n    getSendContent() { \r\n        let bodyStyle = [styles.body, styles.mediaQueryOnText];\r\n        let iconButton = this.getIconButton();  \r\n        return (\r\n            <div ref={this.content} style={styles.content}>\r\n                <div style={styles.stretchContainer}>\r\n                    { iconButton }\r\n                    <div style={bodyStyle}>\r\n                        <div style={styles.sendTitle}>SEND</div>\r\n                        <div style={styles.subtitle}>supersynthesis</div>       \r\n                        <div style={styles.buttonContainer}>\r\n                            <div onClick={this.onYesHandle.bind(this)} style={styles.button}>yes</div>\r\n                            <div onClick={this.onNoHandle.bind(this)} style={styles.button}>no</div>    \r\n                        </div>         \r\n                    </div>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    getScoreContent() { \r\n        let bodyStyle = [styles.body, styles.mediaQueryOnText];\r\n        let iconButton = this.getIconButton();  \r\n        return (\r\n            <div ref={this.content} style={styles.content}>\r\n                <div style={styles.stretchContainer}>\r\n                    { iconButton }\r\n                    <div style={bodyStyle}>\r\n                        <div style={styles.sendTitle}>SCORE</div>\r\n                        <div style={bodyStyle}>\r\n                            <div style={styles.subtitle}>supersynthesis</div>\r\n                            <div style={styles.subtitle}>{'Touch To Create A Score'}<br />{'Hit SEND'}</div>                               \r\n                        </div>\r\n                        <div style={styles.buttonContainer}>\r\n                            <div onClick={this.onNoHandle.bind(this)} style={styles.button}>ok</div>\r\n                        </div>         \r\n                    </div>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    getAboutContent() {\r\n        let footer = this.getFooter(); \r\n        let iconButton = this.getIconButton();  \r\n        let bodyStyle = [styles.body, styles.mediaQueryOnText];\r\n        return (\r\n            <div ref={this.content} style={styles.content}>\r\n                <div style={styles.stretchContainer}>\r\n                    { iconButton }\r\n                    <div style={bodyStyle}>\r\n                        <div style={styles.title}>supersynthesis</div>\r\n                        <div style={styles.description}>{aboutTheWork}</div>                        \r\n                    </div>\r\n                    { footer }\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    getFooter() {\r\n        const tim = 'https://timkwasny96.wixsite.com/site';\r\n        const amay = 'https://amaykataria.com';\r\n        return (\r\n            <div style={styles.footerContainer}>\r\n                <div style={styles.footer}>\r\n                    <span>Created by&nbsp;</span>\r\n                    <a \r\n                        style={styles.link} \r\n                        target='_blank' \r\n                        rel=\"noopener noreferrer\" \r\n                        href={amay}>\r\n                        Amay Kataria\r\n                    </a>\r\n                </div>\r\n                <div style={styles.footer}>\r\n                    <span>Sound by&nbsp;</span>\r\n                    <a \r\n                        style={styles.link} \r\n                        target='_blank' \r\n                        rel=\"noopener noreferrer\" \r\n                        href={tim}>\r\n                        Timothy Kwasny\r\n                    </a>\r\n                </div>\r\n                <div style={styles.copyright}> Amay Kataria 2022</div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    onYesHandle(event) {\r\n        event.stopPropagation();\r\n        TimerStore.cancelReset();\r\n        EditModeStore.setEditMode(false);\r\n        EditModeStore.setUserInteracting(false);\r\n        this.hidePopup(event);\r\n        // Send the data. \r\n        Websocket.commitLightConfigData();\r\n    }\r\n\r\n    onNoHandle(event) {\r\n        event.stopPropagation();\r\n        EditModeStore.setUserInteracting(false);\r\n        this.hidePopup(event);\r\n    }\r\n\r\n    showPopup(popupType) {\r\n        console.log('Create a popup: ' + popupType);\r\n\r\n        // Adjust the scroll top.\r\n        this.content.current.scrollTop = 0; \r\n        this.setState({\r\n            isVisible: true,\r\n            popupState: PopupState.Open,\r\n            popupType: popupType\r\n        }); \r\n\r\n        // Force the user interaction to be false because we get stuck sometime in it. \r\n        EditModeStore.setIsPopupActive(true);\r\n        EditModeStore.setUserInteracting(false);\r\n    }\r\n\r\n    hidePopup(event) {\r\n        EditModeStore.setIsPopupActive(false);\r\n        if (event) {\r\n            event.stopPropagation(); \r\n        }\r\n        this.setState({\r\n            popupState: PopupState.Close\r\n        });\r\n    }\r\n\r\n    handleOnTouch(event) {\r\n        // Don't let this propogate to the main screen\r\n        // where touch events mean something. \r\n        event.stopPropagation();\r\n    }\r\n }\r\n\r\nexport default Radium(Popup);\r\n\r\n","/*\r\n  Name: BottomBar.js\r\n  Author: Amay Kataria\r\n  Date: 02/19/2022\r\n  Description: React component for the top navigation bar on the webpage.\r\n*/\r\nimport React from 'react'\r\nimport Radium from 'radium'\r\nimport { PopupType } from './Popup'\r\nimport Popup from './Popup'\r\nimport { ORIENTATION } from './App'\r\nimport { ReactComponent as About } from '../svg/about.svg'\r\nimport {color, fontFamily, fontSize, padding} from './CommonStyles'\r\nimport EditModeStore from '../stores/EditModeStore'\r\nimport TimerStore from '../stores/TimerStore'\r\n\r\nconst animation = {\r\n  rotate: Radium.keyframes({\r\n    '0%': {\r\n      transform: 'rotate(0deg)'\r\n    },\r\n    '50%': {\r\n      transform: 'rotate(180deg)',\r\n    },\r\n    '100%': {\r\n      transform: 'rotate(360deg)',\r\n    }\r\n  }),\r\n}\r\n\r\nconst styles = {\r\n    container: {\r\n        position: 'relative',\r\n        display: 'flex',\r\n        flexDirection: 'row',\r\n        justifyContent: 'space-between',\r\n        alignItems: 'center',\r\n        outline: 'none',\r\n        paddingLeft: padding.small,\r\n        paddingRight: padding.small,\r\n        zIndex: '1'\r\n    },\r\n\r\n    title: {\r\n        backgroundColor: color.bgBlack,\r\n        color: color.fbWhite,\r\n        padding: padding.small,\r\n        fontFamily: fontFamily.heatwave,\r\n        fontSize: fontSize.lessBig,\r\n        letterSpacing: '2px'\r\n    },\r\n    \r\n    iconContainer: {\r\n      display: 'flex',\r\n      justifyContent: 'center',\r\n      width: fontSize.huge,\r\n      height: fontSize.huge,\r\n      marginTop: padding.kindaSmall,\r\n    },\r\n\r\n    simpleRotation: {\r\n      animation: 'x 30s ease-in-out infinite',\r\n      animationName: animation.rotate\r\n    },\r\n  \r\n    icon: {\r\n        width: '100%',\r\n        height: '100%'\r\n    }\r\n};\r\n\r\nclass Navbar extends React.Component {\r\n  constructor(props) {\r\n    super(props); \r\n    this.state={}\r\n    this.popupRef = React.createRef(); \r\n  }\r\n\r\n  componentDidMount() {\r\n    TimerStore.subscribePopup(this.onShowPopup.bind(this)); \r\n    TimerStore.subscribeReset(this.onReset.bind(this));\r\n  }\r\n\r\n  onShowPopup(popupType) \r\n  {\r\n    // Send popup type. \r\n    this.popupRef.current.showPopup(popupType);\r\n    console.log('Show Poppup');\r\n  }\r\n\r\n  onReset() {\r\n    EditModeStore.setEditMode(false);\r\n    EditModeStore.setUserInteracting(false);\r\n    let curPopupType = this.popupRef.current.state.popupType; \r\n    if (curPopupType === PopupType.Send) {\r\n      this.popupRef.current.hidePopup();\r\n    } else {\r\n      // Don't close the popup.\r\n    }\r\n  }\r\n\r\n  render() {\r\n    let aboutStyle = [styles.iconContainer, styles.simpleRotation];\r\n    let heightStyle = this.getHeightStyle(); \r\n    return (\r\n      <div style={styles.block}>\r\n        <Popup ref={this.popupRef}/>\r\n        <div style={[styles.container, heightStyle]}>\r\n          <div style={styles.title}>supersynthesis5</div>\r\n          <div style={aboutStyle} onClick={this.handleAbout.bind(this)}>\r\n            <About style={styles.icon} />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  getHeightStyle() {\r\n    let height = this.getHeight();\r\n    let heightStyle = {\r\n      height: height + 'px'\r\n    };\r\n    return heightStyle; \r\n  }\r\n\r\n  getHeight() {\r\n    let deviceHeight = window.innerHeight;\r\n    let deviceWidth = window.innerWidth; \r\n    let c = 0; \r\n    if (this.props.orientation === ORIENTATION.PORTRAIT) {\r\n      if (deviceHeight < 900) {\r\n        c = 0.1\r\n      }\r\n\r\n      if (deviceHeight > 900 && deviceHeight < 1000) {\r\n        c = 0.075\r\n      }\r\n\r\n      if (deviceHeight > 1000) {\r\n        c = 0.06\r\n      }\r\n    }\r\n\r\n    if (this.props.orientation === ORIENTATION.LANDSCAPE) {\r\n      if (deviceWidth < 1000) {\r\n        c = 0.15; \r\n      }      \r\n\r\n      if (deviceWidth > 1000) {\r\n        c = 0.09\r\n      }\r\n    }\r\n\r\n    return deviceHeight * c; \r\n  }\r\n\r\n  handleAbout() {\r\n    this.popupRef.current.showPopup(PopupType.About);\r\n  }\r\n}\r\n\r\nexport default Radium(Navbar);\r\n","// Name: TouchStore.js\r\n// Author: Amay Kataria. \r\n// Date: 05/2/2023\r\n// Description: A simple data store that registers an array of all touch events that are\r\n// registered in the application. This is exclusively useful to implement the synth mode. \r\n\r\nclass TouchStore {\r\n    constructor() {\r\n        this.touches = []; \r\n    }\r\n\r\n    setTouches(newTouches) {\r\n        this.touches = newTouches; \r\n    }\r\n\r\n    getTouches() {\r\n        return this.touches;\r\n    }\r\n}\r\n\r\nexport default new TouchStore();","/*\r\n  Name: Light.js\r\n  Author: Amay Kataria\r\n  Date: 02/19/2022\r\n  Description: A class representing each light that is painted on the canvas. \r\n*/\r\nimport LightConfigStore, { LIGHT_STATE, GROW_STATE } from \"../stores/LightConfigStore\";\r\nimport SequencerStore from '../stores/SequencerStore';\r\nimport EditModeStore from \"../stores/EditModeStore\";\r\nimport TouchStore from '../stores/TouchStore'\r\nimport ModeStore, { MODE } from \"../stores/ModeStore\";\r\nimport SynthStore from \"../stores/SynthStore\";\r\n\r\nexport default class Light {\r\n    constructor(s, i, xPos, yPos, lightWidth) {\r\n        // Sketch object. \r\n        this.p5 = s; \r\n\r\n        // Light's width. \r\n        this.lightWidth = lightWidth;\r\n\r\n        this.growFactor = this.p5.random(1.5, 2.5);\r\n\r\n        // Origin point at the bottom of the canvas. \r\n        this.pos = this.p5.createVector(xPos, yPos);\r\n        \r\n        // Point at the top. \r\n        let newX = this.getNewPos() + this.lightWidth/2; // Keep this at the center of the light.\r\n        this.topPos = this.p5.createVector(newX, 0); // By default at the top. (Always changing)\r\n        this.top = this.p5.createVector(newX, 0); \r\n        \r\n        // Colors. \r\n        this.lightActiveColor = this.p5.color('white');\r\n        this.lightInactiveColor = this.p5.color(255, 255, 255, 125);\r\n        this.lightBgColor = this.p5.color(255, 255, 255, 30);\r\n        this.lightPointColor = this.p5.color('green'); // Only debug.\r\n\r\n        // Store the current light config. \r\n        this.curIdx = i; \r\n        this.updateHeight(); \r\n\r\n        // Variable for the timer's interval id. \r\n        this.growIntervalId = ''; \r\n        setInterval(this.randomizeGrowState.bind(this), 500); \r\n    }\r\n\r\n    draw(meshEllipsePos, boundaryWidth) {\r\n        const currentMode = ModeStore.getCurrentMode();\r\n        let newX = this.getNewPos();\r\n        this.p5.noStroke();  \r\n        this.p5.fill(this.lightInactiveColor);\r\n        \r\n        // All the light business for synth.\r\n        if (currentMode === MODE.SYNTH) {    \r\n            const noteActive = this.analyseTouch(newX);\r\n            if (noteActive) {\r\n                SynthStore.setLocalNote(this.curIdx, 1); \r\n            } else {\r\n                SynthStore.setLocalNote(this.curIdx, 0); \r\n            }\r\n\r\n            // Get the colors based on socket data\r\n            const socketStateAtIndex = SynthStore.getSocketStateAtIndex(this.curIdx);\r\n            if (socketStateAtIndex) {\r\n                const val = socketStateAtIndex['val'];\r\n                if (val) {\r\n                    this.p5.fill(this.lightActiveColor);\r\n                } else {\r\n                    this.p5.fill(this.lightInactiveColor);\r\n                }\r\n            }\r\n              \r\n            this.p5.rect(newX, this.pos['y'], this.lightWidth, -this.p5.height); \r\n        }\r\n\r\n        if (currentMode === MODE.SCORE || currentMode === MODE.DREAM || currentMode === MODE.SWEEP) {\r\n            // Draw the background lights.\r\n            this.p5.fill(this.lightBgColor);        \r\n            this.p5.rect(newX, this.pos['y'], this.lightWidth, -this.p5.height);  \r\n\r\n            let isEditMode = EditModeStore.isEditMode; \r\n            // This is great logic for scoring and other things. Right now I need to figure \r\n            // out the logic for the keyboard.\r\n            // NOTE: Commenting this out briefly.\r\n            if (isEditMode) {\r\n                this.updateLight(meshEllipsePos, boundaryWidth);            \r\n                // Draw the actual light. \r\n                let height = this.getHeight();\r\n                this.p5.fill(this.lightActiveColor);\r\n                this.p5.rect(newX, this.pos['y'], this.lightWidth, -height);  \r\n            } else {\r\n                // Draw the actual lights from the DB config that are lighting. \r\n                if (this.isOnFromDb()  || ModeStore.getCurrentMode() === MODE.SWEEP) {\r\n                    this.p5.fill(this.lightInactiveColor);\r\n                    this.p5.rect(newX, this.pos['y'], this.lightWidth, -this.p5.height);\r\n                }\r\n\r\n                // Draw the lights from the db config that should be on. \r\n                if (this.canDraw()) {\r\n                    // Draw full light.\r\n                    this.p5.fill(this.lightActiveColor);\r\n                    this.p5.rect(newX, this.pos['y'], this.lightWidth, -this.p5.height);  \r\n                }\r\n            }\r\n        }\r\n        //this.drawLightPoint();\r\n    }\r\n\r\n    // Test if the current touch is activating the a light.\r\n    analyseTouch(newX) {\r\n        const touches = TouchStore.getTouches();\r\n        if (touches.length > 0) {\r\n            for(let i = 0; i < touches.length; i++) {\r\n                if (touches[i].x > newX && touches[i].x < (newX + this.lightWidth)) {\r\n                    return true;\r\n                }\r\n            }\r\n        } else {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    updateLight(meshEllipsePos, boundaryWidth) {\r\n        let isUserInteracting = EditModeStore.isUserInteracting;\r\n        if (isUserInteracting) {\r\n            let dBottomPos = meshEllipsePos.dist(this.pos);\r\n            let dTopPos = meshEllipsePos.dist(this.top);\r\n            if (dBottomPos < boundaryWidth/2 || dTopPos < boundaryWidth/2) {\r\n                // This light is activated, grow or shrink. \r\n                this.updateGrowState();\r\n            }\r\n        }\r\n\r\n        this.handleGrowState();\r\n    }\r\n\r\n    \r\n    updateGrowState() {\r\n        let curLightState = LightConfigStore.getActiveLightState(this.curIdx);\r\n        let curGrowState = LightConfigStore.getGrowState(this.curIdx); \r\n\r\n        // Is the light on? \r\n        if (curLightState === LIGHT_STATE.ON) {\r\n            // Is this light currently growing or shrinking? \r\n            if (curGrowState['active']) {\r\n                // I'm doing something - let's not do anything. \r\n            } else {\r\n                // Is the state set to shrink? Because it can only shrink. \r\n                if (curGrowState['state'] === GROW_STATE.SHRINK) {\r\n                    LightConfigStore.setGrowState(this.curIdx, GROW_STATE.SHRINK, true);\r\n                    // This light will not be turned on anymore.  \r\n                    LightConfigStore.setActiveLightState(this.curIdx, LIGHT_STATE.OFF);                \r\n                } else {\r\n                    // Pass, we can't grow a light that's already on. \r\n                }\r\n            }\r\n        }\r\n\r\n        if (curLightState === LIGHT_STATE.OFF) {\r\n            if (curGrowState['active']) {\r\n                // I'm doing something - let's not do anything. \r\n            } else {\r\n                if (curGrowState['state'] === GROW_STATE.GROW) {\r\n                    LightConfigStore.setGrowState(this.curIdx, GROW_STATE.GROW, true);\r\n                    // This light will not be turned on anymore.  \r\n                    LightConfigStore.setActiveLightState(this.curIdx, LIGHT_STATE.ON);\r\n                } else {\r\n                    // Pass, we can't shrink a light that's already off. \r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    // Grow & Shrink the height of the light.\r\n    handleGrowState() {\r\n        let curGrowthActive = this.getGrowState()['active'];\r\n        let curGrowState = this.getGrowState()['state'];\r\n        let curHeight = this.getHeight();\r\n\r\n        // Is the current light's grow active? \r\n        if (curGrowthActive) {\r\n            switch (curGrowState) {\r\n                case GROW_STATE.NONE: {\r\n                    // Pass don't do antyhing. \r\n                    break;\r\n                }\r\n    \r\n                case GROW_STATE.GROW: {\r\n                    if (curHeight < this.p5.height) {\r\n                        curHeight += this.growFactor;\r\n                        LightConfigStore.setHeightState(this.curIdx, curHeight);\r\n                        this.mapPos(curHeight);\r\n                    } else {\r\n                        // Deactivate the current light. \r\n                        LightConfigStore.setGrowState(this.curIdx, GROW_STATE.NONE, false);\r\n                    }\r\n                    break;\r\n                }\r\n    \r\n                case GROW_STATE.SHRINK: {\r\n                    if (curHeight > 0) {\r\n                        curHeight -= this.growFactor; \r\n                        LightConfigStore.setHeightState(this.curIdx, curHeight);\r\n                        this.mapPos(curHeight);\r\n                    } else {\r\n                        // Deactivate the current light. \r\n                        LightConfigStore.setGrowState(this.curIdx,  GROW_STATE.NONE, false);\r\n                    }\r\n                    break;\r\n                }\r\n    \r\n                default: \r\n                    break;\r\n            }\r\n        }\r\n    }\r\n    \r\n    // Set light heights based on the light configurations.\r\n    // Call this functions when new configs are received. \r\n    updateHeight() {\r\n        let lightState = LightConfigStore.getActiveLightState(this.curIdx);         \r\n        let onHeight = this.p5.height;\r\n        let offHeight = 0;\r\n\r\n        if (lightState === LIGHT_STATE.ON) {\r\n            LightConfigStore.setHeightState(this.curIdx, onHeight);\r\n        }\r\n\r\n        if (lightState === LIGHT_STATE.OFF) {\r\n            LightConfigStore.setHeightState(this.curIdx, offHeight);\r\n        }\r\n    }\r\n\r\n    mapPos( height) {\r\n        this.topPos['y'] = this.p5.map(height, 0, this.p5.height, this.p5.height, 0);\r\n    }\r\n\r\n    drawLightPoint() {\r\n        let newX = this.getNewPos();\r\n        this.p5.fill(this.lightPointColor)\r\n        this.p5.circle(newX, this.pos['y'], 5);\r\n    }\r\n    \r\n    getNewPos() {\r\n        return this.pos['x'] + this.lightWidth/2; \r\n    }\r\n\r\n    getGrowState() {\r\n        return LightConfigStore.getGrowState(this.curIdx);\r\n    }\r\n\r\n    getHeight() {\r\n        let heightState = LightConfigStore.getHeightState(this.curIdx);\r\n        return heightState;\r\n    }\r\n\r\n    canDraw() {\r\n        let drawState = SequencerStore.getLightState(this.curIdx);\r\n        return drawState; // It's true or false. \r\n    }\r\n\r\n    isOn() {\r\n        let lightState = LightConfigStore.getActiveLightState(this.curIdx);\r\n        return lightState; \r\n    }\r\n\r\n    isOnFromDb() {\r\n        let lightState = LightConfigStore.getDbLightState(this.curIdx);\r\n        return lightState; \r\n    }\r\n\r\n    isGrowing() {\r\n        let v = LightConfigStore.getGrowState(this.curIdx)['active'];\r\n        return v;\r\n    }\r\n\r\n    updateDrawState(state) {\r\n        LightConfigStore.setDrawState(this.curIdx, state); \r\n    }\r\n\r\n    randomizeGrowState() {\r\n        let calcGrowState = () => {\r\n            let curGrowState = this.getGrowState(); \r\n            if (curGrowState['active']) {                \r\n                // I'm currently growing or doing something. \r\n                // Pass\r\n            } else {\r\n                // Update my state. \r\n                let r = this.p5.int(this.p5.random(0, 2)); \r\n                r = r === 1 ? GROW_STATE.GROW : GROW_STATE.SHRINK;\r\n                LightConfigStore.setGrowState(this.curIdx, r, false);\r\n            }\r\n        }\r\n\r\n        // Set new grow states for top and bottom light for the current light. \r\n        calcGrowState();        \r\n    }\r\n}\r\n\r\n//    // Work on creating a clean socket config that we can work with.\r\n//    if (SynthStore.canModify(this.curIdx)) {\r\n//     const newNoteVal = this.analyseTouch(newX);\r\n//     // Has note turned on?\r\n//     if (newNoteVal) {\r\n//         SynthStore.setLocalNote(this.curIdx, 1);\r\n//         // this.p5.fill(this.lightActiveColor);\r\n\r\n//     } else {\r\n//         // new note is off. \r\n//         const oldLocalNoteVal = SynthStore.getLocalNote(this.curIdx);\r\n//         if (oldLocalNoteVal) {\r\n//             SynthStore.setLocalNote(this.curIdx, 0);\r\n//             // this.p5.fill(this.lightActiveColor);\r\n//         }\r\n//     }\r\n// } else {\r\n//    // I can't modify these notes because somebody else has changed them.\r\n// }\r\n\r\n// // Go through all the socket notes and turn them on. \r\n// const curNoteValue = SynthStore.getSocketNote(this.curIdx);\r\n// if (curNoteValue) {\r\n//     this.p5.fill(this.lightActiveColor);\r\n// } else {\r\n//     this.p5.fill(this.lightInactiveColor);\r\n// }","/*\r\n  Name: Sequencer.js\r\n  Author: Amay Kataria\r\n  Date: 03/03/2022\r\n  Description: A class to render the sequencer object on the screen. \r\n*/\r\nimport EditModeStore from \"../stores/EditModeStore\";\r\nimport SequencerStore from \"../stores/SequencerStore\";\r\n\r\nexport default class SequencerBubble {\r\n    constructor(s) {\r\n        // Sketch object. \r\n        this.p5 = s; \r\n\r\n        this.sequencerActiveColor = this.p5.color(255, 0, 0, 200);\r\n        this.sequencerInactiveColor = this.p5.color(255, 0, 0, 100);\r\n    }\r\n\r\n    draw(light) {\r\n        let indices = SequencerStore.getIndices();\r\n        let isEditMode = EditModeStore.isEditMode;\r\n        for (let i = 0; i < indices.length; i++) {\r\n            let idx = indices[i];     \r\n            if (idx === light.curIdx) {\r\n                if (isEditMode) {\r\n                    this.p5.fill(this.sequencerInactiveColor);                \r\n                } else {\r\n                    this.p5.fill(this.sequencerActiveColor);                \r\n                }\r\n                let newX = light.getNewPos(); \r\n                this.p5.ellipse(newX + light.lightWidth/2, this.p5.height/2, light.lightWidth, light.lightWidth);\r\n            }\r\n        }\r\n    }\r\n}\r\n","/*\r\n  Name: LightManager.js\r\n  Author: Amay Kataria\r\n  Date: 02/19/2022\r\n  Description: A class responsible for handling all the lights. This class is the most critical class\r\n  in this project. \r\n*/\r\nimport Light from './Light'\r\nimport LightConfigStore from \"../stores/LightConfigStore\";\r\nimport SequencerBubble from './SequencerBubble';\r\n\r\nconst NUM_LIGHTS = 24\r\n\r\nexport default class LightManager {\r\n    constructor(s) {\r\n        this.p5 = s; \r\n        this.lights = [];\r\n        this.showResetAnimation = false; \r\n        this.curTime = 0; \r\n        this.var = 0; \r\n        this.dir = true; \r\n\r\n        this.sequencerBubble = new SequencerBubble(s);\r\n    }\r\n    \r\n    setup() {\r\n        // Prepare the light collection.\r\n        this.prepareLights();\r\n    }\r\n\r\n    prepareLights() {\r\n        this.lights = []; \r\n\r\n        // Set max height again since the canvas has been resized. \r\n        LightConfigStore.setMaxHeight(this.p5.height);\r\n        \r\n        // Distance between each tube. \r\n        let lightIncrement = (this.p5.width) / NUM_LIGHTS;\r\n\r\n        // Width of each light is half the distance between each light.\r\n        let lightWidth = lightIncrement / 2;\r\n        for (let i = 0; i < NUM_LIGHTS; i++) {\r\n            let xPos = i * lightIncrement; \r\n            // Create a new light instance. \r\n            let l = new Light(this.p5, i, xPos, this.p5.height, lightWidth);\r\n            this.lights.push(l);\r\n        }\r\n    }\r\n    \r\n    draw(meshEllipsePos, boundaryWidth) {\r\n        // Draw the lights based on the state. \r\n        for (let i = 0; i < this.lights.length; i++) {\r\n            let light = this.lights[i]; \r\n            light.draw(meshEllipsePos, boundaryWidth);\r\n            this.sequencerBubble.draw(light);\r\n        }\r\n\r\n        // If I'm in Synth mode\r\n        \r\n    }\r\n}","/*\r\n  Name: MeshManager.js\r\n  Author: Amay Kataria\r\n  Date: 02/19/2022\r\n  Description: A class responsible for drawing the connections from the ellipse to all\r\n  the moving lights on the canvas. \r\n*/\r\nimport EditModeStore from \"../stores/EditModeStore\";\r\n\r\n// Handles all the code related to interaction with the canvas.\r\nconst EASING = 0.08;  \r\nconst ELLIPSE_RADIUS = 50; \r\nexport default class MeshManager {\r\n    constructor(s) {\r\n        this.p5 = s; \r\n        this.ellipsePos = this.p5.createVector(this.p5.width/3, this.p5.height/2);\r\n        this.boundaryWidth = this.p5.width/1.5;\r\n        this.prevMouseX = 0;\r\n        this.prevMouseY = 0; \r\n    }\r\n\r\n    draw(lights) {\r\n        let isEditMode = EditModeStore.isEditMode; \r\n        let isUserInteracting = EditModeStore.isUserInteracting;\r\n        let isPopupActive = EditModeStore.isPopupActive;        \r\n        if (isEditMode && isUserInteracting) {\r\n            let mouseX, mouseY;\r\n            // Don't trap mouseX or mouseY if I'm in the popup. \r\n            if (isPopupActive || this.p5.mouseY > this.p5.height || this.p5.mouseY < 0) {\r\n                mouseX = this.prevMouseX;\r\n                mouseY = this.prevMouseY; \r\n            } else {\r\n                mouseX = this.p5.mouseX;\r\n                mouseY = this.p5.mouseY;\r\n            }\r\n\r\n            // When scoring keep this easing functionality for aesthetics.\r\n            this.ellipsePos['x'] += (mouseX - this.ellipsePos['x']) * EASING;\r\n            this.ellipsePos['y'] += (mouseY - this.ellipsePos['y']) * EASING; \r\n\r\n            // Make sure the ellipse doesn't go outside the boundary.\r\n            this.containEllipse();\r\n\r\n            // Draw pull lines for top and bottom lights.\r\n            for (let i = 0; i < lights.length; i++) {\r\n                let light = lights[i];\r\n\r\n                let pos = light.topPos;\r\n                let height = light.getHeight();\r\n                if (height < this.p5.height && height > 0) {\r\n                    this.drawLine(pos, this.ellipsePos, i);\r\n                }\r\n            }\r\n\r\n            // Draw ellipse tracking the mouse. \r\n            this.drawEllipse();\r\n\r\n            this.prevMouseX = mouseX;\r\n            this.prevMouseY = mouseY;\r\n        }        \r\n    }\r\n    \r\n    // Calculate new ellipse position. \r\n    containEllipse() {\r\n        if (this.ellipsePos['x'] > this.p5.width) {\r\n            this.ellipsePos['x'] = this.p5.width;\r\n        } \r\n\r\n        if (this.ellipsePos['x'] < 0) {\r\n            this.ellipsePos['x'] = 0;\r\n        } \r\n\r\n        if (this.ellipsePos['y'] > this.p5.height) {\r\n            this.ellipsePos['y'] = this.p5.height;\r\n        } \r\n\r\n        if (this.ellipsePos['y'] < 0) {\r\n            this.ellipsePos['y'] = 0;\r\n        } \r\n    }\r\n\r\n    drawEllipse() {\r\n        // let isUserInteracting = EditModeStore.isUserInteracting; \r\n        // if (isUserInteracting) {\r\n        // this.p5.fill(this.p5.color(255, 255, 255, 50));\r\n        //     this.p5.noStroke();\r\n        //     this.p5.ellipse(this.ellipsePos['x'], this.ellipsePos['y'], this.boundaryWidth);  \r\n        // }\r\n        // // Outer ellipse boundary \r\n\r\n\r\n        // Inner ellipse\r\n        this.p5.fill(this.p5.color(255, 255, 255, 150));\r\n        this.p5.strokeWeight(3);\r\n        this.p5.stroke(this.p5.color('black'));\r\n        this.p5.ellipse(this.ellipsePos['x'], this.ellipsePos['y'], ELLIPSE_RADIUS);  \r\n    }\r\n\r\n    drawLine(startPoint, endPoint, i) {\r\n        let opacity = this.p5.map(i, 0, 24, 100, 200);\r\n        let weight = this.p5.map(i, 0, 25, 2, 4);\r\n        this.p5.stroke(this.p5.color(255, 255, 255, opacity));\r\n        this.p5.strokeWeight(weight);\r\n        this.p5.line(startPoint['x'], startPoint['y'], endPoint['x'], endPoint['y']);\r\n    }\r\n}","/*\r\n  Name: TouchEllipseManager.js\r\n  Author: Amay Kataria\r\n  Date: 05/02/2022\r\n  Description: Class responsible to highlight all touches in the synth mode. Synth mode is important\r\n  and is one of the new additions to the app.\r\n*/\r\n\r\n// Handles all the code related to interaction with the canvas.\r\nimport TouchStore from \"../stores/TouchStore\";\r\nimport ModeStore, {MODE} from \"../stores/ModeStore\";\r\n\r\nconst ELLIPSE_RADIUS = 35; \r\n\r\nexport default class TouchEllipseManager {\r\n    constructor(s) {\r\n        this.p5 = s; \r\n    }\r\n\r\n    draw() {\r\n        if (ModeStore.getCurrentMode() === MODE.SYNTH) {\r\n            const touches = TouchStore.getTouches();\r\n            touches.forEach(t => {\r\n                this.drawEllipse(t.x, t.y);\r\n            });\r\n        }\r\n    }\r\n\r\n    drawEllipse(posX, posY) {\r\n        // Inner ellipse\r\n        this.p5.fill(this.p5.color(255, 255, 255, 150));\r\n        this.p5.strokeWeight(3);\r\n        this.p5.stroke(this.p5.color('black'));\r\n        this.p5.ellipse(posX, posY, ELLIPSE_RADIUS);  \r\n    }\r\n}","/*\r\n  Name: bpmManager.js\r\n  Author: Amay Kataria\r\n  Date: 02/20/2022\r\n  Description: A class responsible for handling the logic to calculate the bpm for the current configuration.\r\n*/\r\n\r\nimport BpmStore from '../stores/BpmStore'\r\nimport EditModeStore from \"../stores/EditModeStore\";\r\n\r\nconst MAX_BPM = 200;\r\nconst MIN_BPM = 100;\r\nexport default class bpmManager {\r\n    constructor(s) {\r\n        this.p5 = s;\r\n        this.curBpm = BpmStore.getLocalBpm();\r\n        BpmStore.subscribe(() => {\r\n            this.curBpm = BpmStore.getLocalBpm();\r\n        }); \r\n        this.curTime = ''; \r\n    }\r\n\r\n    // Simple BPM calculator.\r\n    update(ellipsePos, lights) {\r\n        let isEditMode = EditModeStore.isEditMode; \r\n        let isUserInteracting = EditModeStore.isUserInteracting;\r\n        // The user must be in Edit Mode and be interacting for the\r\n        // local bpm to be changing. \r\n        if (isUserInteracting && isEditMode) { \r\n            let shouldAdd = false; \r\n            if (((ellipsePos['x'] > this.p5.width/2) && (ellipsePos['y'] < this.p5.height/2))\r\n                || ((ellipsePos['x'] < this.p5.width/2) && (ellipsePos['y'] > this.p5.height/2))){\r\n                shouldAdd = true; \r\n            } else {\r\n                shouldAdd = false; \r\n            }\r\n            \r\n            // Number of lights that are on. \r\n            let sum = 0; \r\n            for (let i = 0; i < lights.length; i++) {\r\n                let light = lights[i];\r\n                if (light.isOn()) {\r\n                    sum += 1; \r\n                }\r\n            }\r\n\r\n            // Time that has elapsed. \r\n            let elapsedTime = Date.now() - this.curTime; \r\n            let v = this.p5.sin((elapsedTime + 0.1) / (sum + 1)); \r\n            let mapped =  this.p5.map(v, -1, 1, 0, 0.1);\r\n            \r\n            // Calculate the new bpm. \r\n            if (shouldAdd) {\r\n                this.curBpm = this.curBpm + mapped * 3.0;\r\n            }\r\n\r\n            if (!shouldAdd) {\r\n                this.curBpm = this.curBpm - mapped * 0.01;\r\n            }\r\n            \r\n            if (this.curBpm < MIN_BPM) {\r\n                this.curBpm = MIN_BPM; \r\n            } \r\n\r\n            if (this.curBpm > MAX_BPM) {\r\n                this.curBpm = MAX_BPM;\r\n            }\r\n\r\n            // Send updates to component subscribed for the event. \r\n            BpmStore.setLocalBpm(Math.floor(this.curBpm));\r\n        } else {\r\n            // Keep snapshotting the time, so we can calculate\r\n            // the elapsed time. \r\n            this.curTime = Date.now(); \r\n        }\r\n    }\r\n}","/*\r\n  Name: WaveCanvas.js\r\n  Author: Amay Kataria\r\n  Date: 02/19/2022\r\n  Description: Class responsible to paint the interactive P5.js canvas.\r\n*/\r\n\r\nimport React from 'react'\r\nimport Radium from 'radium'\r\nimport {color} from './CommonStyles'\r\nimport p5 from 'p5'\r\nimport { ORIENTATION } from './App'\r\nimport EditModeStore from '../stores/EditModeStore'\r\nimport ModeStore, {MODE} from '../stores/ModeStore'\r\nimport TouchStore from '../stores/TouchStore'\r\nimport LightManager from './LightManager'\r\nimport MeshManager from './MeshManager'\r\nimport TouchEllipseManager from './TouchEllipseManager'\r\nimport BpmManager from './BpmManager'\r\nimport TimerStore from '../stores/TimerStore'\r\nimport LightConfigStore from '../stores/LightConfigStore'\r\n\r\nvar sketch = (s) => {\r\n  let lightManager, meshManager, bpmManager, touchEllipseManager; \r\n  let shouldTrigger = false; \r\n  s.setup = () => {\r\n    let canvasContainer = s.select('#canvasContainer');\r\n    let height = canvasContainer.height;\r\n    s.createCanvas(window.innerWidth, height);\r\n\r\n    lightManager = new LightManager(s);\r\n    meshManager = new MeshManager(s);\r\n    bpmManager = new BpmManager(s); \r\n    touchEllipseManager = new TouchEllipseManager(s);\r\n\r\n    lightManager.setup();\r\n  };\r\n\r\n  s.draw = () => {\r\n    s.background(s.color(0, 0, 0));  \r\n    lightManager.draw(meshManager.ellipsePos, meshManager.boundaryWidth);\r\n    meshManager.draw(lightManager.lights); \r\n    bpmManager.update(meshManager.ellipsePos, lightManager.lights);\r\n    touchEllipseManager.draw();\r\n  };\r\n\r\n  s.mousePressed = () => {\r\n    TouchStore.setTouches(s.touches);\r\n    const currentMode = ModeStore.currentMode; \r\n    // For score mode, we do good things. \r\n    if (currentMode === MODE.SCORE) {\r\n      if (s.mouseY > s.height || s.mouseY < 0) {\r\n        // Ignore. \r\n      } else if (!EditModeStore.isPopupActive) {\r\n        console.log('Doing it');\r\n        EditModeStore.setUserInteracting(true); \r\n        EditModeStore.setEditMode(true);\r\n        TimerStore.cancelReset();\r\n        shouldTrigger = true; \r\n      }\r\n    }\r\n  };\r\n\r\n  s.mouseMoved = () => {\r\n    const mouseVal = {x: s.mouseX, y: s.mouseY};\r\n    TouchStore.setTouches([mouseVal]);\r\n  }\r\n\r\n  s.touchMoved = () => {\r\n    TouchStore.setTouches(s.touches);\r\n  }\r\n\r\n  s.touchEnded = () => {\r\n    TouchStore.setTouches(s.touches);\r\n    if (!EditModeStore.isPopupActive) {\r\n      EditModeStore.setUserInteracting(false); \r\n      let hasConfigEdited = LightConfigStore.hasConfigEdited;\r\n      if (shouldTrigger && hasConfigEdited) {\r\n        console.log('Schedule popup')\r\n        TimerStore.startTimer();\r\n        shouldTrigger = false;\r\n      }\r\n    }\r\n  }\r\n\r\n  s.windowResized = () => {\r\n    setTimeout(() => {\r\n      console.log('Canvas Resized.');\r\n      let canvasContainer = s.select('#canvasContainer');\r\n      let height = canvasContainer.height;\r\n      s.resizeCanvas(window.innerWidth, height); \r\n  \r\n      // Prepare the lights again. \r\n      lightManager.prepareLights();\r\n    }, 500);\r\n  }\r\n};\r\n\r\nconst styles = {\r\n  container: {\r\n    position: 'relative',\r\n    backgroundColor: color.bgBlack,\r\n    margin: 0,\r\n    padding: 0,\r\n    outline: 'none',\r\n    zIndex: '1'\r\n  },\r\n\r\n  hide: {\r\n    display: 'none'\r\n  },\r\n\r\n  show: {\r\n    display: 'inline'\r\n  }\r\n};\r\n\r\nclass WaveCanvas extends React.Component {\r\n  constructor(props) {\r\n    super(props);   \r\n    this.containerRef = React.createRef();\r\n    this.sketchRef = React.createRef(); \r\n    this.doesSketchExist = false; \r\n\r\n    this.state = {\r\n      currentMode: ModeStore.getCurrentMode()\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    console.log('Wave canvas mounted');    \r\n    ModeStore.subscribe(this.onModeUpdate.bind(this)); \r\n  }\r\n\r\n  componentDidUpdate() {\r\n      // Don't recreate the sketch.\r\n      if (!this.doesSketchExist) {\r\n        console.log('New Sketch');\r\n        this.myP5 = new p5(sketch, this.sketchRef.current);   \r\n        this.doesSketchExist = true;\r\n      }\r\n  }\r\n  \r\n  render() {     \r\n    let heightStyle = this.getHeightStyle();\r\n    let containerStyle = [styles.container, heightStyle];\r\n    let canvasStyle = [containerStyle, styles.show];\r\n    return (\r\n      <>\r\n          <div id={'canvasContainer'} \r\n            ref={this.sketchRef} \r\n            style={canvasStyle}>\r\n          </div>\r\n          {/* <Synth wrapperStyle={synthStyle} /> */}\r\n      </>\r\n    );\r\n  }\r\n\r\n  onModeUpdate(newMode) {\r\n    this.setState({\r\n      currentMode: newMode\r\n    });\r\n  }\r\n\r\n  getHeightStyle() {\r\n    let height = this.getHeight();\r\n    let heightStyle = {\r\n      height: height + 'px'\r\n    };\r\n    return heightStyle; \r\n  }\r\n\r\n  getHeight() {\r\n    let deviceHeight = window.innerHeight;\r\n    let deviceWidth = window.innerWidth; \r\n    let c = 0; \r\n    if (this.props.orientation === ORIENTATION.PORTRAIT) {\r\n      if (deviceHeight < 900) {\r\n        c = 0.8;\r\n      }\r\n\r\n      if (deviceHeight > 900 && deviceHeight < 1000) {\r\n        c = 0.85;\r\n      }\r\n\r\n      if (deviceHeight > 1000) {\r\n        c = 0.88; \r\n      }\r\n    }\r\n\r\n    if (this.props.orientation === ORIENTATION.LANDSCAPE) {\r\n      if (deviceWidth < 1000) {\r\n        c = 0.70;  \r\n      } \r\n\r\n      if (deviceWidth > 1000) {\r\n        c = 0.82;\r\n      }\r\n    }\r\n\r\n    return deviceHeight * c;\r\n  }\r\n}\r\n\r\nexport default Radium(WaveCanvas);","/*\r\n  Name: BottomBar.js\r\n  Author: Amay Kataria\r\n  Date: 02/19/2022\r\n  Description: React component for the bottom bar on the page. This has the send button. \r\n*/\r\nimport React from 'react'\r\nimport Radium from 'radium'\r\nimport { ORIENTATION } from './App';\r\nimport {color, fontFamily, fontSize, padding} from './CommonStyles'\r\nimport Websocket from './Websocket';\r\nimport EditModeStore from '../stores/EditModeStore';\r\nimport BpmStore from '../stores/BpmStore';\r\nimport ConfigIndexStore from '../stores/ConfigIndexStore';\r\nimport LightConfigStore from '../stores/LightConfigStore';\r\nimport TimerStore from '../stores/TimerStore';\r\nimport ModeStore, {MODE} from '../stores/ModeStore'\r\n\r\nconst styles = {\r\n    container: {\r\n        position: 'relative',\r\n        display: 'flex',\r\n        flexDirection: 'row',\r\n        justifyContent: 'space-between',\r\n        alignItems: 'center',\r\n        paddingLeft: padding.small,\r\n        paddingRight: padding.small,\r\n        // // // Common Styles\r\n        color: color.fbWhite,\r\n        fontFamily: fontFamily.josefin,\r\n        fontSize: fontSize.lessBig,\r\n        letterSpacing: '2px',\r\n        zIndex: '1',\r\n    },\r\n\r\n    info: {\r\n        backgroundColor: color.bgBlack,\r\n        fontFamily: fontFamily.heatwave,\r\n        letterSpacing: '2px',\r\n        padding: padding.verySmall,\r\n        cursor: 'default'\r\n    },\r\n\r\n    button: {\r\n      cursor: 'pointer',\r\n      borderStyle: 'solid',\r\n      borderWidth: '1.8px',\r\n      borderColor: color.fgWhite,\r\n      boxShadow:'0px 1px 1px black' \r\n    },\r\n\r\n    disabled: {\r\n      backgroundColor: color.disabled\r\n    }\r\n};\r\n\r\nclass BottomBar extends React.Component {\r\n  constructor(props) {\r\n    super(props); \r\n    this.state={\r\n      localBpm: '',\r\n      dbBpm: '',\r\n      configIndex: '',\r\n      isEditMode: false,\r\n      isSendEnabled: LightConfigStore.hasConfigEdited,\r\n      currentMode: ModeStore.getCurrentMode()\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    BpmStore.subscribe(this.onBpmUpdated.bind(this));\r\n    ConfigIndexStore.subscribe(this.onConfigIndexUpdated.bind(this));\r\n    EditModeStore.subscribe(this.onEditModeUpdate.bind(this));\r\n    LightConfigStore.subscribeForConfigChange(this.onLightConfigChange.bind(this));\r\n    ModeStore.subscribe(this.onModeUpdate.bind(this));\r\n  }\r\n \r\n  render() {\r\n    let bpm = this.state.isEditMode ? this.state.localBpm : this.state.dbBpm;\r\n    let indices = this.state.configIndex; \r\n    let heightStyle = this.getHeightStyle();\r\n    let elements = this.getElements(heightStyle, indices, bpm);\r\n    return elements; \r\n  }\r\n\r\n  getElements(heightStyle, indices, bpm) {\r\n    let leftItem = this.getLeftItem(indices); \r\n    let sendButton = this.getSendButton();\r\n    let bpmNum = (this.state.currentMode === MODE.SYNTH || this.state.currentMode === MODE.SWEEP) ? '' : bpm;\r\n    return (\r\n      <div style={[styles.container, heightStyle]}>\r\n        { leftItem }\r\n        {<div style={styles.info}>{bpmNum + 'bpm'}</div>}\r\n        { sendButton }\r\n      </div>  \r\n    );\r\n  }\r\n\r\n  getLeftItem(indices) {\r\n    let item = '';\r\n    if (this.state.currentMode === MODE.SYNTH || this.state.currentMode === MODE.SWEEP) {\r\n      item = (<div style={styles.info}>{0}</div>);\r\n    } else {\r\n      item = this.state.isEditMode ? \r\n        <div\r\n          onClick={this.onBack.bind(this)}\r\n          style={[styles.info, styles.button]}\r\n          >BACK\r\n          </div> : \r\n        (<div style={styles.info}>{indices}</div>);\r\n    }\r\n\r\n    return item; \r\n  }\r\n\r\n  getSendButton() {\r\n    let buttonStyle = [styles.info, styles.button];\r\n    buttonStyle = !this.state.isSendEnabled ? [buttonStyle, styles.disabled] : buttonStyle;\r\n    let onClick = !this.state.isSendEnabled ? () => {} : this.onSend.bind(this);\r\n    return (\r\n      <div \r\n        onClick={onClick} \r\n        style={buttonStyle}\r\n      >SEND\r\n      </div>\r\n    );\r\n  }\r\n\r\n  getHeightStyle() {\r\n    let height = this.getHeight();\r\n    let heightStyle = {\r\n      height: height + 'px'\r\n    };\r\n    return heightStyle; \r\n  }\r\n\r\n  getHeight() {\r\n    let deviceHeight = window.innerHeight;\r\n    let deviceWidth = window.innerWidth;\r\n    let c = 0; \r\n    if (this.props.orientation === ORIENTATION.PORTRAIT) {\r\n      if (deviceHeight < 900) {\r\n        c = 0.1\r\n      }\r\n\r\n      if (deviceHeight > 900 && deviceHeight < 1000) {\r\n        c = 0.075\r\n      }\r\n\r\n      if (deviceHeight > 1000) {\r\n        c = 0.06\r\n      }\r\n    }\r\n\r\n    if (this.props.orientation === ORIENTATION.LANDSCAPE) {\r\n      if (deviceWidth < 1000) {\r\n        c = 0.15; \r\n      }\r\n\r\n      if (deviceWidth > 1000) {\r\n        c = 0.065; \r\n      }\r\n    }\r\n\r\n    return deviceHeight * c; \r\n  }\r\n\r\n  onLightConfigChange() {\r\n    let hasConfigChanged = LightConfigStore.hasConfigEdited; \r\n    this.setState({\r\n      isSendEnabled: hasConfigChanged\r\n    });\r\n  }\r\n\r\n  onEditModeUpdate() {\r\n    let isEditMode = EditModeStore.isEditMode; \r\n    // Don't re-render if we are already in the state. \r\n    if (this.state.isEditMode !== isEditMode) {\r\n      this.setState({\r\n        isEditMode: isEditMode        \r\n      });\r\n    }\r\n  }\r\n\r\n  onBpmUpdated() {\r\n    let dbBpm = BpmStore.getDbBpm();\r\n    let localBpm = BpmStore.getLocalBpm();\r\n\r\n    // Update DB bpm.\r\n    if (dbBpm !== this.state.dbBpm) {\r\n      this.setState({\r\n        dbBpm: dbBpm\r\n      });\r\n    }\r\n\r\n    // Update local bpm. \r\n    if (localBpm !== this.state.localBpm) {\r\n      this.setState({\r\n        localBpm: localBpm\r\n      });\r\n    }\r\n  }\r\n\r\n  onConfigIndexUpdated() {\r\n    let newConfigIndex = ConfigIndexStore.getConfigIndex();\r\n    if (newConfigIndex !== this.state.configIndex) {\r\n      this.setState({\r\n        configIndex: newConfigIndex\r\n      });\r\n    }\r\n  }\r\n\r\n  onSend(event) {\r\n    event.stopPropagation();\r\n    EditModeStore.setEditMode(false);\r\n    EditModeStore.setUserInteracting(false);\r\n    TimerStore.cancelPopup();\r\n    // Just before committing this. \r\n    Websocket.commitLightConfigData();\r\n  }\r\n\r\n  onBack(event) {\r\n    event.stopPropagation();\r\n    EditModeStore.setEditMode(false);\r\n    EditModeStore.setUserInteracting(false);\r\n    this.setState({\r\n      isEditMode: false\r\n    });\r\n  }\r\n\r\n  onModeUpdate(newMode) {\r\n    this.setState({\r\n      currentMode: newMode\r\n    });\r\n  }\r\n}\r\n\r\nexport default Radium(BottomBar);","/*\r\n  Name: ModesBar.js\r\n  Author: Amay Kataria\r\n  Date: 04/13/2023\r\n  Description: A component to contain the buttons for the modes: Synth, Score, Dream, and Sweep\r\n*/\r\n\r\nimport React from \"react\";\r\nimport Radium from \"radium\";\r\nimport ModeStore, { MODE } from \"../stores/ModeStore\";\r\nimport { ORIENTATION } from './App';\r\nimport {color, fontFamily, fontSize, padding} from './CommonStyles'\r\nimport TimerStore from \"../stores/TimerStore\";\r\nimport { PopupType } from \"./Popup\";\r\n\r\nconst styles = {\r\n    container: {\r\n        position: 'relative',\r\n        backgroundColor: color.bgBlack,\r\n        borderStyle: 'none',\r\n        display: 'flex',\r\n        flexDirection: 'row',\r\n        outline: 'none',\r\n        justifyContent: 'space-between',\r\n        alignItems: 'center',\r\n        paddingLeft: padding.small,\r\n        paddingRight: padding.small,\r\n        // // // Common Styles\r\n        color: color.fbWhite,\r\n        fontFamily: fontFamily.josefin,\r\n        fontSize: fontSize.lessBig,\r\n        letterSpacing: '2px',\r\n        zIndex: '1',\r\n    },\r\n\r\n    buttonStyle: {\r\n        backgroundColor: color.fgWhite,\r\n        color: color.bgBlack,\r\n        borderStyle: 'none',\r\n        fontFamily: fontFamily.heatwave,\r\n        letterSpacing: '2px',\r\n        padding: padding.verySmall,\r\n        cursor: 'default'\r\n    },\r\n\r\n    selectedButton: {\r\n        backgroundColor: color.selected\r\n    }\r\n}\r\n\r\nclass ModesBar extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        ModeStore.subscribe(this.onModeUpdate.bind(this));\r\n        this.state = {\r\n            currentMode: ModeStore.getCurrentMode()\r\n        }\r\n    }\r\n\r\n    render() {\r\n        let heightStyle = this.getHeightStyle();\r\n        let synthButton = this.state.currentMode === MODE.SYNTH ? [styles.buttonStyle, styles.selectedButton] : [styles.buttonStyle];\r\n        let dreamButton = this.state.currentMode === MODE.DREAM ? [styles.buttonStyle, styles.selectedButton] : [styles.buttonStyle];\r\n        let scoreButton = this.state.currentMode === MODE.SCORE ? [styles.buttonStyle, styles.selectedButton] : [styles.buttonStyle];\r\n        let sweepButton = this.state.currentMode === MODE.SWEEP ? [styles.buttonStyle, styles.selectedButton] : [styles.buttonStyle];\r\n        return (\r\n            <div style={[styles.container, heightStyle]}>\r\n                <button onClick={this.handleClick.bind(this, MODE.SYNTH)} style={synthButton}>SYNTH</button>\r\n                <button onClick={this.handleClick.bind(this, MODE.DREAM)} style={dreamButton}>DREAM</button>\r\n                <button onClick={this.handleClick.bind(this, MODE.SCORE)} style={scoreButton}>SCORE</button>\r\n                <button onClick={this.handleClick.bind(this, MODE.SWEEP)} style={sweepButton}>SWEEP</button>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    handleClick(newMode) {\r\n        // Create a small popup for the SCORE.\r\n        if (newMode === MODE.SCORE) {\r\n            TimerStore.showPopup(PopupType.Score);\r\n        }\r\n        ModeStore.setMode(newMode, true);\r\n    }\r\n\r\n    onModeUpdate(newMode) {\r\n        this.setState({\r\n            currentMode: newMode\r\n        });\r\n    }\r\n\r\n    getHeightStyle() {\r\n        let height = this.getHeight();\r\n        let heightStyle = {\r\n          height: height + 'px'\r\n        };\r\n        return heightStyle; \r\n    }\r\n    \r\n    getHeight() {\r\n        let deviceHeight = window.innerHeight;\r\n        let deviceWidth = window.innerWidth;\r\n        let c = 0; \r\n        if (this.props.orientation === ORIENTATION.PORTRAIT) {\r\n            if (deviceHeight < 900) {\r\n            c = 0.1\r\n            }\r\n\r\n            if (deviceHeight > 900 && deviceHeight < 1000) {\r\n            c = 0.075\r\n            }\r\n\r\n            if (deviceHeight > 1000) {\r\n            c = 0.06\r\n            }\r\n        }\r\n\r\n        if (this.props.orientation === ORIENTATION.LANDSCAPE) {\r\n            if (deviceWidth < 1000) {\r\n                c = 0.15; \r\n            }\r\n\r\n            if (deviceWidth > 1000) {\r\n                c = 0.065; \r\n            }\r\n        }\r\n\r\n        return deviceHeight * c; \r\n    }\r\n}\r\n\r\nexport default Radium(ModesBar);","/*\n  Name: App.js\n  Author: Amay Kataria\n  Date: 02/19/2022\n  Description: Entry point component for the application. \n*/\n\nimport React from 'react'\nimport Radium from 'radium'\n\nimport Navbar from './Navbar';\nimport WaveCanvas from './WaveCanvas';\nimport BottomBar from './Bottombar';\nimport ModesBar from './ModesBar';\n\n// Enum to track the device orientation. \nexport const ORIENTATION = {\n  PORTRAIT: 0,\n  LANDSCAPE: 1\n}\n\nconst styles = {\n  container: {\n    position: 'fixed',\n    WebkitOverflowScrolling: 'touch',\n    top: '0%',\n    left: '0%',\n    right: '0%',\n    bottom: '0%',\n    display: 'flex',\n    flexDirection: 'column',\n    color: 'white',\n    height: '100%',\n    width: '100%',\n    zIndex: '1'\n  },\n\n  button: {\n    width: '100px',\n    height: '50px',\n    backgroundColor: 'white',\n    color: 'black'\n  }\n};\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props); \n    window.addEventListener('resize', this.handleResize.bind(this));\n    this.state = {\n      orientation: ORIENTATION.PORTRAIT\n    };     \n  }\n\n  componentDidMount() {\n    this.evaluateOrientation();\n    document.addEventListener('gesturestart', function(e) {\n      e.preventDefault();\n      // special hack to prevent zoom-to-tabs gesture in safari\n      document.body.style.zoom = 0.99;\n    });\n  \n    document.addEventListener('gesturechange', function(e) {\n        e.preventDefault();\n        // special hack to prevent zoom-to-tabs gesture in safari\n        document.body.style.zoom = 0.99;\n    });\n  \n    document.addEventListener('gestureend', function(e) {\n      e.preventDefault();\n      // special hack to prevent zoom-to-tabs gesture in safari\n      document.body.style.zoom = 0.99;\n    });\n  }\n\n  render() {\n    return (\n      <div style={styles.container}>\n        <Navbar orientation={this.state.orientation} />\n        <WaveCanvas orientation={this.state.orientation} />\n        <ModesBar orientation={this.state.orientation} />\n        <BottomBar orientation={this.state.orientation} />\n      </div>\n    );\n  }\n\n  handleResize() {\n    // Resize triggered - evaluate orientation and render\n    // the components again be it. \n    this.evaluateOrientation();\n  }\n\n  evaluateOrientation() {\n    let t = (window.innerHeight < window.innerWidth); \n    if (t) {\n      console.log('App: Landscape');\n      this.setState({\n        orientation: ORIENTATION.LANDSCAPE\n      });\n    } else {\n      console.log('App: Portrait');\n      this.setState({\n          orientation: ORIENTATION.PORTRAIT\n      });\n    }\n  }\n}\n\nexport default Radium(App);","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport './font/stylesheet.css';\nimport App from './components/App';\nimport {StyleRoot} from 'radium'\n\n// Use StyleRoot to enable keyframes and media queries for Javascript type\n// styles with Radium in components. \n// Single render function for the entire application. \nReactDOM.render(<StyleRoot><App /></StyleRoot>, document.getElementById('root'));"],"sourceRoot":""}