{"version":3,"sources":["svg/close.svg","components/CommonStyles.js","svg/about.svg","stores/EditModeStore.js","components/Popup.js","components/Navbar.js","stores/LightConfigStore.js","stores/SequencerStore.js","components/Light.js","components/SequencerBubble.js","components/LightManager.js","components/MeshManager.js","stores/BpmStore.js","components/BpmManager.js","components/WaveCanvas.js","stores/ConfigIndexStore.js","components/Websocket.js","components/Bottombar.js","components/App.js","index.js"],"names":["_defs","_g","color","bgBlack","fgWhite","disabled","fontSize","extraSmall","kindaSmall","verySmall","lessSmall","small","lessBig","big","veryBig","extraBig","huge","veryHuge","extraHuge","massive","veryMassive","extraMassive","enormous","veryEnormous","extraEnormous","insane","veryInsaane","extraInsane","gaia","veryGaia","extraGaia","padding","tiny","enourmous","veryInsane","fontFamily","_excluded","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","_ref","svgRef","title","props","createElement","viewBox","ref","id","className","width","height","x1","y1","x2","y2","ForwardRef","forwardRef","isEditMode","isUserInteracting","isPopupActive","subscribers","listener","push","val","isEditing","forEach","s","PopupState","customFadeIn","Radium","keyframes","from","opacity","to","customFadeOut","styles","overlay","position","top","bottom","left","right","background","zIndex","fadeIn","animationName","animationDuration","animationFillMode","animationTimingFunction","fadeOut","fadeOutUp","fadeOutDown","fadeInDown","fadeInUp","showOverlay","hideOverlay","showContent","hideContent","contentContainer","display","alignItems","justifyContent","content","borderRadius","overflow","maxWidth","maxHeight","stretchContainer","flexDirection","paddingLeft","paddingRight","borderStyle","borderWidth","borderColor","marginTop","marginBottom","textAlign","letterSpacing","lineHeight","body","mediaQueryOnText","iconContainer","alignSelf","marginRight","fill","icon","footerContainer","footer","copyright","link","backgroundColor","Popup","state","isVisible","popupState","React","createRef","overlayStyle","contentContainerStyle","getAboutContent","onClick","handleOnTouch","bind","onTouchStart","style","onAnimationEnd","contentAnimationEnd","setState","hidePopup","getFooter","iconButton","getIconButton","bodyStyle","description","rel","href","current","scrollTop","event","stopPropagation","EditModeStore","setIsPopupActive","Component","transform","d","fillRule","stroke","strokeWidth","animation","rotate","container","fbWhite","simpleRotation","Navbar","popupRef","aboutStyle","heightStyle","getHeightStyle","block","handleAbout","getHeight","deviceHeight","window","innerHeight","deviceWidth","innerWidth","c","orientation","ORIENTATION","PORTRAIT","LANDSCAPE","console","log","showPopup","LIGHT_STATE","GROW_STATE","dbLightConfig","growConfig","heightConfig","activeLightConfig","maxLightHeight","prepareDefaultLightConfig","Math","round","random","active","lightConfig","lightState","growState","activeState","drawConfig","indices","payload","j","idx","Light","xPos","yPos","lightWidth","p5","growFactor","pos","createVector","newX","getNewPos","topPos","lightActiveColor","lightInactiveColor","lightBgColor","lightPointColor","curIdx","updateHeight","growIntervalId","setInterval","randomizeGrowState","meshEllipsePos","boundaryWidth","noStroke","rect","updateLight","isOnFromDb","canDraw","dBottomPos","dist","dTopPos","updateGrowState","handleGrowState","curLightState","LightConfigStore","getActiveLightState","curGrowState","getGrowState","setGrowState","setActiveLightState","curGrowthActive","curHeight","setHeightState","mapPos","onHeight","map","circle","getHeightState","SequencerStore","getLightState","getDbLightState","setDrawState","r","int","calcGrowState","SequencerBubble","sequencerActiveColor","sequencerInactiveColor","light","getIndices","ellipse","LightManager","lights","showResetAnimation","curTime","var","dir","sequencerBubble","prepareLights","setMaxHeight","lightIncrement","l","draw","MeshManager","ellipsePos","prevMouseX","prevMouseY","mouseX","mouseY","containEllipse","drawLine","drawEllipse","strokeWeight","startPoint","endPoint","weight","line","dbBpm","localBpm","subscriber","newBpm","bpmManager","curBpm","BpmStore","getDbBpm","shouldAdd","sum","isOn","elapsedTime","Date","now","v","sin","mapped","setLocalBpm","floor","sketch","lightManager","meshManager","setup","select","createCanvas","BpmManager","update","mousePressed","setUserInteracting","setEditMode","mouseReleased","windowResized","setTimeout","resizeCanvas","margin","WaveCanvas","containerRef","sketchRef","myP5","containerStyle","configIndex","newConfigIndex","siteURL","herokuURL","socket","io","reconnection","reconnectionDelay","reconnectionAttempts","Infinity","once","subscribe","on","logTime","processFullPayload","data","setSequencerData","getActiveLightConfig","getLocalBpm","ConfigIndexStore","getConfigIndex","json","JSON","stringify","emit","setConfigIndex","config","bpm","setDbBpm","setLightConfig","clearConfig","info","cursor","button","boxShadow","BottomBar","onBpmUpdated","onConfigIndexUpdated","onEditModeUpdate","getElements","onBack","onSend","leftItem","getLeftItem","sendButton","getSendButton","buttonStyle","Websocket","commitLightConfigData","App","addEventListener","handleResize","evaluateOrientation","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.acf92074.chunk.js","sourcesContent":["var _defs, _g;\n\nvar _excluded = [\"svgRef\", \"title\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar SvgClose = function SvgClose(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    viewBox: \"0 0 48.51 48.51\",\n    ref: svgRef\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", null, title) : null, _defs || (_defs = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"style\", null, \".rect{fill:inherit;}.cls-2{fill:none;stroke:#b3b3b3;stroke-miterlimit:10;stroke-width:4px;}\"))), _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Layer_2\",\n    \"data-name\": \"Layer 2\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Layer_1-2\",\n    \"data-name\": \"Layer 1\"\n  }, /*#__PURE__*/React.createElement(\"rect\", {\n    className: \"rect\",\n    width: 48.51,\n    height: 48.51\n  }), /*#__PURE__*/React.createElement(\"line\", {\n    className: \"cls-2\",\n    x1: 9.63,\n    y1: 9.64,\n    x2: 38.88,\n    y2: 38.89\n  }), /*#__PURE__*/React.createElement(\"line\", {\n    className: \"cls-2\",\n    x1: 9.63,\n    y1: 38.89,\n    x2: 38.88,\n    y2: 9.64\n  })))));\n};\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  return /*#__PURE__*/React.createElement(SvgClose, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/close.787123c6.svg\";\nexport { ForwardRef as ReactComponent };","const color = {\r\n    bgBlack: 'black',\r\n    fgWhite: 'white',\r\n    disabled: 'grey'\r\n};\r\n\r\nconst fontSize = {\r\n    extraSmall: '8px',\r\n    kindaSmall: '10px',\r\n    verySmall: '12px',\r\n    lessSmall: '14px',\r\n    small: '16px',\r\n    lessBig: '18px',\r\n    big: '20px',\r\n    veryBig: '24px',\r\n    extraBig: '28px',\r\n    huge: '32px',\r\n    veryHuge: '36px',\r\n    extraHuge: '40px',\r\n    massive: '44px',\r\n    veryMassive: '48px',\r\n    extraMassive: '52px',\r\n    enormous: '56px',\r\n    veryEnormous: '60px',\r\n    extraEnormous: '64px',\r\n    insane: '68px',\r\n    veryInsaane: '72px',\r\n    extraInsane: '76px',\r\n    gaia: '80px',\r\n    veryGaia: '84px',\r\n    extraGaia: '88px'\r\n};\r\n\r\nconst padding = {\r\n    tiny: '2px',\r\n    // Increments of 4\r\n    extraSmall: '4px',\r\n    kindaSmall: '6px',\r\n    verySmall: '8px',\r\n    small: '12px',\r\n    lessBig: '16px',\r\n    // Incremenets of 8\r\n    big : '20px',\r\n    veryBig : '28px',\r\n    extraBig : '36px',\r\n    // Increments of 12\r\n    huge: '52px',\r\n    veryHuge: '64px',\r\n    extraHuge: '76px',\r\n    // Incremenets of 16\r\n    massive: '92px',\r\n    veryMassive: '108px',\r\n    extraMassive: '124px',\r\n    // Increment of 20\r\n    enourmous: '100px',\r\n    veryEnormous: '120px',\r\n    extraEnormous: '140px',\r\n    // Increment of 40\r\n    insane: '160px',\r\n    veryInsane: '200px',\r\n    extraInsane: '240px'\r\n\r\n};\r\n\r\nconst fontFamily = {\r\n    heatwave: 'heatwaveregular',\r\n    airwaves: 'airwavesregular',\r\n    josefin: 'josefin_sanssemibold'\r\n};\r\n\r\nexport { color, fontSize, fontFamily, padding };","var _g;\n\nvar _excluded = [\"svgRef\", \"title\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar SvgAbout = function SvgAbout(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"28px\",\n    height: \"28px\",\n    viewBox: \"0 0 28 28\",\n    ref: svgRef\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", null, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Group-Copy\",\n    transform: \"translate(0.5 0.5)\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Group\",\n    transform: \"translate(0 0.0012207031)\"\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M0 0L26.8571 0L26.8571 26.5126L0 26.5126L0 0Z\",\n    id: \"Rectangle\",\n    fill: \"#FFFFFF\",\n    fillRule: \"evenodd\",\n    stroke: \"#000000\",\n    strokeWidth: 1\n  })), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.68323 11.5706L8.53964 11.5706L8.53964 15.4269L4.68323 15.4269L4.68323 11.5706Z\",\n    id: \"Rectangle-49-Copy\",\n    fill: \"#000000\",\n    fillRule: \"evenodd\",\n    stroke: \"none\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M13.0839 0L26.8568 0L26.8568 26.5126L13.0839 26.5126L13.0839 0Z\",\n    id: \"Rectangle-2\",\n    fill: \"#000000\",\n    fillRule: \"evenodd\",\n    stroke: \"none\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M18.1803 11.5703L22.0367 11.5703L22.0367 15.4267L18.1803 15.4267L18.1803 11.5703Z\",\n    id: \"Rectangle-49\",\n    fill: \"#FFFFFF\",\n    fillRule: \"evenodd\",\n    stroke: \"none\"\n  }))));\n};\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  return /*#__PURE__*/React.createElement(SvgAbout, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/about.ea00a3b0.svg\";\nexport { ForwardRef as ReactComponent };","// Name: EditModeStore.js\r\n// Author: Amay Kataria. \r\n// Date: 02/24/2022\r\n// Description: This data store keeps track of when the user is interacting with the canvas and when\r\n// are we ready to remove that interactive pattern. \r\n\r\nclass EditModeStore {\r\n    constructor() {\r\n        this.isEditMode = false; \r\n        this.isUserInteracting = false; \r\n        this.isPopupActive = false; \r\n        this.subscribers = []; \r\n    }\r\n\r\n    subscribe(listener) {\r\n        this.subscribers.push(listener); \r\n    }\r\n\r\n    setEditMode(val) {\r\n        if (this.isEditing !== val) {\r\n            this.isEditMode = val;\r\n            this.subscribers.forEach(s => s()); \r\n        }\r\n    }\r\n\r\n    setUserInteracting(val) {\r\n        if (this.isUserInteracting !== val) {\r\n            this.isUserInteracting = val; \r\n            this.subscribers.forEach(s => s());\r\n        }\r\n    }\r\n\r\n    setIsPopupActive(val) {\r\n        if (this.isPopupActive !== val) {\r\n            this.isPopupActive = val; \r\n            this.subscribers.forEach(s => s());\r\n        }\r\n    }\r\n}\r\n\r\nexport default new EditModeStore();","/*\r\n  Name: Popup.js\r\n  Author: Amay Kataria\r\n  Date: 02/21/2022\r\n  Description: Popup component that is shown to display the about information. \r\n*/\r\n\r\nimport React from 'react'\r\nimport Radium from 'radium'\r\nimport { color, padding, fontFamily, fontSize } from './CommonStyles.js'\r\nimport { ReactComponent as Exit } from '../svg/close.svg'\r\nimport { fadeOutUp, fadeOutDown, fadeInDown, fadeInUp } from 'react-animations'\r\nimport EditModeStore from '../stores/EditModeStore.js'\r\n\r\n// Maintain the current popup state (to track animations)\r\nvar PopupState = {\r\n    Open: 0,\r\n    Close: 1,\r\n    None: 2\r\n}; \r\n\r\n// Custom Fade in animation. \r\nconst customFadeIn = Radium.keyframes({\r\n    from: {\r\n        opacity: '0'\r\n    },\r\n    to: {\r\n        opacity: '0.5'\r\n    }\r\n}, 'fadesIn'); \r\n\r\nconst customFadeOut = Radium.keyframes({\r\n    from: {\r\n        opacity: '0.5'\r\n    },\r\n    to: {\r\n        opacity: '0'\r\n    }\r\n}, 'fadesOut'); \r\n\r\nconst fadeInDuration = '0.5s'; \r\nconst slideInDuration = '2.0s'; \r\nconst fadeOutDuration = '1.5s';\r\n\r\nconst aboutTheWork = 'Supersynthesis is an interactive audio-visual public art installation that invites people to create a space for collective expression and participation. Accompanied with a physical installation, it utilizes the medium of light and sound to craft a communal experience where the audience activates the piece and the space around it by interacting with it through this online interface. Every audience response is blended into the previous response, thus synthesizing a progressively evolving wave of experience. In an increasingly fragmented society, this project aspires to create an inclusive-whole-living entity, to which anybody can leave a trace of their thought with freedom and creativity. By participating in Supersynthesis, one becomes part of a communal wave that’ll anonymously accumulate until the forthcoming eternity.';\r\nconst styles={\r\n    overlay: {\r\n        position: 'fixed',\r\n        top: '0px',\r\n        bottom: '0px',\r\n        left: '0px',\r\n        right: '0px',\r\n        background: color.bgBlack,\r\n        zIndex: '999'\r\n    },\r\n\r\n    fadeIn: {\r\n        animationName: customFadeIn,\r\n        animationDuration: fadeInDuration,\r\n        animationFillMode: 'forwards',\r\n        animationTimingFunction:'ease-in'\r\n    },\r\n    \r\n    fadeOut: {\r\n        animationName: customFadeOut,\r\n        animationDuration: fadeOutDuration,\r\n        animationFillMode: 'forwards',\r\n        animationTimingFunction: 'ease-out'\r\n    },\r\n\r\n    fadeOutUp: {\r\n        animationName: Radium.keyframes(fadeOutUp, 'fadeOutUp'),\r\n        animationDuration: fadeOutDuration,\r\n        animationFillMode: 'forwards',\r\n        animationTimingFunction: 'ease-out'\r\n    },\r\n\r\n    fadeOutDown: {\r\n        animationName: Radium.keyframes(fadeOutDown, 'fadeOutDown'),\r\n        animationDuration: fadeOutDuration,\r\n        animationFillMode: 'forwards',\r\n        animationTimingFunction: 'ease-out'\r\n    },\r\n\r\n    fadeInDown: {\r\n        animationName: Radium.keyframes(fadeInDown, 'fadeInDown'),\r\n        animationDuration: slideInDuration,\r\n        animationFillMode: 'forwards',\r\n        animationTimingFunction: 'ease-in'\r\n    },\r\n\r\n    fadeInUp: {\r\n        animationName: Radium.keyframes(fadeInUp, 'fadeInUp'),\r\n        animationDuration: slideInDuration,\r\n        animationFillMode: 'forwards',\r\n        animationTimingFunction: 'ease-in'\r\n    },\r\n\r\n    showOverlay: {\r\n        zIndex: '998',\r\n        opacity: '1'\r\n    },\r\n\r\n    hideOverlay: {\r\n        zIndex: '-998',\r\n        opacity: '0'\r\n    },\r\n\r\n    showContent: {\r\n        zIndex: '999',\r\n        opacity: '1'\r\n    },\r\n\r\n    hideContent: {\r\n        zIndex: '-999',\r\n        opacity: '0'\r\n    },\r\n\r\n    contentContainer: {\r\n        position: 'fixed',\r\n        zIndex: '-999',\r\n        left: '0px',\r\n        top:'0px',\r\n        bottom: '0px',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        height: '100%',\r\n        width: '100%',\r\n    },\r\n\r\n    content: {\r\n        borderRadius: fontSize.tiny,\r\n        overflow: 'auto',\r\n        maxWidth: 'calc(100% - 50px)', // Bind this to media query\r\n        maxHeight: 'calc(100% - 100px)', // Bind this to media query\r\n        \r\n        '@media (min-width: 600px)': {      \r\n            maxWidth: 'calc(100% - 100px)', // Bind this to media query\r\n            maxHeight: 'calc(100% - 100px)', // Bind this to media query\r\n        },\r\n\r\n        '@media (min-width: 750px)': {  \r\n            maxWidth: 'calc(100% - 150px)', // Bind this to media query\r\n            maxHeight: 'calc(100% - 100px)', // Bind this to media query\r\n        },\r\n\r\n        '@media (min-width: 1200px)' : {\r\n            maxWidth: 'calc(100% - 300px)', // Bind this to media query\r\n            maxHeight: 'calc(100% - 100px)', // Bind this to media query\r\n        }\r\n    },\r\n\r\n    stretchContainer: {\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        alignItems: 'center',\r\n        background: color.bgBlack,\r\n        color: color.fgWhite,\r\n        paddingLeft: padding.small, // Bind this to media query\r\n        paddingRight: padding.small, // Bind this to media query,\r\n\r\n        '@media (min-width: 600px)': {      \r\n            paddingLeft: padding.extraHuge, \r\n            paddingRight: padding.extraHuge\r\n        },\r\n\r\n        '@media (min-width: 900px)': {  \r\n            paddingLeft: padding.veryMassive, \r\n            paddingRight: padding.veryMassive\r\n        },\r\n\r\n        '@media (min-width: 1200px)' : {\r\n            paddingLeft: padding.extraMassive, \r\n            paddingRight: padding.extraMassive\r\n        },\r\n        opacity: '1.0',\r\n        borderStyle: 'solid',\r\n        borderWidth: '2px',\r\n        borderColor: color.fgWhite\r\n    },\r\n\r\n    title: {\r\n        marginTop: padding.lessSmall,\r\n        marginBottom: padding.small,\r\n        textAlign: 'center',\r\n        fontFamily: fontFamily.heatwave,\r\n        fontSize: fontSize.extraBig,\r\n        letterSpacing: '2.5px',\r\n        lineHeight: '1.8',\r\n       \r\n        '@media (min-width: 750px)': {  \r\n            fontSize: fontSize.extraBig\r\n        },\r\n\r\n        '@media (min-width: 900px)': {  \r\n            fontSize: fontSize.huge\r\n        },\r\n\r\n        '@media (min-width: 1200px)' : {\r\n            fontSize: fontSize.veryHuge\r\n        }\r\n    },\r\n\r\n    body: {\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        justifyContent: 'center',\r\n        fontFamily: fontFamily.josefin,\r\n        letterSpacing: '1.5px',\r\n        fontSize: fontSize.small,\r\n        color: color.fgWhite\r\n    },\r\n\r\n    // Applied on stuff\r\n    mediaQueryOnText: {\r\n        '@media (min-width: 750px)': {  \r\n            fontSize: fontSize.big\r\n        },\r\n\r\n        '@media (min-width: 900px)': {  \r\n            fontSize: fontSize.veryBig\r\n        }\r\n    },\r\n\r\n    iconContainer: {\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        alignSelf: 'flex-end',\r\n        marginRight: '-' + fontSize.verySmall,\r\n        height: fontSize.big,\r\n        width: fontSize.big,\r\n        fill: color.fgWhite,\r\n\r\n        '@media (min-width: 600px)': {  \r\n            marginRight: '-' + fontSize.extraInsane,\r\n            height: fontSize.veryBig, \r\n            width: fontSize.veryBig\r\n        },\r\n\r\n        '@media (min-width: 900px)': {  \r\n            height: fontSize.extraBig, \r\n            width: fontSize.extraBig,\r\n            marginRight: '-108px'\r\n        },\r\n\r\n        '@media (min-width: 1200px)': {  \r\n            marginRight: '-124px'\r\n        }\r\n    },\r\n\r\n    icon: { \r\n        width: '100%',\r\n        height: '100%'\r\n    },\r\n\r\n    footerContainer: {\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        alignItems: 'center',\r\n        marginTop: padding.veryBig,\r\n        fontFamily: fontFamily.josefin,\r\n        letterSpacing: '1.5px',\r\n    },\r\n\r\n    footer: {\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        marginTop: padding.verySmall,\r\n        fontSize: fontSize.lessSmall,\r\n        '@media (min-width: 750px)': {  \r\n            fontSize: fontSize.small,\r\n        }\r\n    },\r\n\r\n    copyright: {\r\n        marginTop: padding.veryBig,\r\n        fontSize: fontSize.verySmall,\r\n        marginBottom: padding.small\r\n    },\r\n\r\n    link: {\r\n        backgroundColor: color.fgWhite,\r\n        color: color.bgBlack,\r\n        padding: padding.tiny\r\n    }\r\n}\r\n\r\nclass Popup extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state={\r\n            isVisible: false,\r\n            popupState: PopupState.None,\r\n        };\r\n\r\n        this.content = React.createRef(); \r\n    }\r\n\r\n    render() {\r\n        // Handle overlay styles. \r\n        let overlayStyle; \r\n        if (this.state.isVisible) {\r\n            overlayStyle = [styles.overlay, styles.showOverlay]; \r\n            if (this.state.popupState === PopupState.Open) {\r\n                overlayStyle = [overlayStyle, styles.fadeIn]; \r\n            } else if (this.state.popupState === PopupState.Close) {\r\n                overlayStyle = [overlayStyle, styles.fadeOut]; \r\n            } else {\r\n                // Do nothing. \r\n            }\r\n        } else {\r\n            overlayStyle = [styles.overlay, styles.hideOverlay]; \r\n        }\r\n\r\n        // Handle different types of Popups. \r\n        let content, contentContainerStyle; \r\n        content = this.getAboutContent();\r\n        if (this.state.isVisible) {\r\n            contentContainerStyle = [styles.contentContainer, styles.showContent]; \r\n            if (this.state.popupState === PopupState.Open) {\r\n                contentContainerStyle = [contentContainerStyle, styles.fadeInDown]; \r\n            } else if (this.state.popupState === PopupState.Close) {\r\n                contentContainerStyle = [contentContainerStyle, styles.fadeOutUp];\r\n            } else {\r\n                // Do nothing when it's in None state. \r\n            }\r\n        } else {\r\n            contentContainerStyle = [styles.contentContainer, styles.hideContent]; \r\n        }\r\n\r\n        return (\r\n            <div onClick={this.handleOnTouch.bind(this)} onTouchStart={this.handleOnTouch.bind(this)} >\r\n                <div style={overlayStyle}></div>\r\n                <div onAnimationEnd={this.contentAnimationEnd.bind(this)} style={contentContainerStyle}>\r\n                    {content}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    contentAnimationEnd() {\r\n        if (this.state.isVisible) {\r\n            // Hide everything when content animation ends. \r\n            if (this.state.popupState === PopupState.Close) {\r\n                this.setState({\r\n                    isVisible: false,\r\n                    popupState: PopupState.None\r\n                }); \r\n            }\r\n        }\r\n    }\r\n\r\n    getIconButton() {\r\n        return(\r\n            <div onClick={this.hidePopup.bind(this)} style={styles.iconContainer}>\r\n                <Exit style={styles.icon} />\r\n            </div>\r\n        ); \r\n    }\r\n\r\n    getAboutContent() {\r\n        let footer = this.getFooter(); \r\n        let iconButton = this.getIconButton();  \r\n        let bodyStyle = [styles.body, styles.mediaQueryOnText];\r\n        return (\r\n            <div ref={this.content} style={styles.content}>\r\n                <div style={styles.stretchContainer}>\r\n                    { iconButton }\r\n                    <div style={bodyStyle}>\r\n                        <div style={styles.title}>supersynthesis</div>\r\n                        <div style={styles.description}>{aboutTheWork}</div>                        \r\n                    </div>\r\n                    { footer }\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    getFooter() {\r\n        const tim = 'https://www.vaexhibitions.arts.columbia.edu/class-of-2021-first-years/timothy-kwasny';\r\n        const amay = 'https://amaykataria.com';\r\n        return (\r\n            <div style={styles.footerContainer}>\r\n                <div style={styles.footer}>\r\n                    <span>Created by&nbsp;</span>\r\n                    <a \r\n                        style={styles.link} \r\n                        target='_blank' \r\n                        rel=\"noopener noreferrer\" \r\n                        href={amay}>\r\n                        Amay Kataria\r\n                    </a>\r\n                </div>\r\n                <div style={styles.footer}>\r\n                    <span>Sound by&nbsp;</span>\r\n                    <a \r\n                        style={styles.link} \r\n                        target='_blank' \r\n                        rel=\"noopener noreferrer\" \r\n                        href={tim}>\r\n                        Timothy Kwasny\r\n                    </a>\r\n                </div>\r\n                <div style={styles.copyright}>© Amay Kataria 2022</div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    showPopup() {\r\n        // Adjust the scroll top.\r\n        this.content.current.scrollTop = 0; \r\n        this.setState({\r\n            isVisible: true,\r\n            popupState: PopupState.Open,\r\n        }); \r\n    }\r\n\r\n    hidePopup(event) {\r\n        event.stopPropagation(); \r\n        this.setState({\r\n            popupState: PopupState.Close\r\n        });\r\n        EditModeStore.setIsPopupActive(false);\r\n    }\r\n\r\n    handleOnTouch(event) {\r\n        // Don't let this propogate to the main screen\r\n        // where touch events mean something. \r\n        event.stopPropagation();\r\n    }\r\n }\r\n\r\nexport default Radium(Popup);\r\n\r\n","/*\r\n  Name: BottomBar.js\r\n  Author: Amay Kataria\r\n  Date: 02/19/2022\r\n  Description: React component for the top navigation bar on the webpage.\r\n*/\r\nimport React from 'react'\r\nimport Radium from 'radium'\r\nimport Popup from './Popup'\r\nimport { ORIENTATION } from './App'\r\nimport { ReactComponent as About } from '../svg/about.svg'\r\nimport {color, fontFamily, fontSize, padding} from './CommonStyles'\r\nimport EditModeStore from '../stores/EditModeStore'\r\n\r\nconst animation = {\r\n  rotate: Radium.keyframes({\r\n    '0%': {\r\n      transform: 'rotate(0deg)'\r\n    },\r\n    '50%': {\r\n      transform: 'rotate(180deg)',\r\n    },\r\n    '100%': {\r\n      transform: 'rotate(360deg)',\r\n    }\r\n  }),\r\n}\r\n\r\nconst styles = {\r\n    container: {\r\n        position: 'relative',\r\n        display: 'flex',\r\n        flexDirection: 'row',\r\n        justifyContent: 'space-between',\r\n        alignItems: 'center',\r\n        paddingLeft: padding.small,\r\n        paddingRight: padding.small,\r\n        zIndex: '1'\r\n    },\r\n\r\n    title: {\r\n        backgroundColor: color.bgBlack,\r\n        color: color.fbWhite,\r\n        padding: padding.small,\r\n        fontFamily: fontFamily.heatwave,\r\n        fontSize: fontSize.lessBig,\r\n        letterSpacing: '2px'\r\n    },\r\n    \r\n    iconContainer: {\r\n      display: 'flex',\r\n      justifyContent: 'center',\r\n      width: fontSize.huge,\r\n      height: fontSize.huge,\r\n      marginTop: padding.kindaSmall,\r\n    },\r\n\r\n    simpleRotation: {\r\n      animation: 'x 30s ease-in-out infinite',\r\n      animationName: animation.rotate\r\n    },\r\n  \r\n    icon: {\r\n        width: '100%',\r\n        height: '100%'\r\n    }\r\n};\r\n\r\nclass Navbar extends React.Component {\r\n  constructor(props) {\r\n    super(props); \r\n    this.state={\r\n    }\r\n\r\n    this.popupRef = React.createRef(); \r\n  }\r\n\r\n  render() {\r\n    let aboutStyle = [styles.iconContainer, styles.simpleRotation];\r\n    let heightStyle = this.getHeightStyle(); \r\n    return (\r\n      <div style={styles.block}>\r\n        <Popup ref={this.popupRef}/>\r\n        <div style={[styles.container, heightStyle]}>\r\n          <div style={styles.title}>supersynthesis</div>\r\n          <div style={aboutStyle} onClick={this.handleAbout.bind(this)}>\r\n            <About style={styles.icon} />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  getHeightStyle() {\r\n    let height = this.getHeight();\r\n    let heightStyle = {\r\n      height: height + 'px'\r\n    };\r\n    return heightStyle; \r\n  }\r\n\r\n  getHeight() {\r\n    let deviceHeight = window.innerHeight;\r\n    let deviceWidth = window.innerWidth; \r\n    let c = 0; \r\n    if (this.props.orientation === ORIENTATION.PORTRAIT) {\r\n      if (deviceHeight < 900) {\r\n        c = 0.1\r\n      }\r\n\r\n      if (deviceHeight > 900 && deviceHeight < 1000) {\r\n        c = 0.075\r\n      }\r\n\r\n      if (deviceHeight > 1000) {\r\n        c = 0.06\r\n      }\r\n    }\r\n\r\n    if (this.props.orientation === ORIENTATION.LANDSCAPE) {\r\n      if (deviceWidth < 1000) {\r\n        c = 0.15; \r\n      }      \r\n\r\n      if (deviceWidth > 1000) {\r\n        c = 0.09\r\n      }\r\n    }\r\n\r\n    return deviceHeight * c; \r\n  }\r\n\r\n  handleAbout() {\r\n    console.log('Create a popup.');\r\n    this.popupRef.current.showPopup();\r\n    EditModeStore.setIsPopupActive(true);\r\n  }\r\n}\r\n\r\nexport default Radium(Navbar);\r\n","// Name: LightConfigStore.js\r\n// Author: Amay Kataria. \r\n// Date: 02/19/2022\r\n// Description: Core data store for the application that stores the data for all the 24 lights. This data is divided\r\n// into four states: light, height, grow, and draw. These states are responsible for how the lights are drawn and \r\n// transmitted to the database. \r\n\r\nexport const LIGHT_STATE = {\r\n    ON: 1,\r\n    OFF: 0\r\n};\r\n\r\nexport const GROW_STATE = {\r\n    NONE: 0,\r\n    GROW: 1,\r\n    SHRINK: 2\r\n}\r\n\r\nconst NUM_LIGHTS = 24;\r\n\r\nclass LightConfigStore {\r\n    constructor() {\r\n        // Separate config arrays for the 24 lights.\r\n        this.dbLightConfig = []; // What comes from the dB. Don't modify this. \r\n        this.growConfig = [];\r\n        this.heightConfig = []; \r\n        this.activeLightConfig = []; // Currently being edited in the app. \r\n\r\n        // Helper value to create default heights. \r\n        this.maxLightHeight = 0;\r\n\r\n        // Default light config for 24 lights. \r\n        this.prepareDefaultLightConfig();\r\n    }\r\n\r\n    setMaxHeight(height) {\r\n        this.maxLightHeight = height; \r\n    }\r\n\r\n    // Default config for 24 lights. \r\n    prepareDefaultLightConfig() {\r\n        console.log('Preparing default config.');\r\n        for (let i = 0; i < NUM_LIGHTS; i++) {\r\n            // All lights are off by default and are not doing any growth. \r\n            // Just a simple helper routine.\r\n            let r = Math.round(Math.random());\r\n            let s = r === 0 ? LIGHT_STATE.ON : LIGHT_STATE.OFF; \r\n            this.dbLightConfig.push(s);\r\n            this.activeLightConfig.push(s); \r\n            this.growConfig.push({state: GROW_STATE.NONE, active: false});\r\n            this.heightConfig.push(0); \r\n        }\r\n    }\r\n\r\n    getActiveLightConfig() {\r\n        // Return the one that we have been editing. \r\n        return this.activeLightConfig; \r\n    }\r\n    // Sets the light config along with other configs that \r\n    // coming from the server. Overwrite activeLightConfig as well.\r\n    setLightConfig(lightConfig) {\r\n        for (let i = 0; i < lightConfig.length; i++) {\r\n            let lightState = lightConfig[i];\r\n            this.dbLightConfig[i] = lightState; \r\n            this.activeLightConfig[i] = lightState; \r\n            this.growConfig[i] = {state: GROW_STATE.NONE, active: false}; // Reset growth on every light. \r\n            this.heightConfig[i] = (lightState === LIGHT_STATE.ON) ? this.maxLightHeight : 0; \r\n            // Don't modify Draw State. That is modified by the sequencer event. \r\n        }\r\n    }\r\n\r\n    // Light config from the database. \r\n    getDbLightState(i) {\r\n        return this.dbLightConfig[i];\r\n    }\r\n    // Light config that is actively being edited. \r\n    getActiveLightState(i) {\r\n        return this.activeLightConfig[i];\r\n    }\r\n    setActiveLightState(i, lightState) {\r\n        this.activeLightConfig[i] = lightState; \r\n    }\r\n\r\n    // GET/SET light's grow state. \r\n    getGrowState(i) {\r\n        return this.growConfig[i];\r\n    }\r\n    setGrowState(i, growState, activeState) {\r\n        this.growConfig[i]['state'] = growState;\r\n        this.growConfig[i]['active'] = activeState;\r\n    }\r\n\r\n    // GET/SET light's heights. \r\n    getHeightState(i) {\r\n        return this.heightConfig[i];\r\n    }\r\n    setHeightState(i, height) {\r\n        this.heightConfig[i] = height; \r\n    }\r\n}\r\n\r\nexport default new LightConfigStore();","// Name: SequencerStore.js\r\n// Author: Amay Kataria. \r\n// Date: 03/03/2022\r\n// Description: A data store to keep track of all data coming from the sequencer\r\n// events from the central server. \r\n\r\nimport { LIGHT_STATE } from \"./LightConfigStore\";\r\nconst NUM_LIGHTS = 24;\r\n\r\nclass SequencerStore {\r\n    constructor() {\r\n        this.drawConfig = [];\r\n        this.indices = []; \r\n    }\r\n\r\n    getIndices() {\r\n        return this.indices;\r\n    }\r\n\r\n    setSequencerData(payload) {\r\n        let lightState = payload['state'];\r\n        if (lightState === 'NONE') {\r\n            // Turn off all the lights. \r\n            for (let i = 0; i < NUM_LIGHTS; i++) {\r\n                this.drawConfig[i] = LIGHT_STATE.OFF;\r\n            }\r\n            this.indices = []; \r\n        } else {\r\n            for (let i = 0; i < lightState.length; i++) {\r\n                let s = lightState[i];\r\n                // All data is in an array.  \r\n                for (let j = 0; j < s.length; j++) {\r\n                    let idx = s[j]['idx'];\r\n                    let val = s[j]['val'];\r\n                    this.drawConfig[idx] = val; \r\n                    this.indices[j] = idx; \r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    clearConfig() {\r\n        this.drawConfig.length = 0;\r\n    }\r\n\r\n    getLightState(i) {\r\n        return this.drawConfig[i];\r\n    }\r\n}\r\n\r\nexport default new SequencerStore();","/*\r\n  Name: Light.js\r\n  Author: Amay Kataria\r\n  Date: 02/19/2022\r\n  Description: A class representing each light that is painted on the canvas. \r\n*/\r\nimport LightConfigStore, { LIGHT_STATE, GROW_STATE } from \"../stores/LightConfigStore\";\r\nimport SequencerStore from '../stores/SequencerStore';\r\nimport EditModeStore from \"../stores/EditModeStore\";\r\n\r\nexport default class Light {\r\n    constructor(s, i, xPos, yPos, lightWidth) {\r\n        // Sketch object. \r\n        this.p5 = s; \r\n\r\n        // Light's width. \r\n        this.lightWidth = lightWidth;\r\n\r\n        this.growFactor = this.p5.random(1.5, 2.5);\r\n\r\n        // Origin point at the bottom of the canvas. \r\n        this.pos = this.p5.createVector(xPos, yPos);\r\n        \r\n        // Point at the top. \r\n        let newX = this.getNewPos() + this.lightWidth/2; // Keep this at the center of the light.\r\n        this.topPos = this.p5.createVector(newX, 0); // By default at the top. \r\n        \r\n        // Colors. \r\n        this.lightActiveColor = this.p5.color('white');\r\n        this.lightInactiveColor = this.p5.color(255, 255, 255, 125);\r\n        this.lightBgColor = this.p5.color(255, 255, 255, 30);\r\n        this.lightPointColor = this.p5.color('green'); // Only debug.\r\n\r\n        // Store the current light config. \r\n        this.curIdx = i; \r\n        this.updateHeight(); \r\n\r\n        // Variable for the timer's interval id. \r\n        this.growIntervalId = ''; \r\n        setInterval(this.randomizeGrowState.bind(this), 3000); \r\n    }\r\n\r\n\r\n    draw(meshEllipsePos, boundaryWidth) {\r\n        let isEditMode = EditModeStore.isEditMode; \r\n        let newX = this.getNewPos();\r\n        this.p5.noStroke();\r\n\r\n        // Draw the background lights.\r\n        this.p5.fill(this.lightBgColor);        \r\n        this.p5.rect(newX, this.pos['y'], this.lightWidth, -this.p5.height);\r\n\r\n        if (isEditMode) {\r\n            this.updateLight(meshEllipsePos, boundaryWidth);            \r\n            // Draw the actual light. \r\n            let height = this.getHeight();\r\n            this.p5.fill(this.lightActiveColor);\r\n            this.p5.rect(newX, this.pos['y'], this.lightWidth, -height);  \r\n        } else {\r\n            // Draw the actual lights from the DB config that are lighting. \r\n            if (this.isOnFromDb()) {\r\n                this.p5.fill(this.lightInactiveColor);\r\n                this.p5.rect(newX, this.pos['y'], this.lightWidth, -this.p5.height);\r\n            }\r\n\r\n            // Draw the lights from the db config that should be on. \r\n            if (this.canDraw()) {\r\n                // Draw full light.\r\n                this.p5.fill(this.lightActiveColor);\r\n                this.p5.rect(newX, this.pos['y'], this.lightWidth, -this.p5.height);  \r\n            }\r\n        }\r\n\r\n\r\n        // this.drawLightPoint();\r\n    }\r\n\r\n    updateLight(meshEllipsePos, boundaryWidth) {\r\n        let isUserInteracting = EditModeStore.isUserInteracting;\r\n        if (isUserInteracting) {\r\n            let dBottomPos = meshEllipsePos.dist(this.pos);\r\n            let dTopPos = meshEllipsePos.dist(this.topPos);\r\n            if (dBottomPos < boundaryWidth/2 || dTopPos < boundaryWidth/2) {\r\n                // This light is activated, grow or shrink. \r\n                this.updateGrowState();\r\n            }\r\n        }\r\n\r\n        this.handleGrowState();\r\n    }\r\n\r\n    \r\n    updateGrowState() {\r\n        let curLightState = LightConfigStore.getActiveLightState(this.curIdx);\r\n        let curGrowState = LightConfigStore.getGrowState(this.curIdx); \r\n\r\n        // Is the light on? \r\n        if (curLightState === LIGHT_STATE.ON) {\r\n            // Is this light currently growing or shrinking? \r\n            if (curGrowState['active']) {\r\n                // I'm doing something - let's not do anything. \r\n            } else {\r\n                // Is the state set to shrink? Because it can only shrink. \r\n                if (curGrowState['state'] === GROW_STATE.SHRINK) {\r\n                    LightConfigStore.setGrowState(this.curIdx, GROW_STATE.SHRINK, true);\r\n                    // This light will not be turned on anymore.  \r\n                    LightConfigStore.setActiveLightState(this.curIdx, LIGHT_STATE.OFF);                \r\n                } else {\r\n                    // Pass, we can't grow a light that's already on. \r\n                }\r\n            }\r\n        }\r\n\r\n        if (curLightState === LIGHT_STATE.OFF) {\r\n            if (curGrowState['active']) {\r\n                // I'm doing something - let's not do anything. \r\n            } else {\r\n                if (curGrowState['state'] === GROW_STATE.GROW) {\r\n                    LightConfigStore.setGrowState(this.curIdx, GROW_STATE.GROW, true);\r\n                    // This light will not be turned on anymore.  \r\n                    LightConfigStore.setActiveLightState(this.curIdx, LIGHT_STATE.ON);\r\n                } else {\r\n                    // Pass, we can't shrink a light that's already off. \r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    // Grow & Shrink the height of the light.\r\n    handleGrowState() {\r\n        let curGrowthActive = this.getGrowState()['active'];\r\n        let curGrowState = this.getGrowState()['state'];\r\n        let curHeight = this.getHeight();\r\n\r\n        // Is the current light's grow active? \r\n        if (curGrowthActive) {\r\n            switch (curGrowState) {\r\n                case GROW_STATE.NONE: {\r\n                    // Pass don't do antyhing. \r\n                    break;\r\n                }\r\n    \r\n                case GROW_STATE.GROW: {\r\n                    if (curHeight < this.p5.height) {\r\n                        curHeight += this.growFactor;\r\n                        LightConfigStore.setHeightState(this.curIdx, curHeight);\r\n                        this.mapPos(curHeight);\r\n                    } else {\r\n                        // Deactivate the current light. \r\n                        LightConfigStore.setGrowState(this.curIdx, GROW_STATE.NONE, false);\r\n                    }\r\n                    break;\r\n                }\r\n    \r\n                case GROW_STATE.SHRINK: {\r\n                    if (curHeight > 0) {\r\n                        curHeight -= this.growFactor; \r\n                        LightConfigStore.setHeightState(this.curIdx, curHeight);\r\n                        this.mapPos(curHeight);\r\n                    } else {\r\n                        // Deactivate the current light. \r\n                        LightConfigStore.setGrowState(this.curIdx,  GROW_STATE.NONE, false);\r\n                    }\r\n                    break;\r\n                }\r\n    \r\n                default: \r\n                    break;\r\n            }\r\n        }\r\n    }\r\n    \r\n    // Set light heights based on the light configurations.\r\n    // Call this functions when new configs are received. \r\n    updateHeight() {\r\n        let lightState = LightConfigStore.getActiveLightState(this.curIdx);         \r\n        let onHeight = this.p5.height;\r\n        let offHeight = 0;\r\n\r\n        if (lightState === LIGHT_STATE.ON) {\r\n            LightConfigStore.setHeightState(this.curIdx, onHeight);\r\n        }\r\n\r\n        if (lightState === LIGHT_STATE.OFF) {\r\n            LightConfigStore.setHeightState(this.curIdx, offHeight);\r\n        }\r\n    }\r\n\r\n    mapPos( height) {\r\n        this.topPos['y'] = this.p5.map(height, 0, this.p5.height, this.p5.height, 0);\r\n    }\r\n\r\n    drawLightPoint() {\r\n        let newX = this.getNewPos();\r\n        this.p5.fill(this.lightPointColor)\r\n        this.p5.circle(newX, this.pos['y'], 5);\r\n    }\r\n    \r\n    getNewPos() {\r\n        return this.pos['x'] + this.lightWidth/2; \r\n    }\r\n\r\n    getGrowState() {\r\n        return LightConfigStore.getGrowState(this.curIdx);\r\n    }\r\n\r\n    getHeight() {\r\n        let heightState = LightConfigStore.getHeightState(this.curIdx);\r\n        return heightState;\r\n    }\r\n\r\n    canDraw() {\r\n        let drawState = SequencerStore.getLightState(this.curIdx);\r\n        return drawState; // It's true or false. \r\n    }\r\n\r\n    isOn() {\r\n        let lightState = LightConfigStore.getActiveLightState(this.curIdx);\r\n        return lightState; \r\n    }\r\n\r\n    isOnFromDb() {\r\n        let lightState = LightConfigStore.getDbLightState(this.curIdx);\r\n        return lightState; \r\n    }\r\n\r\n    isGrowing() {\r\n        let v = LightConfigStore.getGrowState(this.curIdx)['active'];\r\n        return v;\r\n    }\r\n\r\n    updateDrawState(state) {\r\n        LightConfigStore.setDrawState(this.curIdx, state); \r\n    }\r\n\r\n    randomizeGrowState() {\r\n        let calcGrowState = () => {\r\n            let curGrowState = this.getGrowState(); \r\n            if (curGrowState['active']) {                \r\n                // I'm currently growing or doing something. \r\n                // Pass\r\n            } else {\r\n                // Update my state. \r\n                let r = this.p5.int(this.p5.random(0, 2)); \r\n                r = r === 1 ? GROW_STATE.GROW : GROW_STATE.SHRINK;\r\n                LightConfigStore.setGrowState(this.curIdx, r, false);\r\n            }\r\n        }\r\n\r\n        // Set new grow states for top and bottom light for the current light. \r\n        calcGrowState();        \r\n    }\r\n}\r\n\r\n        // let height = this.getHeight();\r\n        // if (this.canDraw()) {\r\n        //     this.p5.fill(this.lightActiveColor);\r\n        // } else {\r\n        //     this.p5.fill(this.lightInactiveColor);\r\n        // }\r\n        // this.p5.rect(newX, this.pos['y'], this.lightWidth, -height);\r\n    // specialDraw() {\r\n    //     let newX = this.getNewPos();\r\n\r\n    //     // Background bars.\r\n    //     this.p5.fill(this.lightBgColor);\r\n    //     this.p5.rect(newX, 0, this.lightWidth, this.p5.height);\r\n\r\n    //     // Full light bars.\r\n    //     this.p5.fill(this.lightColor);\r\n    //     this.p5.rect(newX, 0, this.lightWidth, this.p5.height);\r\n    // }\r\n\r\n// let isEditMode = EditModeStore.isEditMode;\r\n// let isUserInteracting = EditModeStore.isUserInteracting; \r\n        // } else {\r\n        //     // this.p5.fill(this.lightBgColor);\r\n        //     // this.p5.rect(newX, 0, this.lightWidth, this.p5.height);\r\n        //     // // Draw solid light\r\n        //     // if (this.canDraw()) {\r\n        //     //     this.p5.fill(this.lightColor);\r\n        //     //     this.p5.rect(newX, 0, this.lightWidth, this.p5.height);\r\n        //     // }\r\n        // }\r\n                //if (isUserInteracting || isEditMode) {\r\n\r\n                // Bottom lights\r\n        // this.p5.fill(this.lightBgColor);\r\n        // this.p5.rect(newX, this.pos['y'], this.lightWidth, this.p5.height/2);\r\n\r\n        // height = this.getHeight(LIGHT_TYPE.BOTTOM);\r\n        // this.p5.fill(this.lightInactiveColor);\r\n        // this.p5.rect(newX, this.pos['y'], this.lightWidth, height);  ","/*\r\n  Name: Sequencer.js\r\n  Author: Amay Kataria\r\n  Date: 03/03/2022\r\n  Description: A class to render the sequencer object on the screen. \r\n*/\r\nimport EditModeStore from \"../stores/EditModeStore\";\r\nimport SequencerStore from \"../stores/SequencerStore\";\r\n\r\nexport default class SequencerBubble {\r\n    constructor(s) {\r\n        // Sketch object. \r\n        this.p5 = s; \r\n\r\n        this.sequencerActiveColor = this.p5.color(255, 0, 0, 200);\r\n        this.sequencerInactiveColor = this.p5.color(255, 0, 0, 100);\r\n    }\r\n\r\n    draw(light) {\r\n        let indices = SequencerStore.getIndices();\r\n        let isEditMode = EditModeStore.isEditMode;\r\n        for (let i = 0; i < indices.length; i++) {\r\n            let idx = indices[i];     \r\n            if (idx === light.curIdx) {\r\n                if (isEditMode) {\r\n                    this.p5.fill(this.sequencerInactiveColor);                \r\n                } else {\r\n                    this.p5.fill(this.sequencerActiveColor);                \r\n                }\r\n                \r\n                let newX = light.getNewPos(); \r\n                this.p5.ellipse(newX + light.lightWidth/2, this.p5.height/2, light.lightWidth, light.lightWidth);\r\n            }\r\n        }\r\n    }\r\n}\r\n","/*\r\n  Name: LightManager.js\r\n  Author: Amay Kataria\r\n  Date: 02/19/2022\r\n  Description: A class responsible for handling all the lights. This class is the most critical class\r\n  in this project. \r\n*/\r\nimport Light from './Light'\r\nimport LightConfigStore from \"../stores/LightConfigStore\";\r\nimport SequencerBubble from './SequencerBubble';\r\n\r\nconst NUM_LIGHTS = 24\r\n\r\nexport default class LightManager {\r\n    constructor(s) {\r\n        this.p5 = s; \r\n        this.lights = [];\r\n        this.showResetAnimation = false; \r\n        this.curTime = 0; \r\n        this.var = 0; \r\n        this.dir = true; \r\n\r\n        this.sequencerBubble = new SequencerBubble(s);\r\n    }\r\n    \r\n    setup() {\r\n        // Prepare the light collection.\r\n        this.prepareLights();\r\n    }\r\n\r\n    prepareLights() {\r\n        this.lights = []; \r\n\r\n        // Set max height again since the canvas has been resized. \r\n        LightConfigStore.setMaxHeight(this.p5.height);\r\n        \r\n        // Distance between each tube. \r\n        let lightIncrement = (this.p5.width) / NUM_LIGHTS;\r\n\r\n        // Width of each light is half the distance between each light.\r\n        let lightWidth = lightIncrement / 2;\r\n        for (let i = 0; i < NUM_LIGHTS; i++) {\r\n            let xPos = i * lightIncrement; \r\n            // Create a new light instance. \r\n            let l = new Light(this.p5, i, xPos, this.p5.height, lightWidth);\r\n            this.lights.push(l);\r\n        }\r\n    }\r\n    \r\n    draw(meshEllipsePos, boundaryWidth) {\r\n        // Draw the lights based on the state. \r\n        for (let i = 0; i < this.lights.length; i++) {\r\n            let light = this.lights[i]; \r\n            light.draw(meshEllipsePos, boundaryWidth);\r\n            this.sequencerBubble.draw(light);\r\n        }\r\n    }\r\n}\r\n\r\n// newPayloadReceived() {\r\n//     this.showResetAnimation = true; \r\n//     this.curTime = Date.now(); \r\n// }\r\n// // Reset this value here. \r\n// this.isCurrentlyGrowing = false;  \r\n// // Cycle the lights from left to right, then right to left. \r\n// // this.handleUserNotInteracting(); \r\n// for (let i = 0; i < this.lights.length; i++) {\r\n//     let light = this.lights[i];\r\n//     let top = light.isGrowing(LIGHT_TYPE.TOP);\r\n//     let bottom = light.isGrowing(LIGHT_TYPE.BOTTOM);\r\n//     this.isCurrentlyGrowing = this.isCurrentlyGrowing || top || bottom; \r\n// }\r\n\r\n// updateLightGrowConfig(meshEllipsePos, boundaryWidth) {\r\n//     for (let i = 0; i < this.lights.length; i++) {\r\n//         let light = this.lights[i];\r\n\r\n//         // Distance from the ellipse to the light's position. \r\n//         let d = meshEllipsePos.dist(light.pos);\r\n//         if (d < boundaryWidth/2) {\r\n//             // This light is activated, grow or shrink. \r\n//             light.updateGrowState();\r\n//             console.log('Something updated');\r\n//         }\r\n//     }\r\n// }\r\n\r\n\r\n// if (this.showResetAnimation) {\r\n//     if (this.var < this.lights.length) {\r\n//         for (let i = 0; i < this.var; i++) {\r\n//             this.lights[i].specialDraw(); \r\n//         }\r\n//         if (this.dir) {\r\n//             this.var += 1; \r\n//         } else {\r\n//             this.var -= 1; \r\n//         }\r\n//         if (this.var === 24) {\r\n//             this.var = 23;\r\n//             this.dir = false; \r\n//         }\r\n//         if (this.var === -1) {\r\n//             this.var = 0; \r\n//             this.dir = true;\r\n//             this.showResetAnimation = false;\r\n//         }\r\n//     }\r\n// } else {\r\n\r\n\r\n    // if (isUserInteracting || isEditMode) {\r\n    //     // Draw a center line. \r\n    //     this.p5.stroke(\"black\")\r\n    //     this.p5.strokeWeight(6)\r\n    //     this.p5.line(0, this.p5.height/2, this.p5.width, this.p5.height/2)\r\n    // }\r\n\r\n            // // Only\r\n            // let isUserInteracting = EditModeStore.isUserInteracting; \r\n            // let isEditMode = EditModeStore.isEditMode; \r\n            // if (isUserInteracting) {\r\n            //     // Update the light configuration based on the user's finger. \r\n            //     this.updateLightGrowConfig(meshEllipsePos, boundaryWidth);\r\n            // }","/*\r\n  Name: MeshManager.js\r\n  Author: Amay Kataria\r\n  Date: 02/19/2022\r\n  Description: A class responsible for drawing the connections from the ellipse to all\r\n  the moving lights on the canvas. \r\n*/\r\nimport EditModeStore from \"../stores/EditModeStore\";\r\n\r\n// Handles all the code related to interaction with the canvas.\r\nconst EASING = 0.025;  \r\nconst ELLIPSE_RADIUS = 50; \r\nexport default class MeshManager {\r\n    constructor(s) {\r\n        this.p5 = s; \r\n        this.ellipsePos = this.p5.createVector(this.p5.width/3, this.p5.height/2);\r\n        this.boundaryWidth = this.p5.height;\r\n        this.prevMouseX = 0;\r\n        this.prevMouseY = 0; \r\n    }\r\n\r\n    draw(lights) {\r\n        let isEditMode = EditModeStore.isEditMode; \r\n        let isPopupActive = EditModeStore.isPopupActive;        \r\n        if (isEditMode) {\r\n            let mouseX, mouseY;\r\n            // Don't trap mouseX or mouseY if I'm in the popup. \r\n            if (isPopupActive || this.p5.mouseY > this.p5.height || this.p5.mouseY < 0) {\r\n                mouseX = this.prevMouseX;\r\n                mouseY = this.prevMouseY; \r\n            } else {\r\n                mouseX = this.p5.mouseX;\r\n                mouseY = this.p5.mouseY;\r\n            }\r\n\r\n            this.ellipsePos['x'] += (mouseX - this.ellipsePos['x']) * EASING;\r\n            this.ellipsePos['y'] += (mouseY - this.ellipsePos['y']) * EASING; \r\n\r\n            // Make sure the ellipse doesn't go outside the boundary.\r\n            this.containEllipse();\r\n\r\n            // Draw pull lines for top and bottom lights.\r\n            for (let i = 0; i < lights.length; i++) {\r\n                let light = lights[i];\r\n\r\n                let pos = light.topPos;\r\n                let height = light.getHeight();\r\n                if (height < this.p5.height && height > 0) {\r\n                    this.drawLine(pos, this.ellipsePos, i);\r\n                }\r\n            }\r\n\r\n            // Draw ellipse tracking the mouse. \r\n            this.drawEllipse();\r\n\r\n            this.prevMouseX = mouseX;\r\n            this.prevMouseY = mouseY;\r\n        }        \r\n    }\r\n    \r\n    // Calculate new ellipse position. \r\n    containEllipse() {\r\n        if (this.ellipsePos['x'] > this.p5.width) {\r\n            this.ellipsePos['x'] = this.p5.width;\r\n        } \r\n\r\n        if (this.ellipsePos['x'] < 0) {\r\n            this.ellipsePos['x'] = 0;\r\n        } \r\n\r\n        if (this.ellipsePos['y'] > this.p5.height) {\r\n            this.ellipsePos['y'] = this.p5.height;\r\n        } \r\n\r\n        if (this.ellipsePos['y'] < 0) {\r\n            this.ellipsePos['y'] = 0;\r\n        } \r\n    }\r\n\r\n    drawEllipse() {\r\n        // // Outer ellipse boundary \r\n        // this.p5.fill(this.p5.color(255, 255, 255, 50));\r\n        // this.p5.noStroke();\r\n        // this.p5.ellipse(this.ellipsePos['x'], this.ellipsePos['y'], this.boundaryWidth);  \r\n\r\n        // Inner ellipse\r\n        this.p5.fill(this.p5.color(255, 255, 255, 150));\r\n        this.p5.strokeWeight(3);\r\n        this.p5.stroke(this.p5.color('black'));\r\n        this.p5.ellipse(this.ellipsePos['x'], this.ellipsePos['y'], ELLIPSE_RADIUS);  \r\n    }\r\n\r\n    drawLine(startPoint, endPoint, i) {\r\n        let opacity = this.p5.map(i, 0, 24, 100, 200);\r\n        let weight = this.p5.map(i, 0, 25, 2, 4);\r\n        this.p5.stroke(this.p5.color(255, 255, 255, opacity));\r\n        this.p5.strokeWeight(weight);\r\n        this.p5.line(startPoint['x'], startPoint['y'], endPoint['x'], endPoint['y']);\r\n    }\r\n}\r\n\r\n// // Use the local state to draw the lines. \r\n// if (this.ellipsePos['y'] < this.p5.height/2) {\r\n//     let pos = light.topPos;\r\n//     let height = light.getHeight(LIGHT_TYPE.TOP);\r\n//     if (height < this.p5.height/2 && height > 0) {\r\n//         this.drawLine(pos, this.ellipsePos, i);\r\n//     }\r\n// } else {\r\n//     let pos = light.bottomPos;\r\n//     let height = light.getHeight(LIGHT_TYPE.BOTTOM);\r\n//     if (height < this.p5.height/2 && height > 0) {\r\n//         this.drawLine(pos, this.ellipsePos, i);\r\n//     }\r\n// }","// Name: BpmStore.js\r\n// Author: Amay Kataria\r\n// Date: 03/03/2022\r\n// Description: This data store is respnsible to hold the Bpm that is retrieved from the database\r\n// as well as the Bpm that the user is synthesisizng locally. \r\n\r\nclass BpmStore {\r\n    constructor() {\r\n        // Bpm coming from the database. \r\n        this.dbBpm = 150;\r\n        // Locally modified Bpm. \r\n        this.localBpm = 150; \r\n\r\n        // Fire this when new Bpm is received from the database. \r\n        this.subscriber = '';\r\n    }\r\n\r\n    subscribe(listener) {\r\n        this.subscriber = listener;\r\n    }\r\n\r\n    getDbBpm() {\r\n        return this.dbBpm; \r\n    }\r\n\r\n    getLocalBpm() {\r\n        return this.localBpm; \r\n    }\r\n\r\n    setDbBpm(newBpm) {\r\n        // New payload from db. \r\n        // Reset both db and local bpm. \r\n        this.dbBpm = newBpm;\r\n        this.localBpm =  newBpm;\r\n\r\n        // Let subscribers know new Bpm values are updated. \r\n        this.subscriber();\r\n    }\r\n\r\n    setLocalBpm(localBpm) {\r\n        // Whenever local bpm gets updated, we want to let \r\n        // subscribers know that we have new values. \r\n        if (this.localBpm !== localBpm) {\r\n            this.localBpm = localBpm;\r\n            this.subscriber(); \r\n        }\r\n    }\r\n}\r\n\r\nexport default new BpmStore(); ","/*\r\n  Name: bpmManager.js\r\n  Author: Amay Kataria\r\n  Date: 02/20/2022\r\n  Description: A class responsible for handling the logic to calculate the bpm for the current configuration.\r\n*/\r\n\r\nimport BpmStore from '../stores/BpmStore'\r\nimport EditModeStore from \"../stores/EditModeStore\";\r\n\r\nconst MAX_BPM = 300;\r\nconst MIN_BPM = 150;\r\nexport default class bpmManager {\r\n    constructor(s) {\r\n        this.p5 = s;\r\n        this.curBpm = BpmStore.getDbBpm();\r\n        this.curTime = ''; \r\n    }\r\n\r\n    // Simple BPM calculator.\r\n    update(ellipsePos, lights) {\r\n        let isEditMode = EditModeStore.isEditMode; \r\n        let isUserInteracting = EditModeStore.isUserInteracting;\r\n        // The user must be in Edit Mode and be interacting for the\r\n        // local bpm to be changing. \r\n        if (isUserInteracting && isEditMode) { \r\n            let shouldAdd = false; \r\n            if (((ellipsePos['x'] > this.p5.width/2) && (ellipsePos['y'] < this.p5.height/2))\r\n                || ((ellipsePos['x'] < this.p5.width/2) && (ellipsePos['y'] > this.p5.height/2))){\r\n                shouldAdd = true; \r\n            } else {\r\n                shouldAdd = false; \r\n            }\r\n            \r\n            // Number of lights that are on. \r\n            let sum = 0; \r\n            for (let i = 0; i < lights.length; i++) {\r\n                let light = lights[i];\r\n                if (light.isOn()) {\r\n                    sum += 1; \r\n                }\r\n            }\r\n\r\n            // Time that has elapsed. \r\n            let elapsedTime = Date.now() - this.curTime; \r\n            let v = this.p5.sin(elapsedTime /(sum)); \r\n            let mapped =  this.p5.map(v, -1, 1, 0, 0.5);\r\n            \r\n            // Calculate the new bpm. \r\n            this.curBpm = shouldAdd ? (this.curBpm + mapped) : (this.curBpm - mapped); \r\n            \r\n            if (this.curBpm < MIN_BPM) {\r\n                this.curBpm = MIN_BPM; \r\n            } \r\n\r\n            if (this.curBpm > MAX_BPM) {\r\n                this.curBpm = MAX_BPM;\r\n            }\r\n\r\n            // Send updates to component subscribed for the event. \r\n            BpmStore.setLocalBpm(Math.floor(this.curBpm));\r\n        } else {\r\n            // Keep snapshotting the time, so we can calculate\r\n            // the elapsed time. \r\n            this.curTime = Date.now(); \r\n        }\r\n    }\r\n}","/*\r\n  Name: WaveCanvas.js\r\n  Author: Amay Kataria\r\n  Date: 02/19/2022\r\n  Description: Class responsible to paint the interactive P5.js canvas.\r\n*/\r\n\r\nimport React from 'react'\r\nimport Radium from 'radium'\r\nimport {color} from './CommonStyles'\r\nimport p5 from 'p5'\r\nimport { ORIENTATION } from './App'\r\nimport EditModeStore from '../stores/EditModeStore'\r\nimport LightManager from './LightManager'\r\nimport MeshManager from './MeshManager'\r\nimport BpmManager from './BpmManager'\r\n\r\nvar sketch = (s) => {\r\n  let lightManager, meshManager, bpmManager;\r\n  s.setup = () => {\r\n    let canvasContainer = s.select('#canvasContainer');\r\n    let height = canvasContainer.height;\r\n    s.createCanvas(window.innerWidth, height);\r\n\r\n    lightManager = new LightManager(s);\r\n    meshManager = new MeshManager(s);\r\n    bpmManager = new BpmManager(s); \r\n\r\n    lightManager.setup();\r\n  };\r\n\r\n  s.draw = () => {\r\n    s.background(s.color(0, 0, 0));  \r\n    lightManager.draw(meshManager.ellipsePos, meshManager.boundaryWidth);\r\n    meshManager.draw(lightManager.lights); \r\n    bpmManager.update(meshManager.ellipsePos, lightManager.lights);\r\n  };\r\n\r\n  s.mousePressed = () => {\r\n    if (s.mouseY > s.height || s.mouseY < 0) {\r\n      // Ignore. \r\n    } else if (!EditModeStore.isPopupActive) {\r\n      EditModeStore.setUserInteracting(true); \r\n      EditModeStore.setEditMode(true);\r\n    }\r\n  };\r\n\r\n  s.mouseReleased = () => {\r\n    EditModeStore.setUserInteracting(false); \r\n  }\r\n\r\n  s.windowResized = () => {\r\n    setTimeout(() => {\r\n      console.log('Canvas Resized.');\r\n      let canvasContainer = s.select('#canvasContainer');\r\n      let height = canvasContainer.height;\r\n      s.resizeCanvas(window.innerWidth, height); \r\n  \r\n      // Prepare the lights again. \r\n      lightManager.prepareLights();\r\n    }, 500);\r\n  }\r\n};\r\n\r\nconst styles = {\r\n  container: {\r\n    position: 'relative',\r\n    backgroundColor: color.bgBlack,\r\n    margin: 0,\r\n    padding: 0,\r\n    zIndex: '1'\r\n  }\r\n};\r\n\r\nclass WaveCanvas extends React.Component {\r\n  constructor(props) {\r\n    super(props);   \r\n    this.containerRef = React.createRef();\r\n    this.sketchRef = React.createRef(); \r\n  }\r\n\r\n  componentDidMount() {\r\n    console.log('Wave canvas mounted');    \r\n    this.myP5 = new p5(sketch, this.sketchRef.current); \r\n  }\r\n  \r\n  render() {     \r\n    let heightStyle = this.getHeightStyle();\r\n    let containerStyle = [styles.container, heightStyle];\r\n    return (\r\n      <div id={'canvasContainer'} \r\n        ref={this.sketchRef} \r\n        style={containerStyle}>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  getHeightStyle() {\r\n    let height = this.getHeight();\r\n    let heightStyle = {\r\n      height: height + 'px'\r\n    };\r\n    return heightStyle; \r\n  }\r\n\r\n  getHeight() {\r\n    let deviceHeight = window.innerHeight;\r\n    let deviceWidth = window.innerWidth; \r\n    let c = 0; \r\n    if (this.props.orientation === ORIENTATION.PORTRAIT) {\r\n      if (deviceHeight < 900) {\r\n        c = 0.8;\r\n      }\r\n\r\n      if (deviceHeight > 900 && deviceHeight < 1000) {\r\n        c = 0.85;\r\n      }\r\n\r\n      if (deviceHeight > 1000) {\r\n        c = 0.88; \r\n      }\r\n    }\r\n\r\n    if (this.props.orientation === ORIENTATION.LANDSCAPE) {\r\n      if (deviceWidth < 1000) {\r\n        c = 0.70;  \r\n      } \r\n\r\n      if (deviceWidth > 1000) {\r\n        c = 0.82;\r\n      }\r\n    }\r\n\r\n    return deviceHeight * c;\r\n  }\r\n}\r\n\r\nexport default Radium(WaveCanvas);","// Name: ConfigIndexStore.js\r\n// Author: Amay Kataria\r\n// Date: 03/03/2022\r\n// Description: This data store is responsible to store the current config index on top\r\n// of which the user is actually drawing the pattern. \r\n\r\nclass ConfigIndexStore {\r\n    constructor() {\r\n        // Default values. \r\n        this.configIndex = 0; \r\n        this.subscriber = ''; \r\n    }\r\n\r\n    getConfigIndex() {\r\n        return this.configIndex; \r\n    }\r\n\r\n    subscribe(listener) {\r\n        this.subscriber = listener; \r\n    }\r\n\r\n    setConfigIndex(newConfigIndex) {\r\n        this.configIndex = newConfigIndex;\r\n        // Let subscriber know we have updates. \r\n        this.subscriber(); \r\n    }\r\n}\r\n\r\nexport default new ConfigIndexStore(); ","/*\r\n  Name: Websocket.js\r\n  Author: Amay Kataria\r\n  Date: 02/15/2022\r\n  Description: Class responsible for communication with the webserver. We use websockets\r\n  technology for this. Here we have the websocket client, which communicates with backend\r\n  server over websockets.\r\n*/\r\n\r\nimport io  from 'socket.io-client'\r\nimport BpmStore from '../stores/BpmStore';\r\nimport ConfigIndexStore from '../stores/ConfigIndexStore';\r\nimport LightConfigStore from '../stores/LightConfigStore';\r\nimport SequencerStore from '../stores/SequencerStore';\r\n\r\n//const localhostURL = \"http://localhost:5000\";\r\nconst herokuURL = \"https://supersynth.herokuapp.com\";\r\n\r\nconst EVENT_SAVE_PAYLOAD = 'event_save_payload';\r\nconst EVENT_TIME = 'event_time';\r\nconst EVENT_FULL_PAYLOAD = 'event_full_payload';\r\nconst EVENT_SEQUENCER_PAYLOAD = 'event_sequencer_payload';\r\n\r\nclass Websocket {\r\n  constructor() {\r\n      this.siteURL = herokuURL + '/app'; \r\n\r\n      this.socket = io(this.siteURL, {\r\n          reconnection: true,\r\n          reconnectionDelay: 500,\r\n          reconnectionAttempts: Infinity\r\n      });\r\n\r\n      this.socket.once('connect', this.subscribe.bind(this));\r\n  }\r\n\r\n  subscribe() {\r\n      console.log('Connected');\r\n      // Subscribe to incoming events from the webserver here. \r\n      this.socket.on(EVENT_TIME, this.logTime.bind(this));\r\n      // Show up when user starts interacting.\r\n      this.socket.on(EVENT_FULL_PAYLOAD, (payload) => {\r\n        this.processFullPayload(payload); \r\n      }); \r\n      // Shows the data when user is not interacting\r\n      this.socket.on(EVENT_SEQUENCER_PAYLOAD, data => {\r\n        SequencerStore.setSequencerData(data);\r\n      });\r\n  }\r\n\r\n  // -------------------- DON'T CHANGE THESE -------------------    \r\n  disconnect() {\r\n      console.log('Socket Server Disconnected.');\r\n  }\r\n\r\n  logTime(data) {\r\n    // console.log('Socket Connection Alive: ' + data);\r\n  }\r\n\r\n  commitLightConfigData() {\r\n    // Extract data from stores. \r\n    let lightConfig = LightConfigStore.getActiveLightConfig();\r\n    let localBpm = BpmStore.getLocalBpm();\r\n    let configIndex = ConfigIndexStore.getConfigIndex() + 1; \r\n\r\n    // Create the JSON.\r\n    this.json = {};\r\n    this.json['bpm'] = localBpm; \r\n    this.json['lights'] = lightConfig; \r\n    this.json['time'] = Date(); \r\n\r\n    // Finalize payload\r\n    let payload = {\r\n      'index': configIndex,\r\n      'config': JSON.stringify(this.json)\r\n    };\r\n\r\n    // Emit payload.\r\n    this.socket.emit(EVENT_SAVE_PAYLOAD, payload);\r\n  }\r\n\r\n  processFullPayload(payload) {\r\n    // Config index. \r\n    let configIndex = payload['index'];\r\n    ConfigIndexStore.setConfigIndex(configIndex);\r\n\r\n    let config = payload['config'];\r\n\r\n    // Bpm.\r\n    let bpm = config['bpm'];\r\n    BpmStore.setDbBpm(bpm);\r\n\r\n    // Light config.\r\n    let lightConfig = config['lights'];\r\n    LightConfigStore.setLightConfig(lightConfig);\r\n\r\n    // Clear the current configuration so we can restart \r\n    // again. \r\n    SequencerStore.clearConfig();\r\n  }\r\n}\r\n\r\nexport default new Websocket();","/*\r\n  Name: BottomBar.js\r\n  Author: Amay Kataria\r\n  Date: 02/19/2022\r\n  Description: React component for the bottom bar on the page. This has the send button. \r\n*/\r\nimport React from 'react'\r\nimport Radium from 'radium'\r\nimport { ORIENTATION } from './App';\r\nimport {color, fontFamily, fontSize, padding} from './CommonStyles'\r\nimport Websocket from './Websocket';\r\nimport EditModeStore from '../stores/EditModeStore';\r\nimport BpmStore from '../stores/BpmStore';\r\nimport ConfigIndexStore from '../stores/ConfigIndexStore';\r\n\r\nconst styles = {\r\n    container: {\r\n        position: 'relative',\r\n        display: 'flex',\r\n        flexDirection: 'row',\r\n        justifyContent: 'space-between',\r\n        alignItems: 'center',\r\n        paddingLeft: padding.small,\r\n        paddingRight: padding.small,\r\n        // // // Common Styles\r\n        color: color.fbWhite,\r\n        fontFamily: fontFamily.josefin,\r\n        fontSize: fontSize.lessBig,\r\n        letterSpacing: '2px',\r\n        zIndex: '1',\r\n    },\r\n\r\n    info: {\r\n        backgroundColor: color.bgBlack,\r\n        fontFamily: fontFamily.heatwave,\r\n        letterSpacing: '2px',\r\n        padding: padding.verySmall,\r\n        cursor: 'default'\r\n    },\r\n\r\n    button: {\r\n      cursor: 'pointer',\r\n      borderStyle: 'solid',\r\n      borderWidth: '1.8px',\r\n      borderColor: color.fgWhite,\r\n      boxShadow:'0px 1px 1px black' \r\n    },\r\n\r\n    disabled: {\r\n      backgroundColor: color.disabled\r\n    }\r\n};\r\n\r\nclass BottomBar extends React.Component {\r\n  constructor(props) {\r\n    super(props); \r\n    this.state={\r\n      localBpm: '',\r\n      dbBpm: '',\r\n      configIndex: '',\r\n      isEditMode: false\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    BpmStore.subscribe(this.onBpmUpdated.bind(this));\r\n    ConfigIndexStore.subscribe(this.onConfigIndexUpdated.bind(this));\r\n    EditModeStore.subscribe(this.onEditModeUpdate.bind(this));\r\n  }\r\n \r\n  render() {\r\n    let bpm = this.state.isEditMode ? this.state.localBpm : this.state.dbBpm;\r\n    let indices = this.state.configIndex; \r\n    let heightStyle = this.getHeightStyle();\r\n    let elements = this.getElements(heightStyle, indices, bpm);\r\n    return elements; \r\n  }\r\n\r\n  getEditModeElements(heightStyle, bpm) {\r\n    return (\r\n      <div style={[styles.container, heightStyle]}>\r\n          <div onClick={this.onBack.bind(this)} style={[styles.info, styles.button]}>Back</div>\r\n          <div style={styles.info}>{bpm + 'bpm'}</div>\r\n          <div onClick={this.onSend.bind(this)} style={[styles.info, styles.button]}>Send</div>\r\n      </div>   \r\n    );\r\n  }\r\n\r\n  getElements(heightStyle, indices, bpm) {\r\n    let leftItem = this.getLeftItem(indices); \r\n    let sendButton = this.getSendButton();\r\n    return (\r\n      <div style={[styles.container, heightStyle]}>\r\n        { leftItem }\r\n        <div style={styles.info}>{bpm + 'bpm'}</div>\r\n        { sendButton }\r\n      </div>  \r\n    );\r\n  }\r\n\r\n  getLeftItem(indices) {\r\n    let item = this.state.isEditMode ? \r\n      <div\r\n        onClick={this.onBack.bind(this)}\r\n        style={[styles.info, styles.button]}\r\n        >BACK\r\n        </div> : \r\n      (<div style={styles.info}>{indices}</div>);\r\n    return item; \r\n  }\r\n\r\n  getSendButton() {\r\n    let buttonStyle = [styles.info, styles.button];\r\n    buttonStyle = !this.state.isEditMode ? [buttonStyle, styles.disabled] : buttonStyle;\r\n    let onClick = !this.state.isEditMode ? () => {} : this.onSend.bind(this);\r\n    return (\r\n      <div \r\n        onClick={onClick} \r\n        style={buttonStyle}\r\n      >SEND\r\n      </div>\r\n    );\r\n  }\r\n\r\n  getHeightStyle() {\r\n    let height = this.getHeight();\r\n    let heightStyle = {\r\n      height: height + 'px'\r\n    };\r\n    return heightStyle; \r\n  }\r\n\r\n  getHeight() {\r\n    let deviceHeight = window.innerHeight;\r\n    let deviceWidth = window.innerWidth;\r\n    let c = 0; \r\n    if (this.props.orientation === ORIENTATION.PORTRAIT) {\r\n      if (deviceHeight < 900) {\r\n        c = 0.1\r\n      }\r\n\r\n      if (deviceHeight > 900 && deviceHeight < 1000) {\r\n        c = 0.075\r\n      }\r\n\r\n      if (deviceHeight > 1000) {\r\n        c = 0.06\r\n      }\r\n    }\r\n\r\n    if (this.props.orientation === ORIENTATION.LANDSCAPE) {\r\n      if (deviceWidth < 1000) {\r\n        c = 0.15; \r\n      }\r\n\r\n      if (deviceWidth > 1000) {\r\n        c = 0.09; \r\n      }\r\n    }\r\n\r\n    return deviceHeight * c; \r\n  }\r\n\r\n  onEditModeUpdate() {\r\n    let isEditMode = EditModeStore.isEditMode; \r\n    // Don't re-render if we are already in the state. \r\n    if (this.state.isEditMode !== isEditMode) {\r\n      this.setState({\r\n        isEditMode: isEditMode        \r\n      });\r\n    }\r\n  }\r\n\r\n  onBpmUpdated() {\r\n    let dbBpm = BpmStore.getDbBpm();\r\n    let localBpm = BpmStore.getLocalBpm();\r\n\r\n    // Update DB bpm.\r\n    if (dbBpm !== this.state.dbBpm) {\r\n      this.setState({\r\n        dbBpm: dbBpm\r\n      });\r\n    }\r\n\r\n    // Update local bpm. \r\n    if (localBpm !== this.state.localBpm) {\r\n      this.setState({\r\n        localBpm: localBpm\r\n      });\r\n    }\r\n  }\r\n\r\n  onConfigIndexUpdated() {\r\n    let newConfigIndex = ConfigIndexStore.getConfigIndex();\r\n    if (newConfigIndex !== this.state.configIndex) {\r\n      this.setState({\r\n        configIndex: newConfigIndex\r\n      });\r\n    }\r\n  }\r\n\r\n  onSend(event) {\r\n    event.stopPropagation();\r\n    EditModeStore.setEditMode(false);\r\n    EditModeStore.setUserInteracting(false);\r\n    // Just before committing this. \r\n    Websocket.commitLightConfigData();\r\n  }\r\n\r\n  onBack(event) {\r\n    event.stopPropagation();\r\n    EditModeStore.setEditMode(false);\r\n    EditModeStore.setUserInteracting(false);\r\n    this.setState({\r\n      isEditMode: false\r\n    });\r\n  }\r\n}\r\n\r\nexport default Radium(BottomBar);","/*\n  Name: App.js\n  Author: Amay Kataria\n  Date: 02/19/2022\n  Description: Entry point component for the application. \n*/\n\nimport React from 'react'\nimport Radium from 'radium'\n\nimport Navbar from './Navbar';\nimport WaveCanvas from './WaveCanvas';\nimport BottomBar from './Bottombar';\n\n// Enum to track the device orientation. \nexport const ORIENTATION = {\n  PORTRAIT: 0,\n  LANDSCAPE: 1\n}\n\nconst styles = {\n  container: {\n    position: 'fixed',\n    top: '0%',\n    left: '0%',\n    right: '0%',\n    bottom: '0%',\n    overflow: 'hidden',\n    display: 'flex',\n    flexDirection: 'column',\n    color: 'white',\n    height: '100%',\n    width: '100%',\n    zIndex: '1'\n  },\n\n  button: {\n    width: '100px',\n    height: '50px',\n    backgroundColor: 'white',\n    color: 'black'\n  }\n};\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props); \n    window.addEventListener('resize', this.handleResize.bind(this));\n    this.state = {\n      orientation: ORIENTATION.PORTRAIT\n    };     \n  }\n\n  componentDidMount() {\n    this.evaluateOrientation();\n  }\n\n  render() {\n    return (\n      <div style={styles.container}>\n        <Navbar orientation={this.state.orientation} />\n        <WaveCanvas orientation={this.state.orientation} />\n        <BottomBar orientation={this.state.orientation} />\n      </div>\n    );\n  }\n\n  handleResize() {\n    // Resize triggered - evaluate orientation and render\n    // the components again be it. \n    this.evaluateOrientation();\n  }\n\n  evaluateOrientation() {\n    let t = (window.innerHeight < window.innerWidth); \n    if (t) {\n      console.log('App: Landscape');\n      this.setState({\n        orientation: ORIENTATION.LANDSCAPE\n      });\n    } else {\n      console.log('App: Portrait');\n      this.setState({\n          orientation: ORIENTATION.PORTRAIT\n      });\n    }\n  }\n}\n\nexport default Radium(App);","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport './font/stylesheet.css';\nimport App from './components/App';\nimport {StyleRoot} from 'radium'\n\n// Use StyleRoot to enable keyframes and media queries for Javascript type\n// styles with Radium in components. \n// Single render function for the entire application. \nReactDOM.render(<StyleRoot><App /></StyleRoot>, document.getElementById('root'));"],"sourceRoot":""}